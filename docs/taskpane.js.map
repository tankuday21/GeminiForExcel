{"version":3,"file":"taskpane.js","mappings":";iGACIA,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaE,QAGrB,IAAIC,EAASN,EAAyBE,GAAY,CAGjDG,QAAS,CAAC,GAOX,OAHAE,EAAoBL,GAAUI,EAAQA,EAAOD,QAASJ,GAG/CK,EAAOD,OACf,CAGAJ,EAAoBO,EAAID,ECxBxBN,EAAoBQ,EAAI,SAASJ,EAASK,GACzC,IAAI,IAAIC,KAAOD,EACXT,EAAoBW,EAAEF,EAAYC,KAASV,EAAoBW,EAAEP,EAASM,IAC5EE,OAAOC,eAAeT,EAASM,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAG3E,ECPAV,EAAoBgB,EAAI,WACvB,GAA0B,iBAAfC,WAAyB,OAAOA,WAC3C,IACC,OAAOC,MAAQ,IAAIC,SAAS,cAAb,EAChB,CAAE,MAAOC,GACR,GAAsB,iBAAXC,OAAqB,OAAOA,MACxC,CACA,CAPuB,GCAxBrB,EAAoBW,EAAI,SAASW,EAAKC,GAAQ,OAAOX,OAAOY,UAAUC,eAAeC,KAAKJ,EAAKC,EAAO,E,WCAtG,IAAII,EACA3B,EAAoBgB,EAAEY,gBAAeD,EAAY3B,EAAoBgB,EAAEa,SAAW,IACtF,IAAIC,EAAW9B,EAAoBgB,EAAEc,SACrC,IAAKH,GAAaG,IACbA,EAASC,eAAkE,WAAjDD,EAASC,cAAcC,QAAQC,gBAC5DN,EAAYG,EAASC,cAAcG,MAC/BP,GAAW,CACf,IAAIQ,EAAUL,EAASM,qBAAqB,UAC5C,GAAGD,EAAQE,OAEV,IADA,IAAIC,EAAIH,EAAQE,OAAS,EAClBC,GAAK,KAAOX,IAAc,aAAaY,KAAKZ,KAAaA,EAAYQ,EAAQG,KAAKJ,GAE3F,CAID,IAAKP,EAAW,MAAM,IAAIa,MAAM,yDAChCb,EAAYA,EAAUc,QAAQ,SAAU,IAAIA,QAAQ,OAAQ,IAAIA,QAAQ,QAAS,IAAIA,QAAQ,YAAa,KAC1GzC,EAAoB0C,EAAIf,C,IClBxB3B,EAAoB2C,EAAyB,oBAAbb,UAA4BA,SAASc,SAAYC,KAAKhB,SAASiB,K,m5DCC/F,IAAA1B,EAAA2B,EAAAC,EAAA,mBAAAC,OAAAA,OAAA,GAAAC,EAAAF,EAAAG,UAAA,aAAAxC,EAAAqC,EAAAI,aAAA,yBAAAd,EAAAU,EAAAE,EAAAvC,EAAA2B,GAAA,IAAAe,EAAAH,GAAAA,EAAA1B,qBAAA8B,EAAAJ,EAAAI,EAAAC,EAAA3C,OAAA4C,OAAAH,EAAA7B,WAAA,OAAAiC,EAAAF,EAAA,mBAAAP,EAAAE,EAAAvC,GAAA,IAAA2B,EAAAe,EAAAE,EAAAG,EAAA,EAAAhB,EAAA/B,GAAA,GAAAgD,GAAA,EAAAC,EAAA,CAAAlB,EAAA,EAAAQ,EAAA,EAAAW,EAAAzC,EAAA0C,EAAAtD,EAAAkD,EAAAlD,EAAAuD,KAAA3C,EAAA,GAAAZ,EAAA,SAAAuC,EAAAC,GAAA,OAAAV,EAAAS,EAAAM,EAAA,EAAAE,EAAAnC,EAAAwC,EAAAV,EAAAF,EAAAc,CAAA,YAAAtD,EAAAwC,EAAAE,GAAA,IAAAG,EAAAL,EAAAO,EAAAL,EAAAH,EAAA,GAAAY,GAAAD,IAAA/C,GAAAoC,EAAAL,EAAAL,OAAAU,IAAA,KAAApC,EAAA2B,EAAAI,EAAAK,GAAAvC,EAAAoD,EAAAlB,EAAAsB,EAAA1B,EAAA,GAAAU,EAAA,GAAArC,EAAAqD,IAAAd,KAAAK,EAAAjB,GAAAe,EAAAf,EAAA,OAAAe,EAAA,MAAAf,EAAA,GAAAA,EAAA,GAAAlB,GAAAkB,EAAA,IAAA9B,KAAAG,EAAAqC,EAAA,GAAAxC,EAAA8B,EAAA,KAAAe,EAAA,EAAAO,EAAAC,EAAAX,EAAAU,EAAAV,EAAAZ,EAAA,IAAA9B,EAAAwD,IAAArD,EAAAqC,EAAA,GAAAV,EAAA,GAAAY,GAAAA,EAAAc,KAAA1B,EAAA,GAAAU,EAAAV,EAAA,GAAAY,EAAAU,EAAAV,EAAAc,EAAAX,EAAA,OAAA1C,GAAAqC,EAAA,SAAAc,EAAA,MAAAH,GAAA,EAAAT,CAAA,iBAAAvC,EAAA+B,EAAAsB,GAAA,GAAAN,EAAA,QAAAO,UAAA,oCAAAN,GAAA,IAAAjB,GAAAlC,EAAAkC,EAAAsB,GAAAX,EAAAX,EAAAa,EAAAS,GAAAjB,EAAAM,EAAA,EAAAjC,EAAAmC,KAAAI,GAAA,CAAArB,IAAAe,EAAAA,EAAA,GAAAA,EAAA,IAAAO,EAAAV,GAAA,GAAA1C,EAAA6C,EAAAE,IAAAK,EAAAV,EAAAK,EAAAK,EAAAC,EAAAN,GAAA,OAAAG,EAAA,EAAApB,EAAA,IAAAe,IAAA1C,EAAA,QAAAoC,EAAAT,EAAA3B,GAAA,MAAAoC,EAAAA,EAAArB,KAAAY,EAAAiB,IAAA,MAAAU,UAAA,wCAAAlB,EAAAmB,KAAA,OAAAnB,EAAAQ,EAAAR,EAAAoB,MAAAd,EAAA,IAAAA,EAAA,YAAAA,IAAAN,EAAAT,EAAA8B,SAAArB,EAAArB,KAAAY,GAAAe,EAAA,IAAAE,EAAAU,UAAA,oCAAAtD,EAAA,YAAA0C,EAAA,GAAAf,EAAAlB,CAAA,UAAA2B,GAAAY,EAAAC,EAAAV,EAAA,GAAAK,EAAAP,EAAAtB,KAAAwB,EAAAU,MAAAE,EAAA,YAAAf,GAAAT,EAAAlB,EAAAiC,EAAA,EAAAE,EAAAR,CAAA,SAAAW,EAAA,UAAAS,MAAApB,EAAAmB,KAAAP,EAAA,GAAAX,EAAArC,EAAA2B,IAAA,GAAAiB,CAAA,KAAAO,EAAA,YAAAR,IAAA,UAAAe,IAAA,UAAAC,IAAA,CAAAvB,EAAAnC,OAAA2D,eAAA,IAAAlB,EAAA,GAAAH,GAAAH,EAAAA,EAAA,GAAAG,QAAAO,EAAAV,EAAA,GAAAG,EAAA,yBAAAH,GAAAQ,EAAAe,EAAA9C,UAAA8B,EAAA9B,UAAAZ,OAAA4C,OAAAH,GAAA,SAAAK,EAAAtC,GAAA,OAAAR,OAAA4D,eAAA5D,OAAA4D,eAAApD,EAAAkD,IAAAlD,EAAAqD,UAAAH,EAAAb,EAAArC,EAAAT,EAAA,sBAAAS,EAAAI,UAAAZ,OAAA4C,OAAAD,GAAAnC,CAAA,QAAAiD,EAAA7C,UAAA8C,EAAAb,EAAAF,EAAA,cAAAe,GAAAb,EAAAa,EAAA,cAAAD,GAAAA,EAAAK,YAAA,oBAAAjB,EAAAa,EAAA3D,EAAA,qBAAA8C,EAAAF,GAAAE,EAAAF,EAAA5C,EAAA,aAAA8C,EAAAF,EAAAL,EAAA,yBAAAO,EAAAF,EAAA,oDAAAoB,EAAA,kBAAAC,EAAAtC,EAAA/B,EAAAmD,EAAA,cAAAD,EAAArC,EAAA4B,EAAAE,EAAAH,GAAA,IAAAT,EAAA1B,OAAAC,eAAA,IAAAyB,EAAA,gBAAAlB,GAAAkB,EAAA,EAAAmB,EAAA,SAAArC,EAAA4B,EAAAE,EAAAH,GAAA,SAAApC,EAAAqC,EAAAE,GAAAO,EAAArC,EAAA4B,EAAA,SAAA5B,GAAA,YAAAyD,QAAA7B,EAAAE,EAAA9B,EAAA,GAAA4B,EAAAV,EAAAA,EAAAlB,EAAA4B,EAAA,CAAAmB,MAAAjB,EAAApC,YAAAiC,EAAA+B,cAAA/B,EAAAgC,UAAAhC,IAAA3B,EAAA4B,GAAAE,GAAAvC,EAAA,UAAAA,EAAA,WAAAA,EAAA,cAAA8C,EAAArC,EAAA4B,EAAAE,EAAAH,EAAA,UAAAiC,EAAA9B,EAAAH,EAAA3B,EAAA4B,EAAArC,EAAAmD,EAAAT,GAAA,QAAAf,EAAAY,EAAAY,GAAAT,GAAAE,EAAAjB,EAAA6B,KAAA,OAAAjB,GAAA,YAAA9B,EAAA8B,EAAA,CAAAZ,EAAA4B,KAAAnB,EAAAQ,GAAA0B,QAAAC,QAAA3B,GAAA4B,KAAAnC,EAAArC,EAAA,UAAAyE,EAAAlC,GAAA,sBAAAH,EAAA,KAAA3B,EAAAiE,UAAA,WAAAJ,QAAA,SAAAjC,EAAArC,GAAA,IAAAmD,EAAAZ,EAAAoC,MAAAvC,EAAA3B,GAAA,SAAAmE,EAAArC,GAAA8B,EAAAlB,EAAAd,EAAArC,EAAA4E,EAAAC,EAAA,OAAAtC,EAAA,UAAAsC,EAAAtC,GAAA8B,EAAAlB,EAAAd,EAAArC,EAAA4E,EAAAC,EAAA,QAAAtC,EAAA,CAAAqC,OAAA,MAKA,IAAME,EAGW,wBAIXC,EAAQ,CACVC,OAAQ,GACRC,eAAgB,GAChBC,YAAa,KACbC,oBAAqB,GACrBC,gBAAgB,GAiFpB,SAASC,IACLlE,SAASmE,eAAe,SAASC,UAAUC,OAAO,OACtD,CAaA,SAAAC,IAJC,OAIDA,EAAAhB,EAAAT,IAAApE,EAXA,SAAA8F,IAAA,OAAA1B,IAAAC,EAAA,SAAA0B,GAAA,cAAAA,EAAA5D,EAAA4D,EAAApD,GAAA,cAAAoD,EAAA5D,EAAA,EAAA4D,EAAApD,EAAA,EAEcqD,MAAMC,IAAG,eAAAC,EAAArB,EAAAT,IAAApE,EAAC,SAAAmG,EAAOC,GAAG,OAAAhC,IAAAC,EAAA,SAAAgC,GAAA,cAAAA,EAAA1D,GAAA,OAC6D,OAAnFyD,EAAIE,SAASC,WAAWC,qBAAqBC,mBAAmBC,IAAIC,GAAeN,EAAA1D,EAAA,EAC7EyD,EAAIQ,OAAM,cAAAP,EAAA9C,EAAA,KAAA4C,EAAA,IACnB,gBAAAU,GAAA,OAAAX,EAAAnB,MAAA,KAAAD,UAAA,EAHc,IAGb,OAAAiB,EAAApD,EAAA,eAAAoD,EAAA5D,EAAA,EAAA4D,EAAAzC,EAAA,cAAAyC,EAAAxC,EAAA,KAAAuC,EAAA,iBAETD,EAAAd,MAAA,KAAAD,UAAA,CAKD,SAASgC,EAAiBC,GAEtB,IADA,IAAIC,EAAS,GACND,GAAS,GACZC,EAASC,OAAOC,aAAcH,EAAQ,GAAM,IAAMC,EAClDD,EAAQI,KAAKC,MAAML,EAAQ,IAAM,EAErC,OAAOC,CACX,CAIA,SACeL,IAAa,OAAAU,EAAAtC,MAAC,KAADD,UAAA,CA0D5B,SAAAuC,IAJC,OAIDA,EAAAxC,EAAAT,IAAApE,EA1DA,SAAAsH,IAAA,IAAAC,EAAA,OAAAnD,IAAAC,EAAA,SAAAmD,GAAA,cAAAA,EAAArF,EAAAqF,EAAA7E,GAAA,OACyD,OAA/C4E,EAAShG,SAASmE,eAAe,eAAc8B,EAAArF,EAAA,EAAAqF,EAAA7E,EAAA,EAG3CqD,MAAMC,IAAG,eAAAwB,EAAA5C,EAAAT,IAAApE,EAAC,SAAA0H,EAAOtB,GAAG,IAAAuB,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAtF,EAAAuF,EAAAC,EAAA,OAAAlE,IAAAC,EAAA,SAAAkE,GAAA,cAAAA,EAAA5F,GAAA,OAKsE,OAJtFgF,EAAQvB,EAAIE,SAASC,WAAWC,qBAChCoB,EAAYD,EAAMa,eAExBb,EAAMc,KAAK,QACXb,EAAUa,KAAK,CAAC,UAAW,SAAU,WAAY,cAAe,cAAe,aAAaF,EAAA5F,EAAA,EAEtFyD,EAAIQ,OAAM,OAchB,IAZMiB,EAAYF,EAAMe,KAClBZ,EAASF,EAAUE,OACnBC,EAAWH,EAAUe,YACrBX,EAAWJ,EAAUgB,SACrBX,EAAWL,EAAUK,SACrBC,EAAWN,EAAUiB,YAGrBV,EAAUL,EAAO,IAAM,GAGvBM,EAAY,GACTtF,EAAI,EAAGA,EAAIoF,EAAUpF,IACpBuF,EAAYvB,EAAiBiB,EAAWjF,GACxCwF,EAAaH,EAAQrF,IAAM,UAAJgG,OAAcT,GAC3CD,EAAUW,KAAK,CACX/B,OAAQqB,EACRtB,MAAOjE,EACPkG,OAAQV,IAIhBnD,EAAMG,YAAc,CAChBuC,UAAAA,EACAoB,QAASrB,EAAUqB,QACnBnB,OAAAA,EACAK,QAAAA,EACAC,UAAAA,EACAJ,SAAUA,EAAW,EACrBD,SAAUjB,EAAiBiB,GAC3BE,SAAAA,EACAC,SAAAA,EACAgB,aAAclB,EAAW,GAG7BT,EAAO4B,YAAc,GAAHL,OAAMjB,EAAS,MAAAiB,OAAKb,EAAQ,YAAAa,OAAWZ,EAAQ,SAAQ,cAAAK,EAAAhF,EAAA,KAAAmE,EAAA,IAC5E,gBAAA0B,GAAA,OAAA3B,EAAA1C,MAAA,KAAAD,UAAA,EA7Cc,IA6Cb,OAAA0C,EAAA7E,EAAA,eAAA6E,EAAArF,EAAA,EAAAqF,EAAAlE,EAEFiE,EAAO4B,YAAc,UACrBhE,EAAMG,YAAc,KAAK,cAAAkC,EAAAjE,EAAA,KAAA+D,EAAA,iBAEhCD,EAAAtC,MAAA,KAAAD,UAAA,CAKD,SAASuE,IACDlE,EAAMK,iBACNjE,SAASmE,eAAe,WAAW4D,MAAMC,QAAU,OACnDhI,SAASmE,eAAe,QAAQ4D,MAAMC,QAAU,OAChDpE,EAAMK,gBAAiB,EAE/B,CAEA,SAASgE,EAAWC,EAAMC,GAAoB,IAAXC,EAAI7E,UAAAhD,OAAA,QAAAlC,IAAAkF,UAAA,GAAAA,UAAA,GAAG,GACtCuE,IACA,IAAMO,EAAOrI,SAASmE,eAAe,QAC/BmE,EAAMtI,SAASuI,cAAc,OACnCD,EAAIE,UAAY,OAAHjB,OAAUW,EAAI,KAAAX,OAAIa,GAC/BE,EAAIG,UAAY,qCAAHlB,OAC0B,SAATW,EAAkB,IAAM,KAAI,0CAAAX,OACnBY,EAQlCxH,QAAQ,KAAM,SACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,QACdA,QAAQ,4BAA6B,iBACrCA,QAAQ,aAAc,mBACtBA,QAAQ,mBAAoB,aAC5BA,QAAQ,MAAO,QAd2B,gBAE/C0H,EAAKK,YAAYJ,GACjBD,EAAKM,UAAYN,EAAKO,YAC1B,CAaA,SAASC,IACLf,IACA,IAAMO,EAAOrI,SAASmE,eAAe,QAC/B2E,EAAK9I,SAASuI,cAAc,OAClCO,EAAGN,UAAY,SACfM,EAAGC,GAAK,SACRD,EAAGL,UAAY,0IACfJ,EAAKK,YAAYI,GACjBT,EAAKM,UAAYN,EAAKO,YAC1B,CAEA,SAASI,IAAa,IAAAC,EACe,QAAjCA,EAAAjJ,SAASmE,eAAe,iBAAS,IAAA8E,GAAjCA,EAAmC5E,QACvC,CAEA,SAAS6E,IACLtF,EAAMI,oBAAsB,GAC5BJ,EAAME,eAAiB,GACvBF,EAAMK,gBAAiB,EACvBjE,SAASmE,eAAe,QAAQsE,UAAY,GAC5CzI,SAASmE,eAAe,QAAQ4D,MAAMC,QAAU,OAChDhI,SAASmE,eAAe,WAAW4D,MAAMC,QAAU,OACnDhI,SAASmE,eAAe,YAAYgF,UAAW,EAC/CC,EAAM,UACV,CAEA,SAASA,EAAMd,GACX,IAAMrH,EAAIjB,SAASmE,eAAe,SAClClD,EAAE2G,YAAcU,EAChBrH,EAAEmD,UAAUe,IAAI,QAChBkE,WAAW,kBAAMpI,EAAEmD,UAAUC,OAAO,OAAO,EAAE,IACjD,CAIA,SACeiF,IAAU,OAAAC,EAAA/F,MAAC,KAADD,UAAA,UAAAgG,IA8CxB,OA9CwBA,EAAAjG,EAAAT,IAAApE,EAAzB,SAAA+K,IAAA,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAlH,IAAAC,EAAA,SAAAkH,GAAA,cAAAA,EAAApJ,EAAAoJ,EAAA5I,GAAA,OAEqC,GAD3BqI,EAAQzJ,SAASmE,eAAe,eAChCuF,EAASD,EAAMpH,MAAM4H,OACd,CAAFD,EAAA5I,EAAA,eAAA4I,EAAAhI,EAAA,aAEN4B,EAAMC,OAAQ,CAAFmG,EAAA5I,EAAA,QAEU,OADvBpB,SAASmE,eAAe,eAAe+F,QACvCd,EAAM,iBAAiBY,EAAAhI,EAAA,iBAAAgI,EAAA5I,EAAA,EAIrBgE,IAAe,OAQR,OANb6C,EAAW,OAAQyB,GAEnBD,EAAMpH,MAAQ,GACdoH,EAAM1B,MAAMoC,OAAS,OACrBnK,SAASmE,eAAe,WAAWgF,UAAW,EAE9CN,IAAamB,EAAApJ,EAAA,EAAAoJ,EAAA5I,EAAA,EAGcgJ,EAAOV,GAAO,OAA/BC,EAAQK,EAAAjI,EACdiH,IAAaY,EAEgBS,EAAcV,GAAnCE,EAAOD,EAAPC,QAASC,EAAOF,EAAPE,QACjBlG,EAAME,eAAiBgG,EAEvB7B,EAAW,KAAM4B,EAASC,EAAQvJ,OAAS,aAAe,IAEtDuJ,EAAQvJ,SACRP,SAASmE,eAAe,YAAYgF,UAAW,GAGnDvF,EAAMI,oBAAoBwD,KACtB,CAAEU,KAAM,OAAQoC,MAAO,CAAC,CAAEC,KAAMb,KAChC,CAAExB,KAAM,QAASoC,MAAO,CAAC,CAAEC,KAAMZ,MAGjC/F,EAAMI,oBAAoBzD,OAASoD,KACnCC,EAAMI,oBAAsBJ,EAAMI,oBAAoBwG,OAAM,KAC/DR,EAAA5I,EAAA,eAAA4I,EAAApJ,EAAA,EAAAmJ,EAAAC,EAAAjI,EAEDiH,IACAf,EAAW,KAAM,UAAY8B,EAAIF,QAAS,SAAS,cAAAG,EAAAhI,EAAA,KAAAwH,EAAA,kBAE1DhG,MAAA,KAAAD,UAAA,UAEc6G,EAAMK,GAAA,OAAAC,EAAAlH,MAAC,KAADD,UAAA,UAAAmH,IA0BpB,OA1BoBA,EAAApH,EAAAT,IAAApE,EAArB,SAAAkM,EAAsBC,GAAU,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAtI,IAAAC,EAAA,SAAAsI,GAAA,cAAAA,EAAAhK,GAAA,OAOwC,OAN9D0J,EAAcO,IACdN,EAAeO,IAEfN,EAAkB,GAAHzD,OAAMuD,EAAW,2BAAAvD,OAA0BqD,IAE1DK,EAAQM,EAAO3H,EAAMI,sBAClBwD,KAAK,CAAEU,KAAM,OAAQoC,MAAO,CAAC,CAAEC,KAAMS,MAAsBI,EAAAhK,EAAA,EAElDoK,MAAM,GAADjE,OA/ST,4DAgTYA,OAjTZ,mBAiTkC,yBAAAA,OAAwB3D,EAAMC,QAC1E,CACI4H,OAAQ,OACR7E,QAAS,CAAE,eAAgB,oBAC3B8E,KAAMC,KAAKC,UAAU,CACjBC,kBAAmB,CAAEvB,MAAO,CAAC,CAAEC,KAAMQ,KACrCE,SAAAA,EACAa,iBAAkB,CAAEC,YAAa,GAAKC,gBAAiB,UAGlE,OAXQ,IAAHd,EAAGE,EAAArJ,GAaAkK,GAAI,CAAFb,EAAAhK,EAAA,cAAQ,IAAIV,MAAM,cAAD6G,OAAe2D,EAAIgB,SAAS,cAAAd,EAAAhK,EAAA,EAErC8J,EAAIiB,OAAM,OAAnB,OAAJhB,EAAIC,EAAArJ,EAAAqJ,EAAApJ,EAAA,GACHmJ,SAAgB,QAAZN,EAAJM,EAAMiB,kBAAU,IAAAvB,GAAK,QAALA,EAAhBA,EAAmB,UAAE,IAAAA,GAAS,QAATA,EAArBA,EAAuB1C,eAAO,IAAA0C,GAAO,QAAPA,EAA9BA,EAAgCP,aAAK,IAAAO,GAAK,QAALA,EAArCA,EAAwC,UAAE,IAAAA,OAAA,EAA1CA,EAA4CN,OAAQ,eAAa,EAAAI,EAAA,KAC3EnH,MAAA,KAAAD,UAAA,CAED,SAAS8H,IACL,IAAKzH,EAAMG,YACP,MAAO,kCAGX,IAAAsI,EAAoFzI,EAAMG,YAAlFuC,EAAS+F,EAAT/F,UAAWC,EAAM8F,EAAN9F,OAAQM,EAASwF,EAATxF,UAAWH,EAAQ2F,EAAR3F,SAAUC,EAAQ0F,EAAR1F,SAAwBe,GAAF2E,EAAZ1E,aAAqB0E,EAAP3E,SAEpE4E,EAAU,6BACdA,GAAW,cAAJ/E,OAAkBjB,EAAS,MAClCgG,GAAW,mBAAJ/E,OAAuBG,EAAO,MACrC4E,GAAW,mBAAJ/E,OAAuBb,EAAQ,yBACtC4F,GAAW,sBAAJ/E,OAA0BZ,EAAQ,QAGzC2F,GAAW,wBACXA,GAAW,oDACXA,GAAW,oDAAoD,IAEpCC,EAFoCC,EAAAC,EAE7C5F,GAAS,IAA3B,IAAA2F,EAAAE,MAAAH,EAAAC,EAAApL,KAAAgB,MAA6B,CAGzB,IAHyB,IAAlBuK,EAAGJ,EAAAlK,MAEJuK,EAAU,GACP1L,EAAI,EAAGA,EAAI0E,KAAKiH,IAAI,EAAGtG,EAAOhG,QAASW,IAAK,KAAA4L,EAC3CC,EAAe,QAAZD,EAAGvG,EAAOrF,UAAE,IAAA4L,OAAA,EAATA,EAAYH,EAAInH,OACxBuH,SAA6C,KAARA,GACrCH,EAAQpF,KAAK9B,OAAOqH,GAAKC,UAAU,EAAG,IAE9C,CACAV,GAAW,KAAJ/E,OAASoF,EAAIlH,OAAM,OAAA8B,OAAMoF,EAAIlF,OAAM,OAAAF,OAAMqF,EAAQK,KAAK,MAAK,OACtE,CAAC,OAAAC,GAAAV,EAAAlN,EAAA4N,EAAA,SAAAV,EAAA5K,GAAA,CAED0K,GAAW,wCAGXA,GAAW,UAAU,IACMa,EADNC,EAAAX,EACH5F,GAAS,IAA3B,IAAAuG,EAAAV,MAAAS,EAAAC,EAAAhM,KAAAgB,MAA6B,KAAlBuK,EAAGQ,EAAA9K,MACViK,GAAW,IAAJ/E,OAAQoF,EAAIlH,OAAM,MAAA8B,OAAKoF,EAAIlF,OAAM,KAC5C,CAAC,OAAAyF,GAAAE,EAAA9N,EAAA4N,EAAA,SAAAE,EAAAxL,GAAA,CACD0K,GAAW,YACX,IAAK,IAAI/K,EAAI,EAAGA,EAAIoF,EAAUpF,IAC1B+K,GAAW,gBAEfA,GAAW,KAIX,IADA,IAAMe,EAAUzH,KAAKiH,IAAI,GAAItG,EAAOhG,QAC3BW,EAAI,EAAGA,EAAImM,EAASnM,IAAK,CAC9B,IAAMoM,EAAS1J,EAAMG,YAAY0C,SAAWvF,EAC5CoL,GAAW,KAAJ/E,OAAS+F,EAAM,MACtB,IAAK,IAAI/L,EAAI,EAAGA,EAAIoF,EAAUpF,IAAK,KAAAgM,EAC3BR,EAAe,QAAZQ,EAAGhH,EAAOrF,UAAE,IAAAqM,OAAA,EAATA,EAAYhM,GAClBwL,UAAmCA,EAAM,IAC7CA,EAAMrH,OAAOqH,GAAKC,UAAU,EAAG,IAC/BV,GAAW,IAAJ/E,OAAQwF,EAAG,KACtB,CACAT,GAAW,IACf,CAEI5F,EAAW,KACX4F,GAAW,aAAJ/E,OAAiBb,EAAW,GAAE,iBAIzC4F,GAAW,sDAAsD,IACtCkB,EADsCC,EAAAhB,EAC/C5F,GAAS,IAA3B,IAAA4G,EAAAf,MAAAc,EAAAC,EAAArM,KAAAgB,MAA6B,CAEzB,IAFyB,IAAlBuK,EAAGa,EAAAnL,MACJqL,EAAa,IAAIC,IACdzM,EAAI,EAAGA,EAAIqF,EAAOhG,OAAQW,IAAK,KAAA0M,EAC9Bb,EAAe,QAAZa,EAAGrH,EAAOrF,UAAE,IAAA0M,OAAA,EAATA,EAAYjB,EAAInH,OACxBuH,SAA6C,KAARA,GACrCW,EAAWvI,IAAI4H,EAEvB,CACIW,EAAWG,KAAO,GAAKH,EAAWG,MAAQ,KAC1CvB,GAAW,KAAJ/E,OAASoF,EAAIlH,OAAM,MAAA8B,OAAKoF,EAAIlF,OAAM,SAAAF,OAAQuG,MAAMC,KAAKL,GAAYlD,MAAM,EAAG,IAAIyC,KAAK,OACtFS,EAAWG,KAAO,KAAIvB,GAAW,SAAJ/E,OAAamG,EAAWG,KAAI,YAC7DvB,GAAW,KAEnB,CAAC,OAAAY,GAAAO,EAAAnO,EAAA4N,EAAA,SAAAO,EAAA7L,GAAA,CAED,OAAO0K,CACX,CAEA,SAAShB,IACL,MAAO,8iDAoDX,CAEA,SAASjB,EAAcE,GAKnB,IAJA,IAGIyD,EAHElE,EAAU,GACVmE,EAAc,0CAGwB,QAApCD,EAAQC,EAAYC,KAAK3D,KAAiB,KAAA4D,EAAAC,EAAAC,EAAAC,EACxCC,EAAQP,EAAM,GACd7F,EAAU6F,EAAM,GAAG/D,OAEnB7B,GAAoC,QAA7B+F,EAAAI,EAAMP,MAAM,yBAAiB,IAAAG,OAAA,EAA7BA,EAAgC,KAAM,UAC7CK,GAAwC,QAA/BJ,EAAAG,EAAMP,MAAM,2BAAmB,IAAAI,OAAA,EAA/BA,EAAkC,KAAM,GACjDK,GAAwC,QAA/BJ,EAAAE,EAAMP,MAAM,2BAAmB,IAAAK,OAAA,EAA/BA,EAAkC,KAAM,GACjDK,GAA8C,QAAlCJ,EAAAC,EAAMP,MAAM,8BAAsB,IAAAM,OAAA,EAAlCA,EAAqC,KAAM,SAE7DxE,EAAQtC,KAAK,CAAEY,KAAAA,EAAMoG,OAAAA,EAAQC,OAAAA,EAAQC,UAAAA,EAAWvD,KAAMhD,GAC1D,CAGA,MAAO,CAAE0B,QADOU,EAAK5J,QAAQ,6BAA8B,IAAIsJ,QAClC,kBAAmBH,QAAAA,EACpD,CAIA,SACe6E,IAAW,OAAAC,EAAApL,MAAC,KAADD,UAAA,UAAAqL,IA+CzB,OA/CyBA,EAAAtL,EAAAT,IAAApE,EAA1B,SAAAoQ,IAAA,IAAAC,EAAAC,EAAAC,EAAA,OAAAnM,IAAAC,EAAA,SAAAmM,GAAA,cAAAA,EAAArO,EAAAqO,EAAA7N,GAAA,UACSwC,EAAME,eAAevD,OAAQ,CAAF0O,EAAA7N,EAAA,QACF,OAA1BgI,EAAM,oBAAoB6F,EAAAjN,EAAA,UASb,OALX8M,EAAW9O,SAASmE,eAAe,aAChCgF,UAAW,EACpB2F,EAASlH,YAAc,cAEnBmH,EAAe,EACfC,EAAW,GAAEC,EAAArO,EAAA,EAAAqO,EAAA7N,EAAA,EAGPqD,MAAMC,IAAG,eAAAwK,EAAA5L,EAAAT,IAAApE,EAAC,SAAA0Q,EAAOtK,GAAG,IAAAuB,EAAAgJ,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAA3M,IAAAC,EAAA,SAAA2M,GAAA,cAAAA,EAAA7O,EAAA6O,EAAArO,GAAA,OAChBgF,EAAQvB,EAAIE,SAASC,WAAWC,qBAAoBmK,EAAA3C,EAErC7I,EAAME,gBAAc2L,EAAA7O,EAAA,EAAAwO,EAAA1C,IAAA,WAAA2C,EAAAD,EAAAhO,KAAAgB,KAAE,CAAFqN,EAAArO,EAAA,QAAxB,OAANkO,EAAMD,EAAAhN,MAAAoN,EAAA7O,EAAA,EAAA6O,EAAArO,EAAA,EAEHsO,EAAc7K,EAAKuB,EAAOkJ,GAAO,cAAAG,EAAArO,EAAA,EACjCyD,EAAIQ,OAAM,OAChB0J,IAAeU,EAAArO,EAAA,eAAAqO,EAAA7O,EAAA,EAAA2O,EAAAE,EAAA1N,EAEfiN,EAAWO,EAAE1F,QACb8F,QAAQC,MAAM,iBAAgBL,GAAK,OAAAE,EAAArO,EAAA,eAAAqO,EAAArO,EAAA,gBAAAqO,EAAA7O,EAAA,EAAA4O,EAAAC,EAAA1N,EAAAqN,EAAA9P,EAAAkQ,GAAA,eAAAC,EAAA7O,EAAA,GAAAwO,EAAAxN,IAAA6N,EAAA7N,EAAA,mBAAA6N,EAAAzN,EAAA,KAAAmN,EAAA,6BAG9C,gBAAAU,GAAA,OAAAX,EAAA1L,MAAA,KAAAD,UAAA,EAbc,IAab,OAWwB,OATtBwL,IAAiBnL,EAAME,eAAevD,QACtC0H,EAAW,KAAM,oCAAqC,WACtDmB,EAAM,YAENnB,EAAW,KADJ8G,EAAe,EACL,GAAFxH,OAAKwH,EAAY,KAAAxH,OAAI3D,EAAME,eAAevD,OAAM,6BAAAgH,OAA4ByH,GAE1E,WAAFzH,OAAayH,GAF2E,SAK3GpL,EAAME,eAAiB,GAAGmL,EAAA7N,EAAA,EACpBgE,IAAe,OAAA6J,EAAA7N,EAAA,eAAA6N,EAAArO,EAAA,EAErBqH,EAAW,KAAM,WAFIgH,EAAAlN,EAEa8H,QAAS,SAC3CT,EAAM,UAAU,OAGpB0F,EAAS3F,UAAW,EACpB2F,EAASlH,YAAc,gBAAgB,cAAAqH,EAAAjN,EAAA,KAAA6M,EAAA,iBAC1CD,EAAApL,MAAA,KAAAD,UAAA,UAEcmM,EAAaI,EAAAC,EAAAC,GAAA,OAAAC,EAAAzM,MAAC,KAADD,UAAA,UAAA0M,IA4C3B,OA5C2BA,EAAA3M,EAAAT,IAAApE,EAA5B,SAAAyR,EAA6BrL,EAAKuB,EAAOkJ,GAAM,IAAAlH,EAAAoG,EAAAC,EAAAC,EAAAvD,EAAAgF,EAAAC,EAAA,OAAAvN,IAAAC,EAAA,SAAAuN,GAAA,cAAAA,EAAAjP,GAAA,OACkB,GAArDgH,EAA0DkH,EAA1DlH,KAAMoG,EAAoDc,EAApDd,OAAQC,EAA4Ca,EAA5Cb,OAA4Ca,EAApCgB,eAAgB5B,EAAoBY,EAApBZ,UAAWvD,EAASmE,EAATnE,KAEpDqD,EAAQ,CAAF6B,EAAAjP,EAAA,cAAQ,IAAIV,MAAM,uBAAsB,OAGX,OADlCyP,EAAQ/J,EAAMmK,SAAS/B,IACvBtH,KAAK,CAAC,WAAY,gBAAgBmJ,EAAAjP,EAAA,EAClCyD,EAAIQ,OAAM,OAAA+K,EAERhI,EAAIiI,EAAAjP,EACH,YADGgP,EACM,EAIT,WAJSA,EAID,EAIR,WAJQA,EAIA,EAIR,eAJQA,EAII,EAIZ,UAJYA,EAIL,EAIP,SAJOA,EAID,GAIN,aAJMA,EAII,0BAAAC,EAAAjP,EAAA,EAvBLoP,EAAaL,EAAOhF,GAAK,cAAAkF,EAAArO,EAAA,aAIN,OAAzByO,EAAYN,EAAOhF,GAAMkF,EAAArO,EAAA,aAIA,OAAzB0O,EAAYP,EAAOhF,GAAMkF,EAAArO,EAAA,oBAAAqO,EAAAjP,EAAA,EAInBuP,EAAgB9L,EAAKuB,EAAO+J,EAAO1B,GAAO,cAAA4B,EAAArO,EAAA,aAIX,OAArC4O,EAAYxK,EAAO+J,EAAOzB,GAAW2B,EAAArO,EAAA,cAId,OAAvB6O,EAAUV,EAAOhF,GAAMkF,EAAArO,EAAA,cAOtB,OAHGyM,GACoBrI,EAAMmK,SAAS9B,GACvBqC,SAASX,EAAO1L,MAAMsM,aAAaC,aAClDX,EAAArO,EAAA,cAIGmJ,IAAMgF,EAAM5J,OAAS,CAAC,CAAC4E,KAAO,eAAAkF,EAAArO,EAAA,KAAAkO,EAAA,KAE7C1M,MAAA,KAAAD,UAAA,UAEciN,EAAYS,EAAAC,GAAA,OAAAC,EAAA3N,MAAC,KAADD,UAAA,UAAA4N,IA0B1B,OA1B0BA,EAAA7N,EAAAT,IAAApE,EAA3B,SAAA2S,EAA4BjB,EAAOkB,GAAO,IAAAC,EAAAC,EAAAC,EAAAC,EAAAvQ,EAAA,OAAA2B,IAAAC,EAAA,SAAA4O,GAAA,cAAAA,EAAAtQ,GAAA,OAER,GADxBkQ,EAAOnB,EAAMzJ,SACb6K,EAAOpB,EAAM7I,YAEN,IAATgK,GAAuB,IAATC,EAAU,CAAAG,EAAAtQ,EAAA,QACK,OAA7B+O,EAAMqB,SAAW,CAAC,CAACH,IAAUK,EAAA1P,EAAA,UAI3BwP,EAAW,GAAEC,EAAA5O,IAAApE,EAAA,SAAAgT,EAAAvQ,GAAA,IAAAyQ,EAAApQ,EAAAK,EAAA,OAAAiB,IAAAC,EAAA,SAAA8O,GAAA,cAAAA,EAAAxQ,GAAA,OAGf,IADMuQ,EAAc,GACXpQ,EAAI,EAAGA,EAAIgQ,EAAMhQ,IAClBK,EAAIyP,EACJnQ,EAAI,IACJU,EAAIyP,EAAQ1Q,QAAQ,2BAA4B,SAAClC,EAAGoT,EAAIlF,EAAKmF,EAAIC,GAC7D,MAAW,MAAPD,EAAmBrT,EAChB,GAAP8I,OAAUsK,GAAEtK,OAAGoF,GAAGpF,OAAGuK,GAAEvK,OAAGyK,SAASD,GAAO7Q,EAC9C,IAEJyQ,EAAYnK,KAAK5F,GAErB4P,EAAShK,KAAKmK,GAAa,cAAAC,EAAA5P,EAAA,KAAAyP,EAAA,GAZtBvQ,EAAI,EAAC,YAAEA,EAAIoQ,GAAI,CAAAI,EAAAtQ,EAAA,eAAAsQ,EAAAhT,EAAAuT,EAAAR,EAAAvQ,IAAA,UAAEA,IAAGwQ,EAAAtQ,EAAA,eAe7B+O,EAAMqB,SAAWA,EAAS,cAAAE,EAAA1P,EAAA,KAAAoP,EAAA,KAC7B5N,MAAA,KAAAD,UAAA,CAED,SAASkN,EAAYN,EAAOhF,GACxB,IAAI5E,EACJ,IACIA,EAASoF,KAAKuG,MAAM/G,GACf2C,MAAMqE,QAAQ5L,KAASA,EAAS,CAAC,CAACA,KAClCuH,MAAMqE,QAAQ5L,EAAO,MAAKA,EAAS,CAACA,GAC7C,CAAE,MAAA6L,GACE7L,EAAS,CAAC,CAAC4E,GACf,CACAgF,EAAM5J,OAASA,CACnB,CAEA,SAASmK,EAAYP,EAAOhF,GACxB,IAAIkH,EACJ,IAAMA,EAAM1G,KAAKuG,MAAM/G,EAAO,CAAE,MAAAmH,GAAQD,EAAM,CAAC,CAAG,CAE9CA,EAAIE,OAAMpC,EAAMqC,OAAOC,KAAKF,MAAO,GACnCF,EAAIK,SAAQvC,EAAMqC,OAAOC,KAAKC,QAAS,GACvCL,EAAIM,OAAMxC,EAAMqC,OAAOG,KAAKC,MAAQP,EAAIM,MACxCN,EAAIQ,YAAW1C,EAAMqC,OAAOC,KAAKG,MAAQP,EAAIQ,WAC7CR,EAAIS,WAAU3C,EAAMqC,OAAOC,KAAK5E,KAAOwE,EAAIS,UAC3CT,EAAIU,eAAc5C,EAAM4C,aAAe,CAAC,CAACV,EAAIU,gBAC7CV,EAAIW,SACJ7C,EAAMqC,OAAOS,QAAQC,QAAQ,WAAWnL,MAAQ,aAChDoI,EAAMqC,OAAOS,QAAQC,QAAQ,cAAcnL,MAAQ,aACnDoI,EAAMqC,OAAOS,QAAQC,QAAQ,YAAYnL,MAAQ,aACjDoI,EAAMqC,OAAOS,QAAQC,QAAQ,aAAanL,MAAQ,aAE1D,CAAC,SAEc4I,EAAewC,EAAAC,EAAAC,EAAAC,GAAA,OAAAC,EAAA/P,MAAC,KAADD,UAAA,UAAAgQ,IAyB7B,OAzB6BA,EAAAjQ,EAAAT,IAAApE,EAA9B,SAAA+U,EAA+B3O,EAAKuB,EAAO+J,EAAO1B,GAAM,IAAAnI,EAAAmN,EAAAC,EAAA,OAAA7Q,IAAAC,EAAA,SAAA6Q,GAAA,cAAAA,EAAAvS,GAAA,WAChDqN,EAAQ,CAAFkF,EAAAvS,EAAA,QAEuB,OAA7B+O,EAAMyD,eAAeC,QAAQF,EAAAvS,EAAA,EACvByD,EAAIQ,OAAM,OAGG,OAAnBe,EAAMc,KAAK,QAAQyM,EAAAvS,EAAA,EACbyD,EAAIQ,OAAM,OAEViB,EAAYF,EAAMe,KAElBsM,EAAgBnN,EAAUwN,SAAS,KAAO,IAAHvM,OAAOjB,EAAS,KAAMA,EAG7DoN,EAAa,IAAHnM,OAAOkM,EAAa,KAAAlM,OAAIkH,GAGxC0B,EAAMyD,eAAeG,KAAO,CACxBC,KAAM,CACFC,gBAAgB,EAChBxF,OAAQiF,IAEd,cAAAC,EAAA3R,EAAA,KAAAwR,EAAA,KAEThQ,MAAA,KAAAD,UAAA,CAED,SAASqN,EAAYxK,EAAO8N,EAAWxF,GACnC,IAAItG,EAAO3D,MAAM0P,UAAUC,gBACrBC,GAAM3F,GAAa,IAAI4F,cAEzBD,EAAGP,SAAS,QAAS1L,EAAO3D,MAAM0P,UAAUI,KACvCF,EAAGP,SAAS,OAAQ1L,EAAO3D,MAAM0P,UAAUK,IAC3CH,EAAGP,SAAS,OAAQ1L,EAAO3D,MAAM0P,UAAUM,aAC3CJ,EAAGP,SAAS,QAAS1L,EAAO3D,MAAM0P,UAAUO,KAC5CL,EAAGP,SAAS,aAAY1L,EAAO3D,MAAM0P,UAAUQ,WAExD,IAAMC,EAAQxO,EAAMyO,OAAO1P,IAAIiD,EAAM8L,EAAWzP,MAAMqQ,cAAcC,MACpEH,EAAMI,YAAY,KAAM,OACxBJ,EAAMK,MAAM1K,KAAO,OACvB,CAEA,SAASsG,EAAUV,EAAOhF,GACtB,IAAM+J,EAAuB,iBAAT/J,EAAoBQ,KAAKuG,MAAM/G,GAASA,GAAQ,CAAC,EACrEgF,EAAMgF,KAAK3R,MAAM,CAAC,CAAE5E,IAAKsW,EAAKE,QAAU,EAAGC,WAA8B,IAAnBH,EAAKG,YAC/D,CAxpBAC,OAAOC,QAAQ,SAACC,GAMhB,IAMsBC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EACZC,EACAzM,EAbF+L,EAAKW,OAASb,OAAOc,SAAS3R,QAMlCb,EAAMC,OAASwS,aAAanD,QAAQvP,IAAuB,GAMrDuS,EAAUlW,SAASmE,eAAe,WAClCsF,EAAQzJ,SAASmE,eAAe,eAEtC+R,SAAAA,EAASI,iBAAiB,QAAShN,GACnCG,SAAAA,EAAO6M,iBAAiB,UAAW,SAAChX,GAClB,UAAVA,EAAEV,KAAoBU,EAAEiX,WACxBjX,EAAEkX,iBACFlN,IAER,GACAG,SAAAA,EAAO6M,iBAAiB,QAAS,WAC7BJ,EAAQ/M,UAAYM,EAAMpH,MAAM4H,OAChCR,EAAM1B,MAAMoC,OAAS,OACrBV,EAAM1B,MAAMoC,OAASvE,KAAKiH,IAAIpD,EAAMb,aAAc,KAAO,IAC7D,GAEmC,QAAnC6M,EAAAzV,SAASmE,eAAe,mBAAW,IAAAsR,GAAnCA,EAAqCa,iBAAiB,QAAS3H,GAE1B,QAArC+G,EAAA1V,SAASmE,eAAe,qBAAa,IAAAuR,GAArCA,EAAuCY,iBAAiB,QAAOhT,EAAAT,IAAApE,EAAE,SAAAgY,IAAA,IAAAC,EAAA,OAAA7T,IAAAC,EAAA,SAAA6T,GAAA,cAAAA,EAAAvV,GAAA,OAEhC,OADvBsV,EAAM1W,SAASmE,eAAe,eAChCC,UAAUe,IAAI,WAAWwR,EAAAvV,EAAA,EACvBgE,IAAe,OACrBsR,EAAItS,UAAUC,OAAO,WACrB+E,EAAM,aAAa,cAAAuN,EAAA3U,EAAA,KAAAyU,EAAA,KAGe,QAAtCd,EAAA3V,SAASmE,eAAe,sBAAc,IAAAwR,GAAtCA,EAAwCW,iBAAiB,QAAS,WAC9DtW,SAASmE,eAAe,eAAe9B,MAAQuB,EAAMC,OACrD7D,SAASmE,eAAe,SAASC,UAAUe,IAAI,OACnD,GAEqC,QAArCyQ,EAAA5V,SAASmE,eAAe,qBAAa,IAAAyR,GAArCA,EAAuCU,iBAAiB,QAASpS,GAC7B,QAApC2R,EAAA7V,SAASmE,eAAe,oBAAY,IAAA0R,GAApCA,EAAsCS,iBAAiB,QAASpS,GAC9B,QAAlC4R,EAAA9V,SAASmE,eAAe,kBAAU,IAAA2R,GAAlCA,EAAoCQ,iBAAiB,QAAS,WAC1D1S,EAAMC,OAAS7D,SAASmE,eAAe,eAAe9B,MAAM4H,OAC5DoM,aAAaO,QAAQjT,EAAoBC,EAAMC,QAC/CK,IACAkF,EAAM,QACV,GAEgC,QAAhC2M,EAAA/V,SAASmE,eAAe,gBAAQ,IAAA4R,GAAhCA,EAAkCO,iBAAiB,QAAS,SAAChX,GACrC,UAAhBA,EAAEkP,OAAOzF,IAAgB7E,GACjC,GAEmC,QAAnC8R,EAAAhW,SAASmE,eAAe,mBAAW,IAAA6R,GAAnCA,EAAqCM,iBAAiB,QAASpN,GAE/DlJ,SAAS6W,iBAAiB,iBAAiBC,QAAQ,SAAAhO,GAC/CA,EAAGwN,iBAAiB,QAAS,WACzBtW,SAASmE,eAAe,eAAe9B,MAAQyG,EAAGiO,QAAQrN,OAC1D1J,SAASmE,eAAe,WAAWgF,UAAW,EAC9CG,GACJ,EACJ,GAEoC,QAApC2M,EAAAjW,SAASmE,eAAe,oBAAY,IAAA8R,GAApCA,EAAsCK,iBAAiB,QAAS,WAC5D,IAAMU,EAAMhX,SAASmE,eAAe,eACpC6S,EAAI5O,KAAoB,aAAb4O,EAAI5O,KAAsB,OAAS,UAClD,GAOH,WAEoC9D,EAAAd,MAAC,KAADD,UAAA,CAPjC0T,GA/DA7R,IALJ,E,IC3BiC,IAAI8R,IAAI,a","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/define property getters","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Excel AI Copilot - Accurate Data Understanding\n */\n\n/* global document, Excel, Office, fetch, localStorage */\n\nconst CONFIG = {\n    GEMINI_MODEL: \"gemini-2.0-flash\",\n    API_ENDPOINT: \"https://generativelanguage.googleapis.com/v1beta/models/\",\n    STORAGE_KEY: \"excel_copilot_api_key\",\n    MAX_HISTORY: 10\n};\n\nconst state = {\n    apiKey: \"\",\n    pendingActions: [],\n    currentData: null,\n    conversationHistory: [],\n    isFirstMessage: true\n};\n\n// ============================================================================\n// Initialize\n// ============================================================================\nOffice.onReady((info) => {\n    if (info.host === Office.HostType.Excel) {\n        initApp();\n    }\n});\n\nfunction initApp() {\n    state.apiKey = localStorage.getItem(CONFIG.STORAGE_KEY) || \"\";\n    bindEvents();\n    readExcelData();\n}\n\nfunction bindEvents() {\n    const sendBtn = document.getElementById(\"sendBtn\");\n    const input = document.getElementById(\"promptInput\");\n    \n    sendBtn?.addEventListener(\"click\", handleSend);\n    input?.addEventListener(\"keydown\", (e) => {\n        if (e.key === \"Enter\" && !e.shiftKey) {\n            e.preventDefault();\n            handleSend();\n        }\n    });\n    input?.addEventListener(\"input\", () => {\n        sendBtn.disabled = !input.value.trim();\n        input.style.height = \"auto\";\n        input.style.height = Math.min(input.scrollHeight, 120) + \"px\";\n    });\n    \n    document.getElementById(\"applyBtn\")?.addEventListener(\"click\", handleApply);\n    \n    document.getElementById(\"refreshBtn\")?.addEventListener(\"click\", async () => {\n        const btn = document.getElementById(\"refreshBtn\");\n        btn.classList.add(\"loading\");\n        await readExcelData();\n        btn.classList.remove(\"loading\");\n        toast(\"Refreshed\");\n    });\n    \n    document.getElementById(\"settingsBtn\")?.addEventListener(\"click\", () => {\n        document.getElementById(\"apiKeyInput\").value = state.apiKey;\n        document.getElementById(\"modal\").classList.add(\"open\");\n    });\n    \n    document.getElementById(\"closeModal\")?.addEventListener(\"click\", closeModal);\n    document.getElementById(\"cancelBtn\")?.addEventListener(\"click\", closeModal);\n    document.getElementById(\"saveBtn\")?.addEventListener(\"click\", () => {\n        state.apiKey = document.getElementById(\"apiKeyInput\").value.trim();\n        localStorage.setItem(CONFIG.STORAGE_KEY, state.apiKey);\n        closeModal();\n        toast(\"Saved\");\n    });\n    \n    document.getElementById(\"modal\")?.addEventListener(\"click\", (e) => {\n        if (e.target.id === \"modal\") closeModal();\n    });\n    \n    document.getElementById(\"clearBtn\")?.addEventListener(\"click\", clearChat);\n    \n    document.querySelectorAll(\"[data-prompt]\").forEach(el => {\n        el.addEventListener(\"click\", () => {\n            document.getElementById(\"promptInput\").value = el.dataset.prompt;\n            document.getElementById(\"sendBtn\").disabled = false;\n            handleSend();\n        });\n    });\n    \n    document.getElementById(\"togglePwd\")?.addEventListener(\"click\", () => {\n        const inp = document.getElementById(\"apiKeyInput\");\n        inp.type = inp.type === \"password\" ? \"text\" : \"password\";\n    });\n    \n    setupSelectionListener();\n}\n\nfunction closeModal() {\n    document.getElementById(\"modal\").classList.remove(\"open\");\n}\n\nasync function setupSelectionListener() {\n    try {\n        await Excel.run(async (ctx) => {\n            ctx.workbook.worksheets.getActiveWorksheet().onSelectionChanged.add(readExcelData);\n            await ctx.sync();\n        });\n    } catch (e) { /* ignore */ }\n}\n\n// ============================================================================\n// Column Letter Helper\n// ============================================================================\nfunction colIndexToLetter(index) {\n    let letter = \"\";\n    while (index >= 0) {\n        letter = String.fromCharCode((index % 26) + 65) + letter;\n        index = Math.floor(index / 26) - 1;\n    }\n    return letter;\n}\n\n// ============================================================================\n// Read Excel Data with Column Headers\n// ============================================================================\nasync function readExcelData() {\n    const infoEl = document.getElementById(\"contextInfo\");\n    \n    try {\n        await Excel.run(async (ctx) => {\n            const sheet = ctx.workbook.worksheets.getActiveWorksheet();\n            const usedRange = sheet.getUsedRange();\n            \n            sheet.load(\"name\");\n            usedRange.load([\"address\", \"values\", \"rowCount\", \"columnCount\", \"columnIndex\", \"rowIndex\"]);\n            \n            await ctx.sync();\n            \n            const sheetName = sheet.name;\n            const values = usedRange.values;\n            const startCol = usedRange.columnIndex;\n            const startRow = usedRange.rowIndex;\n            const rowCount = usedRange.rowCount;\n            const colCount = usedRange.columnCount;\n            \n            // Detect headers (first row)\n            const headers = values[0] || [];\n            \n            // Build column mapping\n            const columnMap = [];\n            for (let c = 0; c < colCount; c++) {\n                const colLetter = colIndexToLetter(startCol + c);\n                const headerName = headers[c] || `Column ${colLetter}`;\n                columnMap.push({\n                    letter: colLetter,\n                    index: c,\n                    header: headerName\n                });\n            }\n            \n            state.currentData = {\n                sheetName,\n                address: usedRange.address,\n                values,\n                headers,\n                columnMap,\n                startRow: startRow + 1, // 1-based\n                startCol: colIndexToLetter(startCol),\n                rowCount,\n                colCount,\n                dataStartRow: startRow + 2 // Data starts after header (1-based)\n            };\n            \n            infoEl.textContent = `${sheetName}: ${rowCount} rows Ã— ${colCount} cols`;\n        });\n    } catch (e) {\n        infoEl.textContent = \"No data\";\n        state.currentData = null;\n    }\n}\n\n// ============================================================================\n// Chat UI\n// ============================================================================\nfunction showChat() {\n    if (state.isFirstMessage) {\n        document.getElementById(\"welcome\").style.display = \"none\";\n        document.getElementById(\"chat\").style.display = \"flex\";\n        state.isFirstMessage = false;\n    }\n}\n\nfunction addMessage(role, content, type = \"\") {\n    showChat();\n    const chat = document.getElementById(\"chat\");\n    const msg = document.createElement(\"div\");\n    msg.className = `msg ${role} ${type}`;\n    msg.innerHTML = `\n        <div class=\"msg-avatar\">${role === \"user\" ? \"U\" : \"AI\"}</div>\n        <div class=\"msg-body\">${formatText(content)}</div>\n    `;\n    chat.appendChild(msg);\n    chat.scrollTop = chat.scrollHeight;\n}\n\nfunction formatText(text) {\n    return text\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\")\n        .replace(/```(\\w*)\\n?([\\s\\S]*?)```/g, '<pre>$2</pre>')\n        .replace(/`([^`]+)`/g, '<code>$1</code>')\n        .replace(/\\*\\*([^*]+)\\*\\*/g, '<b>$1</b>')\n        .replace(/\\n/g, '<br>');\n}\n\nfunction showTyping() {\n    showChat();\n    const chat = document.getElementById(\"chat\");\n    const el = document.createElement(\"div\");\n    el.className = \"msg ai\";\n    el.id = \"typing\";\n    el.innerHTML = `<div class=\"msg-avatar\">AI</div><div class=\"msg-body\"><span class=\"dot\"></span><span class=\"dot\"></span><span class=\"dot\"></span></div>`;\n    chat.appendChild(el);\n    chat.scrollTop = chat.scrollHeight;\n}\n\nfunction hideTyping() {\n    document.getElementById(\"typing\")?.remove();\n}\n\nfunction clearChat() {\n    state.conversationHistory = [];\n    state.pendingActions = [];\n    state.isFirstMessage = true;\n    document.getElementById(\"chat\").innerHTML = \"\";\n    document.getElementById(\"chat\").style.display = \"none\";\n    document.getElementById(\"welcome\").style.display = \"flex\";\n    document.getElementById(\"applyBtn\").disabled = true;\n    toast(\"Cleared\");\n}\n\nfunction toast(msg) {\n    const t = document.getElementById(\"toast\");\n    t.textContent = msg;\n    t.classList.add(\"show\");\n    setTimeout(() => t.classList.remove(\"show\"), 2000);\n}\n\n// ============================================================================\n// AI Communication\n// ============================================================================\nasync function handleSend() {\n    const input = document.getElementById(\"promptInput\");\n    const prompt = input.value.trim();\n    if (!prompt) return;\n    \n    if (!state.apiKey) {\n        document.getElementById(\"settingsBtn\").click();\n        toast(\"Enter API key\");\n        return;\n    }\n    \n    await readExcelData();\n    \n    addMessage(\"user\", prompt);\n    \n    input.value = \"\";\n    input.style.height = \"auto\";\n    document.getElementById(\"sendBtn\").disabled = true;\n    \n    showTyping();\n    \n    try {\n        const response = await callAI(prompt);\n        hideTyping();\n        \n        const { message, actions } = parseResponse(response);\n        state.pendingActions = actions;\n        \n        addMessage(\"ai\", message, actions.length ? \"has-action\" : \"\");\n        \n        if (actions.length) {\n            document.getElementById(\"applyBtn\").disabled = false;\n        }\n        \n        state.conversationHistory.push(\n            { role: \"user\", parts: [{ text: prompt }] },\n            { role: \"model\", parts: [{ text: response }] }\n        );\n        \n        if (state.conversationHistory.length > CONFIG.MAX_HISTORY * 2) {\n            state.conversationHistory = state.conversationHistory.slice(-CONFIG.MAX_HISTORY * 2);\n        }\n    } catch (err) {\n        hideTyping();\n        addMessage(\"ai\", \"Error: \" + err.message, \"error\");\n    }\n}\n\nasync function callAI(userPrompt) {\n    const dataContext = buildDataContext();\n    const systemPrompt = getSystemPrompt();\n    \n    const fullUserMessage = `${dataContext}\\n\\n---\\nUSER REQUEST: ${userPrompt}`;\n    \n    const contents = [...state.conversationHistory];\n    contents.push({ role: \"user\", parts: [{ text: fullUserMessage }] });\n    \n    const res = await fetch(\n        `${CONFIG.API_ENDPOINT}${CONFIG.GEMINI_MODEL}:generateContent?key=${state.apiKey}`,\n        {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify({\n                systemInstruction: { parts: [{ text: systemPrompt }] },\n                contents,\n                generationConfig: { temperature: 0.1, maxOutputTokens: 4096 }\n            })\n        }\n    );\n    \n    if (!res.ok) throw new Error(`API Error: ${res.status}`);\n    \n    const data = await res.json();\n    return data?.candidates?.[0]?.content?.parts?.[0]?.text || \"No response\";\n}\n\nfunction buildDataContext() {\n    if (!state.currentData) {\n        return \"ERROR: No Excel data available.\";\n    }\n    \n    const { sheetName, values, columnMap, rowCount, colCount, dataStartRow, address } = state.currentData;\n    \n    let context = `## EXCEL WORKBOOK DATA\\n\\n`;\n    context += `**Sheet:** ${sheetName}\\n`;\n    context += `**Data Range:** ${address}\\n`;\n    context += `**Total Rows:** ${rowCount} (including header)\\n`;\n    context += `**Total Columns:** ${colCount}\\n\\n`;\n    \n    // Column structure - CRITICAL for AI to understand\n    context += `## COLUMN STRUCTURE\\n`;\n    context += `| Column Letter | Header Name | Sample Values |\\n`;\n    context += `|---------------|-------------|---------------|\\n`;\n    \n    for (const col of columnMap) {\n        // Get sample values from first few data rows\n        const samples = [];\n        for (let r = 1; r < Math.min(4, values.length); r++) {\n            const val = values[r]?.[col.index];\n            if (val !== null && val !== undefined && val !== \"\") {\n                samples.push(String(val).substring(0, 20));\n            }\n        }\n        context += `| ${col.letter} | ${col.header} | ${samples.join(\", \")} |\\n`;\n    }\n    \n    context += `\\n## DATA PREVIEW (First 30 rows)\\n\\n`;\n    \n    // Header row\n    context += `| Row |`;\n    for (const col of columnMap) {\n        context += ` ${col.letter}: ${col.header} |`;\n    }\n    context += `\\n|-----|`;\n    for (let c = 0; c < colCount; c++) {\n        context += `------------|`;\n    }\n    context += `\\n`;\n    \n    // Data rows\n    const maxRows = Math.min(30, values.length);\n    for (let r = 0; r < maxRows; r++) {\n        const rowNum = state.currentData.startRow + r;\n        context += `| ${rowNum} |`;\n        for (let c = 0; c < colCount; c++) {\n            let val = values[r]?.[c];\n            if (val === null || val === undefined) val = \"\";\n            val = String(val).substring(0, 25);\n            context += ` ${val} |`;\n        }\n        context += `\\n`;\n    }\n    \n    if (rowCount > 30) {\n        context += `\\n... and ${rowCount - 30} more rows\\n`;\n    }\n    \n    // Add unique values for key columns (for dropdowns)\n    context += `\\n## UNIQUE VALUES IN EACH COLUMN (for dropdowns)\\n`;\n    for (const col of columnMap) {\n        const uniqueVals = new Set();\n        for (let r = 1; r < values.length; r++) {\n            const val = values[r]?.[col.index];\n            if (val !== null && val !== undefined && val !== \"\") {\n                uniqueVals.add(val);\n            }\n        }\n        if (uniqueVals.size > 0 && uniqueVals.size <= 50) {\n            context += `**${col.letter} (${col.header}):** ${Array.from(uniqueVals).slice(0, 20).join(\", \")}`;\n            if (uniqueVals.size > 20) context += ` ... (${uniqueVals.size} total)`;\n            context += `\\n`;\n        }\n    }\n    \n    return context;\n}\n\nfunction getSystemPrompt() {\n    return `You are Excel Copilot, an expert Excel assistant. You have COMPLETE access to the user's Excel data.\n\n## CRITICAL RULES\n\n1. **CHECK THE COLUMN STRUCTURE TABLE** - Find the exact column letter for each header name\n2. **State column might be E, F, or any letter** - ALWAYS verify by looking at the table\n3. **Data starts at row 2** (row 1 is headers)\n\n## HOW TO CREATE A DROPDOWN\n\nFor a dropdown of values from a column:\n1. Look at COLUMN STRUCTURE to find the correct column letter\n2. Use the validation action with the source range\n\nExample: If \"State\" is in column E with data from row 2 to row 100:\n\n<ACTION type=\"validation\" target=\"K10\" source=\"E2:E100\">\n</ACTION>\n\nThat's it! Just one action. The source should be the actual data range (e.g., E2:E100).\n\n## ACTION TYPES\n\n**Dropdown/Validation:**\n<ACTION type=\"validation\" target=\"CELL\" source=\"DATARANGE\">\n</ACTION>\n\n**Formula:**\n<ACTION type=\"formula\" target=\"CELL_OR_RANGE\">\n=YOUR_FORMULA\n</ACTION>\n\n**Values:**\n<ACTION type=\"values\" target=\"RANGE\">\n[[\"val1\",\"val2\"],[\"val3\",\"val4\"]]\n</ACTION>\n\n**Format:**\n<ACTION type=\"format\" target=\"RANGE\">\n{\"bold\":true,\"fill\":\"#4472C4\",\"fontColor\":\"#FFFFFF\"}\n</ACTION>\n\n**Chart:**\n<ACTION type=\"chart\" target=\"DATARANGE\" chartType=\"column\">\n</ACTION>\n\n## IMPORTANT\n\n- ALWAYS check COLUMN STRUCTURE first\n- For dropdowns, source is the data column range (e.g., E2:E100)\n- Don't use UNIQUE formula for dropdowns - just use the source range directly\n- Excel will show unique values in the dropdown automatically from the source range`;\n}\n\nfunction parseResponse(text) {\n    const actions = [];\n    const actionRegex = /<ACTION\\s+([^>]*)>([\\s\\S]*?)<\\/ACTION>/g;\n    \n    let match;\n    while ((match = actionRegex.exec(text)) !== null) {\n        const attrs = match[1];\n        const content = match[2].trim();\n        \n        const type = attrs.match(/type=\"([^\"]+)\"/)?.[1] || \"formula\";\n        const target = attrs.match(/target=\"([^\"]+)\"/)?.[1] || \"\";\n        const source = attrs.match(/source=\"([^\"]+)\"/)?.[1] || \"\";\n        const chartType = attrs.match(/chartType=\"([^\"]+)\"/)?.[1] || \"column\";\n        \n        actions.push({ type, target, source, chartType, data: content });\n    }\n    \n    const message = text.replace(/<ACTION[\\s\\S]*?<\\/ACTION>/g, \"\").trim();\n    return { message: message || \"Ready to apply.\", actions };\n}\n\n// ============================================================================\n// Apply Actions\n// ============================================================================\nasync function handleApply() {\n    if (!state.pendingActions.length) {\n        toast(\"Nothing to apply\");\n        return;\n    }\n    \n    const applyBtn = document.getElementById(\"applyBtn\");\n    applyBtn.disabled = true;\n    applyBtn.textContent = \"Applying...\";\n    \n    let successCount = 0;\n    let errorMsg = \"\";\n    \n    try {\n        await Excel.run(async (ctx) => {\n            const sheet = ctx.workbook.worksheets.getActiveWorksheet();\n            \n            for (const action of state.pendingActions) {\n                try {\n                    await executeAction(ctx, sheet, action);\n                    await ctx.sync();\n                    successCount++;\n                } catch (e) {\n                    errorMsg = e.message;\n                    console.error(\"Action failed:\", e);\n                }\n            }\n        });\n        \n        if (successCount === state.pendingActions.length) {\n            addMessage(\"ai\", \"All changes applied successfully.\", \"success\");\n            toast(\"Applied\");\n        } else if (successCount > 0) {\n            addMessage(\"ai\", `${successCount}/${state.pendingActions.length} changes applied. Error: ${errorMsg}`, \"error\");\n        } else {\n            addMessage(\"ai\", `Failed: ${errorMsg}`, \"error\");\n        }\n        \n        state.pendingActions = [];\n        await readExcelData();\n    } catch (err) {\n        addMessage(\"ai\", \"Failed: \" + err.message, \"error\");\n        toast(\"Failed\");\n    }\n    \n    applyBtn.disabled = true;\n    applyBtn.textContent = \"Apply Changes\";\n}\n\nasync function executeAction(ctx, sheet, action) {\n    const { type, target, source, validationType, chartType, data } = action;\n    \n    if (!target) throw new Error(\"No target specified\");\n    \n    const range = sheet.getRange(target);\n    range.load([\"rowCount\", \"columnCount\"]);\n    await ctx.sync();\n    \n    switch (type) {\n        case \"formula\":\n            await applyFormula(range, data);\n            break;\n            \n        case \"values\":\n            applyValues(range, data);\n            break;\n            \n        case \"format\":\n            applyFormat(range, data);\n            break;\n            \n        case \"validation\":\n            await applyValidation(ctx, sheet, range, source);\n            break;\n            \n        case \"chart\":\n            createChart(sheet, range, chartType);\n            break;\n            \n        case \"sort\":\n            applySort(range, data);\n            break;\n            \n        case \"autofill\":\n            if (source) {\n                const sourceRange = sheet.getRange(source);\n                sourceRange.autoFill(range, Excel.AutoFillType.fillDefault);\n            }\n            break;\n            \n        default:\n            if (data) range.values = [[data]];\n    }\n}\n\nasync function applyFormula(range, formula) {\n    const rows = range.rowCount;\n    const cols = range.columnCount;\n    \n    if (rows === 1 && cols === 1) {\n        range.formulas = [[formula]];\n        return;\n    }\n    \n    const formulas = [];\n    for (let r = 0; r < rows; r++) {\n        const rowFormulas = [];\n        for (let c = 0; c < cols; c++) {\n            let f = formula;\n            if (r > 0) {\n                f = formula.replace(/(\\$?)([A-Z]+)(\\$?)(\\d+)/g, (m, d1, col, d2, row) => {\n                    if (d2 === \"$\") return m;\n                    return `${d1}${col}${d2}${parseInt(row) + r}`;\n                });\n            }\n            rowFormulas.push(f);\n        }\n        formulas.push(rowFormulas);\n    }\n    \n    range.formulas = formulas;\n}\n\nfunction applyValues(range, data) {\n    let values;\n    try {\n        values = JSON.parse(data);\n        if (!Array.isArray(values)) values = [[values]];\n        if (!Array.isArray(values[0])) values = [values];\n    } catch {\n        values = [[data]];\n    }\n    range.values = values;\n}\n\nfunction applyFormat(range, data) {\n    let fmt;\n    try { fmt = JSON.parse(data); } catch { fmt = {}; }\n    \n    if (fmt.bold) range.format.font.bold = true;\n    if (fmt.italic) range.format.font.italic = true;\n    if (fmt.fill) range.format.fill.color = fmt.fill;\n    if (fmt.fontColor) range.format.font.color = fmt.fontColor;\n    if (fmt.fontSize) range.format.font.size = fmt.fontSize;\n    if (fmt.numberFormat) range.numberFormat = [[fmt.numberFormat]];\n    if (fmt.border) {\n        range.format.borders.getItem(\"EdgeTop\").style = \"Continuous\";\n        range.format.borders.getItem(\"EdgeBottom\").style = \"Continuous\";\n        range.format.borders.getItem(\"EdgeLeft\").style = \"Continuous\";\n        range.format.borders.getItem(\"EdgeRight\").style = \"Continuous\";\n    }\n}\n\nasync function applyValidation(ctx, sheet, range, source) {\n    if (source) {\n        // Clear any existing validation first\n        range.dataValidation.clear();\n        await ctx.sync();\n        \n        // Get sheet name for proper reference\n        sheet.load(\"name\");\n        await ctx.sync();\n        \n        const sheetName = sheet.name;\n        // Handle sheet names with spaces\n        const safeSheetName = sheetName.includes(\" \") ? `'${sheetName}'` : sheetName;\n        \n        // Build the full reference with sheet name\n        const fullSource = `=${safeSheetName}!${source}`;\n        \n        // Set the validation rule\n        range.dataValidation.rule = {\n            list: {\n                inCellDropDown: true,\n                source: fullSource\n            }\n        };\n    }\n}\n\nfunction createChart(sheet, dataRange, chartType) {\n    let type = Excel.ChartType.columnClustered;\n    const ct = (chartType || \"\").toLowerCase();\n    \n    if (ct.includes(\"line\")) type = Excel.ChartType.line;\n    else if (ct.includes(\"pie\")) type = Excel.ChartType.pie;\n    else if (ct.includes(\"bar\")) type = Excel.ChartType.barClustered;\n    else if (ct.includes(\"area\")) type = Excel.ChartType.area;\n    else if (ct.includes(\"scatter\")) type = Excel.ChartType.xyscatter;\n    \n    const chart = sheet.charts.add(type, dataRange, Excel.ChartSeriesBy.auto);\n    chart.setPosition(\"H2\", \"P17\");\n    chart.title.text = \"Chart\";\n}\n\nfunction applySort(range, data) {\n    const opts = typeof data === \"string\" ? JSON.parse(data) : (data || {});\n    range.sort.apply([{ key: opts.column || 0, ascending: opts.ascending !== false }]);\n}\n\nexport { handleSend, handleApply, readExcelData, clearChat };\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html lang=\\\"en\\\"> <head> <meta charset=\\\"UTF-8\\\"> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Excel Copilot</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"> </head> <body> <div class=\\\"app\\\"> <header class=\\\"header\\\"> <div class=\\\"brand\\\"> <svg class=\\\"logo\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"currentColor\\\"> <path d=\\\"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5\\\"/> </svg> <span>Copilot</span> </div> <div class=\\\"header-actions\\\"> <button class=\\\"icon-btn\\\" id=\\\"clearBtn\\\" title=\\\"Clear\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"> <path d=\\\"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2\\\"/> </svg> </button> <button class=\\\"icon-btn\\\" id=\\\"settingsBtn\\\" title=\\\"Settings\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"> <circle cx=\\\"12\\\" cy=\\\"12\\\" r=\\\"3\\\"/><path d=\\\"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z\\\"/> </svg> </button> </div> </header> <main class=\\\"main\\\"> <div id=\\\"welcome\\\" class=\\\"welcome\\\"> <div class=\\\"welcome-icon\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"currentColor\\\"> <path d=\\\"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5\\\"/> </svg> </div> <h1>Excel Copilot</h1> <p>Your AI assistant for Excel. Select cells and ask me anything.</p> <div class=\\\"suggestions\\\"> <button data-prompt=\\\"Analyze this data and give me key insights\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"><path d=\\\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\\\"/></svg> Analyze data </button> <button data-prompt=\\\"Create a SUM formula for the selected cells\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"><path d=\\\"M4 7h16M4 12h16M4 17h10\\\"/></svg> Create formula </button> <button data-prompt=\\\"Create a chart to visualize this data\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"><path d=\\\"M18 20V10M12 20V4M6 20v-6\\\"/></svg> Create chart </button> <button data-prompt=\\\"Format this as a professional table with headers\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"><rect x=\\\"3\\\" y=\\\"3\\\" width=\\\"18\\\" height=\\\"18\\\" rx=\\\"2\\\"/><path d=\\\"M3 9h18M9 21V9\\\"/></svg> Format table </button> </div> </div> <div id=\\\"chat\\\" class=\\\"chat\\\"></div> </main> <div class=\\\"context-bar\\\"> <label class=\\\"toggle\\\"> <input type=\\\"checkbox\\\" id=\\\"useContext\\\" checked=\\\"checked\\\"> <span class=\\\"toggle-slider\\\"></span> </label> <span class=\\\"context-label\\\">Context:</span> <span class=\\\"context-info\\\" id=\\\"contextInfo\\\">No selection</span> <button class=\\\"icon-btn-sm\\\" id=\\\"refreshBtn\\\" title=\\\"Refresh\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"><path d=\\\"M23 4v6h-6M1 20v-6h6\\\"/><path d=\\\"M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15\\\"/></svg> </button> </div> <div class=\\\"input-area\\\"> <div class=\\\"input-box\\\"> <textarea id=\\\"promptInput\\\" placeholder=\\\"Ask me anything...\\\" rows=\\\"1\\\"></textarea> <button class=\\\"send-btn\\\" id=\\\"sendBtn\\\" disabled=\\\"disabled\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"currentColor\\\"><path d=\\\"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\\\"/></svg> </button> </div> <button class=\\\"apply-btn\\\" id=\\\"applyBtn\\\" disabled=\\\"disabled\\\">Apply Changes</button> </div> </div> <div class=\\\"modal\\\" id=\\\"modal\\\"> <div class=\\\"modal-box\\\"> <div class=\\\"modal-header\\\"> <h2>Settings</h2> <button class=\\\"icon-btn\\\" id=\\\"closeModal\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"><path d=\\\"M18 6L6 18M6 6l12 12\\\"/></svg> </button> </div> <div class=\\\"modal-body\\\"> <label>Gemini API Key</label> <div class=\\\"input-row\\\"> <input type=\\\"password\\\" id=\\\"apiKeyInput\\\" placeholder=\\\"Enter your API key\\\"> <button class=\\\"icon-btn\\\" id=\\\"togglePwd\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"><path d=\\\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\\\"/><circle cx=\\\"12\\\" cy=\\\"12\\\" r=\\\"3\\\"/></svg> </button> </div> <p class=\\\"hint\\\">Get your free key at <a href=\\\"https://aistudio.google.com/apikey\\\" target=\\\"_blank\\\">Google AI Studio</a></p> </div> <div class=\\\"modal-footer\\\"> <button class=\\\"btn-cancel\\\" id=\\\"cancelBtn\\\">Cancel</button> <button class=\\\"btn-save\\\" id=\\\"saveBtn\\\">Save</button> </div> </div> </div> <div class=\\\"toast\\\" id=\\\"toast\\\"></div> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","d","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","_invoke","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","CONFIG","state","apiKey","pendingActions","currentData","conversationHistory","isFirstMessage","closeModal","getElementById","classList","remove","_setupSelectionListener","_callee3","_context3","Excel","run","_ref2","_callee2","ctx","_context2","workbook","worksheets","getActiveWorksheet","onSelectionChanged","add","readExcelData","sync","_x1","colIndexToLetter","index","letter","String","fromCharCode","Math","floor","_readExcelData","_callee5","infoEl","_context5","_ref3","_callee4","sheet","usedRange","sheetName","values","startCol","startRow","rowCount","colCount","headers","columnMap","colLetter","headerName","_context4","getUsedRange","load","name","columnIndex","rowIndex","columnCount","concat","push","header","address","dataStartRow","textContent","_x10","showChat","style","display","addMessage","role","content","type","chat","msg","createElement","className","innerHTML","appendChild","scrollTop","scrollHeight","showTyping","el","id","hideTyping","_document$getElementB0","clearChat","disabled","toast","setTimeout","handleSend","_handleSend","_callee6","input","prompt","response","_parseResponse","message","actions","_t3","_context6","trim","click","height","callAI","parseResponse","parts","text","slice","_x","_callAI","_callee7","userPrompt","_data$candidates","dataContext","systemPrompt","fullUserMessage","contents","res","data","_context7","buildDataContext","getSystemPrompt","_toConsumableArray","fetch","method","body","JSON","stringify","systemInstruction","generationConfig","temperature","maxOutputTokens","ok","status","json","candidates","_state$currentData","context","_step","_iterator","_createForOfIteratorHelper","s","col","samples","min","_values$_r","val","substring","join","err","_step2","_iterator2","maxRows","rowNum","_values$r","_step3","_iterator3","uniqueVals","Set","_values$_r2","size","Array","from","match","actionRegex","exec","_attrs$match","_attrs$match2","_attrs$match3","_attrs$match4","attrs","target","source","chartType","handleApply","_handleApply","_callee9","applyBtn","successCount","errorMsg","_context9","_ref4","_callee8","_iterator4","_step4","action","_t4","_t5","_context8","executeAction","console","error","_x11","_x2","_x3","_x4","_executeAction","_callee0","range","_t7","_context0","validationType","getRange","applyFormula","applyValues","applyFormat","applyValidation","createChart","applySort","autoFill","AutoFillType","fillDefault","_x5","_x6","_applyFormula","_callee1","formula","rows","cols","formulas","_loop","_context10","rowFormulas","_context1","d1","d2","row","parseInt","_regeneratorValues","parse","isArray","_unused","fmt","_unused2","bold","format","font","italic","fill","color","fontColor","fontSize","numberFormat","border","borders","getItem","_x7","_x8","_x9","_x0","_applyValidation","_callee10","safeSheetName","fullSource","_context11","dataValidation","clear","includes","rule","list","inCellDropDown","dataRange","ChartType","columnClustered","ct","toLowerCase","line","pie","barClustered","area","xyscatter","chart","charts","ChartSeriesBy","auto","setPosition","title","opts","sort","column","ascending","Office","onReady","info","_document$getElementB","_document$getElementB2","_document$getElementB3","_document$getElementB4","_document$getElementB5","_document$getElementB6","_document$getElementB7","_document$getElementB8","_document$getElementB9","sendBtn","host","HostType","localStorage","addEventListener","shiftKey","preventDefault","_callee","btn","_context","setItem","querySelectorAll","forEach","dataset","inp","setupSelectionListener","URL"],"ignoreList":[],"sourceRoot":""}