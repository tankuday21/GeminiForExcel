{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/define property getters","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Excel AI Copilot - Accurate Data Understanding\n */\n\n/* global document, Excel, Office, fetch, localStorage */\n\nconst CONFIG = {\n    GEMINI_MODEL: \"gemini-2.0-flash\",\n    API_ENDPOINT: \"https://generativelanguage.googleapis.com/v1beta/models/\",\n    STORAGE_KEY: \"excel_copilot_api_key\",\n    THEME_KEY: \"excel_copilot_theme\",\n    MAX_HISTORY: 10,\n    MAX_RETRIES: 3,\n    RETRY_DELAY: 1000\n};\n\nconst state = {\n    apiKey: \"\",\n    pendingActions: [],\n    currentData: null,\n    conversationHistory: [],\n    isFirstMessage: true,\n    // Preview state\n    preview: {\n        selections: [],      // boolean[] - selection state for each action\n        expandedIndex: -1,   // number - index of expanded action (-1 if none)\n        highlightedIndex: -1 // number - index of highlighted action (-1 if none)\n    },\n    // History state for undo functionality\n    history: {\n        entries: [],         // HistoryEntry[] - all history entries, newest first\n        panelVisible: false, // boolean - whether history panel is shown\n        maxEntries: 20       // number - maximum entries to retain\n    }\n};\n\n// ============================================================================\n// Initialize\n// ============================================================================\nOffice.onReady((info) => {\n    if (info.host === Office.HostType.Excel) {\n        initApp();\n    }\n});\n\nfunction initApp() {\n    state.apiKey = localStorage.getItem(CONFIG.STORAGE_KEY) || \"\";\n    // Load saved theme\n    const savedTheme = localStorage.getItem(CONFIG.THEME_KEY);\n    if (savedTheme) {\n        document.documentElement.setAttribute('data-theme', savedTheme);\n    }\n    bindEvents();\n    readExcelData().then(() => {\n        // Show smart suggestions after data is loaded\n        showSmartSuggestions();\n    });\n}\n\nfunction bindEvents() {\n    const sendBtn = document.getElementById(\"sendBtn\");\n    const input = document.getElementById(\"promptInput\");\n    \n    sendBtn?.addEventListener(\"click\", handleSend);\n    input?.addEventListener(\"keydown\", (e) => {\n        if (e.key === \"Enter\" && !e.shiftKey) {\n            e.preventDefault();\n            handleSend();\n        }\n    });\n    input?.addEventListener(\"input\", () => {\n        sendBtn.disabled = !input.value.trim();\n        input.style.height = \"auto\";\n        input.style.height = Math.min(input.scrollHeight, 120) + \"px\";\n    });\n    \n    document.getElementById(\"applyBtn\")?.addEventListener(\"click\", handleApply);\n    \n    document.getElementById(\"refreshBtn\")?.addEventListener(\"click\", async () => {\n        const btn = document.getElementById(\"refreshBtn\");\n        btn.classList.add(\"loading\");\n        await readExcelData();\n        btn.classList.remove(\"loading\");\n        toast(\"Refreshed\");\n    });\n    \n    document.getElementById(\"settingsBtn\")?.addEventListener(\"click\", () => {\n        document.getElementById(\"apiKeyInput\").value = state.apiKey;\n        document.getElementById(\"modal\").classList.add(\"open\");\n    });\n    \n    document.getElementById(\"closeModal\")?.addEventListener(\"click\", closeModal);\n    document.getElementById(\"cancelBtn\")?.addEventListener(\"click\", closeModal);\n    document.getElementById(\"saveBtn\")?.addEventListener(\"click\", () => {\n        state.apiKey = document.getElementById(\"apiKeyInput\").value.trim();\n        localStorage.setItem(CONFIG.STORAGE_KEY, state.apiKey);\n        closeModal();\n        toast(\"Saved\");\n    });\n    \n    document.getElementById(\"modal\")?.addEventListener(\"click\", (e) => {\n        if (e.target.id === \"modal\") closeModal();\n    });\n    \n    document.getElementById(\"clearBtn\")?.addEventListener(\"click\", clearChat);\n    \n    // History and Undo buttons\n    document.getElementById(\"historyBtn\")?.addEventListener(\"click\", toggleHistoryPanel);\n    document.getElementById(\"undoBtn\")?.addEventListener(\"click\", performUndo);\n    \n    // Theme toggle\n    document.getElementById(\"themeBtn\")?.addEventListener(\"click\", toggleTheme);\n    \n    // Keyboard shortcuts\n    document.addEventListener(\"keydown\", handleKeyboardShortcuts);\n    \n    document.querySelectorAll(\"[data-prompt]\").forEach(el => {\n        el.addEventListener(\"click\", () => {\n            document.getElementById(\"promptInput\").value = el.dataset.prompt;\n            document.getElementById(\"sendBtn\").disabled = false;\n            handleSend();\n        });\n    });\n    \n    document.getElementById(\"togglePwd\")?.addEventListener(\"click\", () => {\n        const inp = document.getElementById(\"apiKeyInput\");\n        inp.type = inp.type === \"password\" ? \"text\" : \"password\";\n    });\n    \n    setupSelectionListener();\n}\n\nfunction closeModal() {\n    document.getElementById(\"modal\").classList.remove(\"open\");\n}\n\nasync function setupSelectionListener() {\n    try {\n        await Excel.run(async (ctx) => {\n            ctx.workbook.worksheets.getActiveWorksheet().onSelectionChanged.add(readExcelData);\n            await ctx.sync();\n        });\n    } catch (e) { /* ignore */ }\n}\n\n// ============================================================================\n// Column Letter Helper\n// ============================================================================\nfunction colIndexToLetter(index) {\n    let letter = \"\";\n    while (index >= 0) {\n        letter = String.fromCharCode((index % 26) + 65) + letter;\n        index = Math.floor(index / 26) - 1;\n    }\n    return letter;\n}\n\n// ============================================================================\n// Read Excel Data with Column Headers\n// ============================================================================\nasync function readExcelData() {\n    const infoEl = document.getElementById(\"contextInfo\");\n    \n    try {\n        await Excel.run(async (ctx) => {\n            const sheet = ctx.workbook.worksheets.getActiveWorksheet();\n            const usedRange = sheet.getUsedRange();\n            \n            sheet.load(\"name\");\n            usedRange.load([\"address\", \"values\", \"rowCount\", \"columnCount\", \"columnIndex\", \"rowIndex\"]);\n            \n            await ctx.sync();\n            \n            const sheetName = sheet.name;\n            const values = usedRange.values;\n            const startCol = usedRange.columnIndex;\n            const startRow = usedRange.rowIndex;\n            const rowCount = usedRange.rowCount;\n            const colCount = usedRange.columnCount;\n            \n            // Detect headers (first row)\n            const headers = values[0] || [];\n            \n            // Build column mapping\n            const columnMap = [];\n            for (let c = 0; c < colCount; c++) {\n                const colLetter = colIndexToLetter(startCol + c);\n                const headerName = headers[c] || `Column ${colLetter}`;\n                columnMap.push({\n                    letter: colLetter,\n                    index: c,\n                    header: headerName\n                });\n            }\n            \n            state.currentData = {\n                sheetName,\n                address: usedRange.address,\n                values,\n                headers,\n                columnMap,\n                startRow: startRow + 1, // 1-based\n                startCol: colIndexToLetter(startCol),\n                rowCount,\n                colCount,\n                dataStartRow: startRow + 2 // Data starts after header (1-based)\n            };\n            \n            infoEl.textContent = `${sheetName}: ${rowCount} rows Ã— ${colCount} cols`;\n            \n            // Show smart suggestions based on data\n            if (state.isFirstMessage) {\n                showSmartSuggestions();\n            }\n        });\n    } catch (e) {\n        infoEl.textContent = \"No data\";\n        state.currentData = null;\n        hideSmartSuggestions();\n    }\n}\n\n// ============================================================================\n// Chat UI\n// ============================================================================\nfunction showChat() {\n    if (state.isFirstMessage) {\n        document.getElementById(\"welcome\").style.display = \"none\";\n        document.getElementById(\"chat\").style.display = \"flex\";\n        state.isFirstMessage = false;\n    }\n}\n\nfunction addMessage(role, content, type = \"\") {\n    showChat();\n    const chat = document.getElementById(\"chat\");\n    const msg = document.createElement(\"div\");\n    msg.className = `msg ${role} ${type}`;\n    msg.innerHTML = `\n        <div class=\"msg-avatar\">${role === \"user\" ? \"U\" : \"AI\"}</div>\n        <div class=\"msg-body\">${formatText(content)}</div>\n    `;\n    chat.appendChild(msg);\n    chat.scrollTop = chat.scrollHeight;\n}\n\nfunction formatText(text) {\n    return text\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\")\n        .replace(/```(\\w*)\\n?([\\s\\S]*?)```/g, '<pre>$2</pre>')\n        .replace(/`([^`]+)`/g, '<code>$1</code>')\n        .replace(/\\*\\*([^*]+)\\*\\*/g, '<b>$1</b>')\n        .replace(/\\n/g, '<br>');\n}\n\nfunction showTyping() {\n    showChat();\n    const chat = document.getElementById(\"chat\");\n    const el = document.createElement(\"div\");\n    el.className = \"msg ai\";\n    el.id = \"typing\";\n    el.innerHTML = `<div class=\"msg-avatar\">AI</div><div class=\"msg-body\"><span class=\"dot\"></span><span class=\"dot\"></span><span class=\"dot\"></span></div>`;\n    chat.appendChild(el);\n    chat.scrollTop = chat.scrollHeight;\n}\n\nfunction hideTyping() {\n    document.getElementById(\"typing\")?.remove();\n}\n\n// ============================================================================\n// Loading Skeleton\n// ============================================================================\n\nfunction showLoadingSkeleton() {\n    showChat();\n    const chat = document.getElementById(\"chat\");\n    const el = document.createElement(\"div\");\n    el.className = \"skeleton-msg\";\n    el.id = \"loading-skeleton\";\n    el.innerHTML = `\n        <div class=\"skeleton skeleton-avatar\"></div>\n        <div class=\"skeleton-content\">\n            <div class=\"skeleton skeleton-line\" style=\"width: 90%\"></div>\n            <div class=\"skeleton skeleton-line\" style=\"width: 75%\"></div>\n            <div class=\"skeleton skeleton-line\" style=\"width: 60%\"></div>\n        </div>\n    `;\n    chat.appendChild(el);\n    chat.scrollTop = chat.scrollHeight;\n}\n\nfunction hideLoadingSkeleton() {\n    document.getElementById(\"loading-skeleton\")?.remove();\n}\n\n// ============================================================================\n// Smart Suggestions\n// ============================================================================\n\nfunction generateSmartSuggestions() {\n    const suggestions = [];\n    const data = state.currentData;\n    \n    if (!data) return suggestions;\n    \n    // Based on data characteristics\n    if (data.rowCount > 5) {\n        suggestions.push({ icon: 'ðŸ“Š', text: 'Summarize this data', prompt: 'Summarize this data and give me key statistics' });\n    }\n    \n    // Check for numeric columns\n    const hasNumbers = data.values.some(row => row.some(cell => typeof cell === 'number'));\n    if (hasNumbers) {\n        suggestions.push({ icon: 'âž•', text: 'Add totals', prompt: 'Add SUM formulas for all numeric columns' });\n        suggestions.push({ icon: 'ðŸ“ˆ', text: 'Create chart', prompt: 'Create a chart to visualize this data' });\n    }\n    \n    // Check for potential duplicates\n    if (data.rowCount > 10) {\n        suggestions.push({ icon: 'ðŸ”', text: 'Find duplicates', prompt: 'Check for duplicate values in this data' });\n    }\n    \n    // Check column headers for common patterns\n    const headers = data.headers.map(h => String(h).toLowerCase());\n    if (headers.some(h => h.includes('date') || h.includes('time'))) {\n        suggestions.push({ icon: 'ðŸ“…', text: 'Sort by date', prompt: 'Sort this data by date column' });\n    }\n    if (headers.some(h => h.includes('price') || h.includes('amount') || h.includes('cost'))) {\n        suggestions.push({ icon: 'ðŸ’°', text: 'Calculate totals', prompt: 'Calculate the total of all monetary values' });\n    }\n    if (headers.some(h => h.includes('email'))) {\n        suggestions.push({ icon: 'âœ‰ï¸', text: 'Validate emails', prompt: 'Check if all email addresses are valid' });\n    }\n    \n    return suggestions.slice(0, 4); // Max 4 suggestions\n}\n\nfunction showSmartSuggestions() {\n    const container = document.getElementById(\"smartSuggestions\");\n    if (!container) return;\n    \n    const suggestions = generateSmartSuggestions();\n    \n    if (suggestions.length === 0) {\n        container.style.display = \"none\";\n        return;\n    }\n    \n    container.innerHTML = suggestions.map(s => `\n        <button class=\"smart-suggestion\" data-prompt=\"${s.prompt}\">\n            <span>${s.icon}</span> ${s.text}\n        </button>\n    `).join('');\n    \n    container.style.display = \"flex\";\n    \n    // Bind click events\n    container.querySelectorAll(\".smart-suggestion\").forEach(btn => {\n        btn.addEventListener(\"click\", () => {\n            document.getElementById(\"promptInput\").value = btn.dataset.prompt;\n            document.getElementById(\"sendBtn\").disabled = false;\n            container.style.display = \"none\";\n            handleSend();\n        });\n    });\n}\n\nfunction hideSmartSuggestions() {\n    const container = document.getElementById(\"smartSuggestions\");\n    if (container) container.style.display = \"none\";\n}\n\n// ============================================================================\n// Formula Explanation\n// ============================================================================\n\nfunction explainFormula(formula) {\n    const explanations = {\n        'SUM': 'Adds all numbers in a range',\n        'AVERAGE': 'Calculates the average of numbers',\n        'COUNT': 'Counts cells with numbers',\n        'COUNTA': 'Counts non-empty cells',\n        'MAX': 'Returns the largest value',\n        'MIN': 'Returns the smallest value',\n        'IF': 'Returns one value if true, another if false',\n        'VLOOKUP': 'Looks up a value in the first column and returns a value in the same row',\n        'XLOOKUP': 'Searches a range and returns a matching item',\n        'INDEX': 'Returns a value at a given position',\n        'MATCH': 'Returns the position of a value in a range',\n        'CONCATENATE': 'Joins text strings together',\n        'LEFT': 'Returns characters from the start of text',\n        'RIGHT': 'Returns characters from the end of text',\n        'MID': 'Returns characters from the middle of text',\n        'LEN': 'Returns the length of text',\n        'TRIM': 'Removes extra spaces from text',\n        'UPPER': 'Converts text to uppercase',\n        'LOWER': 'Converts text to lowercase',\n        'ROUND': 'Rounds a number to specified digits',\n        'SUMIF': 'Adds cells that meet a condition',\n        'COUNTIF': 'Counts cells that meet a condition',\n        'IFERROR': 'Returns a value if there is an error',\n        'TODAY': 'Returns the current date',\n        'NOW': 'Returns the current date and time',\n        'YEAR': 'Returns the year from a date',\n        'MONTH': 'Returns the month from a date',\n        'DAY': 'Returns the day from a date'\n    };\n    \n    // Extract function name from formula\n    const match = formula.match(/=?([A-Z]+)\\(/i);\n    if (match) {\n        const funcName = match[1].toUpperCase();\n        return explanations[funcName] || `${funcName} function`;\n    }\n    return 'Excel formula';\n}\n\nfunction clearChat() {\n    state.conversationHistory = [];\n    state.pendingActions = [];\n    state.isFirstMessage = true;\n    state.preview.selections = [];\n    state.preview.expandedIndex = -1;\n    document.getElementById(\"chat\").innerHTML = \"\";\n    document.getElementById(\"chat\").style.display = \"none\";\n    document.getElementById(\"welcome\").style.display = \"flex\";\n    document.getElementById(\"applyBtn\").disabled = true;\n    hidePreviewPanel();\n    toast(\"Cleared\");\n}\n\nfunction toast(msg) {\n    const t = document.getElementById(\"toast\");\n    t.textContent = msg;\n    t.classList.add(\"show\");\n    setTimeout(() => t.classList.remove(\"show\"), 2000);\n}\n\n// ============================================================================\n// AI Communication\n// ============================================================================\nasync function handleSend() {\n    const input = document.getElementById(\"promptInput\");\n    const prompt = input.value.trim();\n    if (!prompt) return;\n    \n    if (!state.apiKey) {\n        document.getElementById(\"settingsBtn\").click();\n        toast(\"Enter API key\");\n        return;\n    }\n    \n    await readExcelData();\n    \n    addMessage(\"user\", prompt);\n    \n    input.value = \"\";\n    input.style.height = \"auto\";\n    document.getElementById(\"sendBtn\").disabled = true;\n    \n    showTyping();\n    showLoadingSkeleton();\n    hideSmartSuggestions();\n    \n    try {\n        const response = await callAI(prompt);\n        hideTyping();\n        hideLoadingSkeleton();\n        \n        const { message, actions } = parseResponse(response);\n        state.pendingActions = actions;\n        \n        addMessage(\"ai\", message, actions.length ? \"has-action\" : \"\");\n        \n        if (actions.length) {\n            // Initialize preview state and show preview panel\n            state.preview.selections = actions.map(() => true);\n            state.preview.expandedIndex = -1;\n            showPreviewPanel();\n        } else {\n            hidePreviewPanel();\n        }\n        \n        state.conversationHistory.push(\n            { role: \"user\", parts: [{ text: prompt }] },\n            { role: \"model\", parts: [{ text: response }] }\n        );\n        \n        if (state.conversationHistory.length > CONFIG.MAX_HISTORY * 2) {\n            state.conversationHistory = state.conversationHistory.slice(-CONFIG.MAX_HISTORY * 2);\n        }\n    } catch (err) {\n        hideTyping();\n        hideLoadingSkeleton();\n        addMessage(\"ai\", getErrorMessage(err), \"error\");\n    }\n}\n\nasync function callAI(userPrompt) {\n    const dataContext = buildDataContext();\n    const systemPrompt = getSystemPrompt();\n    \n    const fullUserMessage = `${dataContext}\\n\\n---\\nUSER REQUEST: ${userPrompt}`;\n    \n    const contents = [...state.conversationHistory];\n    contents.push({ role: \"user\", parts: [{ text: fullUserMessage }] });\n    \n    // Use retry logic for transient errors\n    return await withRetry(async () => {\n        const res = await fetch(\n            `${CONFIG.API_ENDPOINT}${CONFIG.GEMINI_MODEL}:generateContent?key=${state.apiKey}`,\n            {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({\n                    systemInstruction: { parts: [{ text: systemPrompt }] },\n                    contents,\n                    generationConfig: { temperature: 0.1, maxOutputTokens: 4096 }\n                })\n            }\n        );\n        \n        if (!res.ok) throw new Error(`API Error: ${res.status}`);\n        \n        const data = await res.json();\n        return data?.candidates?.[0]?.content?.parts?.[0]?.text || \"No response\";\n    });\n}\n\nfunction buildDataContext() {\n    if (!state.currentData) {\n        return \"ERROR: No Excel data available.\";\n    }\n    \n    const { sheetName, values, columnMap, rowCount, colCount, dataStartRow, address } = state.currentData;\n    \n    let context = `## EXCEL WORKBOOK DATA\\n\\n`;\n    context += `**Sheet:** ${sheetName}\\n`;\n    context += `**Data Range:** ${address}\\n`;\n    context += `**Total Rows:** ${rowCount} (including header)\\n`;\n    context += `**Total Columns:** ${colCount}\\n\\n`;\n    \n    // Column structure - CRITICAL for AI to understand\n    context += `## COLUMN STRUCTURE\\n`;\n    context += `| Column Letter | Header Name | Sample Values |\\n`;\n    context += `|---------------|-------------|---------------|\\n`;\n    \n    for (const col of columnMap) {\n        // Get sample values from first few data rows\n        const samples = [];\n        for (let r = 1; r < Math.min(4, values.length); r++) {\n            const val = values[r]?.[col.index];\n            if (val !== null && val !== undefined && val !== \"\") {\n                samples.push(String(val).substring(0, 20));\n            }\n        }\n        context += `| ${col.letter} | ${col.header} | ${samples.join(\", \")} |\\n`;\n    }\n    \n    context += `\\n## DATA PREVIEW (First 30 rows)\\n\\n`;\n    \n    // Header row\n    context += `| Row |`;\n    for (const col of columnMap) {\n        context += ` ${col.letter}: ${col.header} |`;\n    }\n    context += `\\n|-----|`;\n    for (let c = 0; c < colCount; c++) {\n        context += `------------|`;\n    }\n    context += `\\n`;\n    \n    // Data rows\n    const maxRows = Math.min(30, values.length);\n    for (let r = 0; r < maxRows; r++) {\n        const rowNum = state.currentData.startRow + r;\n        context += `| ${rowNum} |`;\n        for (let c = 0; c < colCount; c++) {\n            let val = values[r]?.[c];\n            if (val === null || val === undefined) val = \"\";\n            val = String(val).substring(0, 25);\n            context += ` ${val} |`;\n        }\n        context += `\\n`;\n    }\n    \n    if (rowCount > 30) {\n        context += `\\n... and ${rowCount - 30} more rows\\n`;\n    }\n    \n    // Add unique values for key columns (for dropdowns)\n    context += `\\n## UNIQUE VALUES IN EACH COLUMN (for dropdowns)\\n`;\n    for (const col of columnMap) {\n        const uniqueVals = new Set();\n        for (let r = 1; r < values.length; r++) {\n            const val = values[r]?.[col.index];\n            if (val !== null && val !== undefined && val !== \"\") {\n                uniqueVals.add(val);\n            }\n        }\n        if (uniqueVals.size > 0 && uniqueVals.size <= 50) {\n            context += `**${col.letter} (${col.header}):** ${Array.from(uniqueVals).slice(0, 20).join(\", \")}`;\n            if (uniqueVals.size > 20) context += ` ... (${uniqueVals.size} total)`;\n            context += `\\n`;\n        }\n    }\n    \n    return context;\n}\n\nfunction getSystemPrompt() {\n    return `You are Excel Copilot, an expert Excel assistant. You have COMPLETE access to the user's Excel data.\n\n## CRITICAL RULES\n\n1. **CHECK THE COLUMN STRUCTURE TABLE** - Find the exact column letter for each header name\n2. **State column might be E, F, or any letter** - ALWAYS verify by looking at the table\n3. **Data starts at row 2** (row 1 is headers)\n\n## HOW TO CREATE A DROPDOWN\n\nFor a dropdown of values from a column:\n1. Look at COLUMN STRUCTURE to find the correct column letter\n2. Use the validation action with the source range\n\nExample: If \"State\" is in column E with data from row 2 to row 100:\n\n<ACTION type=\"validation\" target=\"K10\" source=\"E2:E100\">\n</ACTION>\n\nThat's it! Just one action. The source should be the actual data range (e.g., E2:E100).\n\n## ACTION TYPES\n\n**Dropdown/Validation:**\n<ACTION type=\"validation\" target=\"CELL\" source=\"DATARANGE\">\n</ACTION>\n\n**Formula:**\n<ACTION type=\"formula\" target=\"CELL_OR_RANGE\">\n=YOUR_FORMULA\n</ACTION>\n\n**Values:**\n<ACTION type=\"values\" target=\"RANGE\">\n[[\"val1\",\"val2\"],[\"val3\",\"val4\"]]\n</ACTION>\n\n**Format:**\n<ACTION type=\"format\" target=\"RANGE\">\n{\"bold\":true,\"fill\":\"#4472C4\",\"fontColor\":\"#FFFFFF\"}\n</ACTION>\n\n**Chart:**\n<ACTION type=\"chart\" target=\"DATARANGE\" chartType=\"TYPE\" title=\"TITLE\" position=\"CELL\">\n</ACTION>\n\n## CHART TYPES\n- **column** - Vertical bar chart (default, good for comparing categories)\n- **bar** - Horizontal bar chart (good for long category names)\n- **line** - Line chart (good for trends over time)\n- **pie** - Pie chart (good for showing parts of a whole, use with 1 data series)\n- **area** - Area chart (good for cumulative totals over time)\n- **scatter** - XY Scatter plot (good for correlation between 2 variables)\n- **doughnut** - Like pie but with hole in center\n- **radar** - Spider/radar chart (good for comparing multiple variables)\n\n## CHART EXAMPLES\n\n**Sales by Region (Column Chart):**\n<ACTION type=\"chart\" target=\"A1:B10\" chartType=\"column\" title=\"Sales by Region\" position=\"H2\">\n</ACTION>\n\n**Trend Over Time (Line Chart):**\n<ACTION type=\"chart\" target=\"A1:C20\" chartType=\"line\" title=\"Monthly Trend\" position=\"H2\">\n</ACTION>\n\n**Market Share (Pie Chart):**\n<ACTION type=\"chart\" target=\"A1:B5\" chartType=\"pie\" title=\"Market Share\" position=\"H2\">\n</ACTION>\n\n**Comparison (Bar Chart):**\n<ACTION type=\"chart\" target=\"A1:D10\" chartType=\"bar\" title=\"Product Comparison\" position=\"H2\">\n</ACTION>\n\n## CHART TIPS\n- Include headers in the data range (first row/column as labels)\n- For pie charts, use only 2 columns (labels + values)\n- Position is where the top-left of chart will be placed\n- Choose chart type based on what story the data tells\n\n## IMPORTANT\n\n- ALWAYS check COLUMN STRUCTURE first\n- For dropdowns, source is the data column range (e.g., E2:E100)\n- Don't use UNIQUE formula for dropdowns - just use the source range directly\n- For charts, include the header row in the target range`;\n}\n\nfunction parseResponse(text) {\n    const actions = [];\n    const actionRegex = /<ACTION\\s+([^>]*)>([\\s\\S]*?)<\\/ACTION>/g;\n    \n    let match;\n    while ((match = actionRegex.exec(text)) !== null) {\n        const attrs = match[1];\n        const content = match[2].trim();\n        \n        const type = attrs.match(/type=\"([^\"]+)\"/)?.[1] || \"formula\";\n        const target = attrs.match(/target=\"([^\"]+)\"/)?.[1] || \"\";\n        const source = attrs.match(/source=\"([^\"]+)\"/)?.[1] || \"\";\n        const chartType = attrs.match(/chartType=\"([^\"]+)\"/)?.[1] || \"column\";\n        const title = attrs.match(/title=\"([^\"]+)\"/)?.[1] || \"\";\n        const position = attrs.match(/position=\"([^\"]+)\"/)?.[1] || \"H2\";\n        \n        actions.push({ type, target, source, chartType, title, position, data: content });\n    }\n    \n    const message = text.replace(/<ACTION[\\s\\S]*?<\\/ACTION>/g, \"\").trim();\n    return { message: message || \"Ready to apply.\", actions };\n}\n\n// ============================================================================\n// Preview Panel Functions\n// ============================================================================\n\n/**\n * Gets the SVG icon for an action type\n * @param {string} type - Action type\n * @returns {string} SVG icon markup\n */\nfunction getActionIcon(type) {\n    const icons = {\n        formula: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M4 7h16M4 12h16M4 17h10\"/><text x=\"18\" y=\"18\" font-size=\"8\" fill=\"currentColor\">fx</text></svg>',\n        values: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\"/><path d=\"M3 9h18M9 21V9\"/></svg>',\n        format: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M4 20h16M6 16l6-12 6 12M8 12h8\"/></svg>',\n        chart: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M18 20V10M12 20V4M6 20v-6\"/></svg>',\n        validation: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M9 11l3 3L22 4\"/><path d=\"M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11\"/></svg>',\n        sort: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M3 6h18M3 12h12M3 18h6\"/></svg>',\n        autofill: '<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M12 5v14M5 12h14\"/></svg>'\n    };\n    return icons[type] || icons.formula;\n}\n\n/**\n * Gets a summary string for an action\n * @param {Object} action - The action to summarize\n * @returns {string} Human-readable summary\n */\nfunction getActionSummary(action) {\n    const typeLabels = {\n        formula: \"Formula\",\n        values: \"Values\",\n        format: \"Format\",\n        chart: \"Chart\",\n        validation: \"Dropdown\",\n        sort: \"Sort\",\n        autofill: \"Autofill\"\n    };\n    return typeLabels[action.type] || action.type;\n}\n\n/**\n * Gets detailed description for an action\n * @param {Object} action - The action to describe\n * @returns {string} Detailed description\n */\nfunction getActionDetails(action) {\n    switch (action.type) {\n        case \"formula\":\n            return action.data || \"No formula\";\n        case \"values\":\n            try {\n                const vals = JSON.parse(action.data);\n                return JSON.stringify(vals, null, 2);\n            } catch {\n                return action.data || \"No values\";\n            }\n        case \"format\":\n            try {\n                const fmt = JSON.parse(action.data);\n                const parts = [];\n                if (fmt.bold) parts.push(\"Bold\");\n                if (fmt.italic) parts.push(\"Italic\");\n                if (fmt.fill) parts.push(`Fill: ${fmt.fill}`);\n                if (fmt.fontColor) parts.push(`Color: ${fmt.fontColor}`);\n                if (fmt.fontSize) parts.push(`Size: ${fmt.fontSize}`);\n                if (fmt.numberFormat) parts.push(`Format: ${fmt.numberFormat}`);\n                return parts.join(\", \") || \"No formatting\";\n            } catch {\n                return action.data || \"No format data\";\n            }\n        case \"chart\":\n            return `Type: ${action.chartType}\\nData: ${action.target}\\nPosition: ${action.position}${action.title ? `\\nTitle: ${action.title}` : \"\"}`;\n        case \"validation\":\n            return `Source: ${action.source}`;\n        case \"sort\":\n            return action.data || \"Default sort\";\n        case \"autofill\":\n            return `Source: ${action.source}`;\n        default:\n            return action.data || \"No details\";\n    }\n}\n\n/**\n * Filters actions based on selection state\n * @param {Object[]} actions - All pending actions\n * @param {boolean[]} selections - Selection state for each action\n * @returns {Object[]} Only the selected actions\n */\nfunction filterSelectedActions(actions, selections) {\n    if (!actions || !selections) return [];\n    return actions.filter((_, index) => selections[index] === true);\n}\n\n/**\n * Checks if any actions are selected\n * @param {boolean[]} selections - Selection state array\n * @returns {boolean} True if at least one action is selected\n */\nfunction hasSelectedActions(selections) {\n    if (!selections || selections.length === 0) return false;\n    return selections.some(s => s === true);\n}\n\n/**\n * Renders a single preview item HTML\n */\nfunction renderPreviewItemHTML(action, index, isExpanded, isSelected, hasWarning) {\n    const icon = getActionIcon(action.type);\n    const summary = getActionSummary(action);\n    const details = getActionDetails(action);\n    const expandedClass = isExpanded ? 'expanded' : '';\n    const warningClass = hasWarning ? 'warning' : '';\n    \n    return `\n        <div class=\"preview-item ${expandedClass} ${warningClass}\" data-index=\"${index}\">\n            <input type=\"checkbox\" class=\"preview-checkbox\" ${isSelected ? 'checked' : ''} data-index=\"${index}\">\n            <div class=\"preview-icon ${action.type}\">${icon}</div>\n            <div class=\"preview-content\">\n                <div class=\"preview-summary\">\n                    ${summary}\n                    <span class=\"preview-target\">${action.target}</span>\n                    ${hasWarning ? '<svg class=\"preview-warning\" viewBox=\"0 0 24 24\" fill=\"currentColor\"><path d=\"M12 2L1 21h22L12 2zm0 3.5L19.5 19h-15L12 5.5zM11 10v4h2v-4h-2zm0 6v2h2v-2h-2z\"/></svg>' : ''}\n                </div>\n                <div class=\"preview-details\">${details}</div>\n            </div>\n            <div class=\"preview-expand\">\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M6 9l6 6 6-6\"/></svg>\n            </div>\n        </div>\n    `;\n}\n\n/**\n * Shows the preview panel with pending actions\n */\nfunction showPreviewPanel() {\n    const panel = document.getElementById(\"previewPanel\");\n    const list = document.getElementById(\"previewList\");\n    \n    if (!state.pendingActions.length) {\n        panel.style.display = \"none\";\n        return;\n    }\n    \n    // Initialize selections if needed (all selected by default)\n    if (state.preview.selections.length !== state.pendingActions.length) {\n        state.preview.selections = state.pendingActions.map(() => true);\n    }\n    \n    // Render preview items\n    const html = state.pendingActions.map((action, index) => {\n        const isExpanded = index === state.preview.expandedIndex;\n        const isSelected = state.preview.selections[index];\n        return renderPreviewItemHTML(action, index, isExpanded, isSelected, false);\n    }).join('');\n    \n    list.innerHTML = html;\n    panel.style.display = \"block\";\n    \n    // Bind events\n    bindPreviewEvents();\n    updateApplyButtonState();\n}\n\n/**\n * Hides the preview panel\n */\nfunction hidePreviewPanel() {\n    const panel = document.getElementById(\"previewPanel\");\n    panel.style.display = \"none\";\n    state.preview.selections = [];\n    state.preview.expandedIndex = -1;\n}\n\n/**\n * Binds event handlers to preview panel elements\n */\nfunction bindPreviewEvents() {\n    // Checkbox changes\n    document.querySelectorAll(\".preview-checkbox\").forEach(cb => {\n        cb.addEventListener(\"change\", (e) => {\n            const index = parseInt(e.target.dataset.index);\n            state.preview.selections[index] = e.target.checked;\n            updateApplyButtonState();\n        });\n        // Stop propagation to prevent expand/collapse when clicking checkbox\n        cb.addEventListener(\"click\", (e) => e.stopPropagation());\n    });\n    \n    // Expand/collapse on item click\n    document.querySelectorAll(\".preview-item\").forEach(item => {\n        item.addEventListener(\"click\", (e) => {\n            if (e.target.classList.contains(\"preview-checkbox\")) return;\n            const index = parseInt(item.dataset.index);\n            toggleExpand(index);\n        });\n        \n        // Hover highlighting\n        item.addEventListener(\"mouseenter\", () => {\n            const index = parseInt(item.dataset.index);\n            highlightRange(state.pendingActions[index]?.target);\n        });\n        \n        item.addEventListener(\"mouseleave\", () => {\n            clearHighlight();\n        });\n    });\n    \n    // Select all button\n    document.getElementById(\"selectAllBtn\")?.addEventListener(\"click\", toggleSelectAll);\n}\n\n/**\n * Toggles expand/collapse for a preview item\n */\nfunction toggleExpand(index) {\n    state.preview.expandedIndex = state.preview.expandedIndex === index ? -1 : index;\n    showPreviewPanel(); // Re-render\n}\n\n/**\n * Toggles select all / deselect all\n */\nfunction toggleSelectAll() {\n    const allSelected = state.preview.selections.every(s => s);\n    state.preview.selections = state.preview.selections.map(() => !allSelected);\n    showPreviewPanel(); // Re-render\n}\n\n/**\n * Updates the Apply button state based on selections\n */\nfunction updateApplyButtonState() {\n    const applyBtn = document.getElementById(\"applyBtn\");\n    const hasSelected = hasSelectedActions(state.preview.selections);\n    applyBtn.disabled = !hasSelected;\n}\n\n/**\n * Highlights a range in Excel\n */\nasync function highlightRange(rangeAddress) {\n    if (!rangeAddress) return;\n    \n    try {\n        await Excel.run(async (ctx) => {\n            const sheet = ctx.workbook.worksheets.getActiveWorksheet();\n            const range = sheet.getRange(rangeAddress);\n            range.select();\n            await ctx.sync();\n        });\n    } catch (e) {\n        // Silently fail - range might be invalid\n        console.warn(\"Could not highlight range:\", rangeAddress, e);\n    }\n}\n\n/**\n * Clears any active highlighting (no-op for now, selection persists)\n */\nasync function clearHighlight() {\n    // Excel doesn't have a \"clear selection\" API\n    // The selection will change when user interacts with Excel\n}\n\n// ============================================================================\n// Theme Toggle\n// ============================================================================\n\n/**\n * Toggles between light and dark theme\n */\nfunction toggleTheme() {\n    const html = document.documentElement;\n    const currentTheme = html.getAttribute('data-theme');\n    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';\n    html.setAttribute('data-theme', newTheme);\n    localStorage.setItem(CONFIG.THEME_KEY, newTheme);\n    toast(newTheme === 'dark' ? 'Dark mode' : 'Light mode');\n}\n\n// ============================================================================\n// Keyboard Shortcuts\n// ============================================================================\n\n/**\n * Handles keyboard shortcuts\n */\nfunction handleKeyboardShortcuts(e) {\n    // Ctrl+Enter or Cmd+Enter to send message\n    if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {\n        const input = document.getElementById(\"promptInput\");\n        if (document.activeElement === input && input.value.trim()) {\n            e.preventDefault();\n            handleSend();\n        }\n    }\n    \n    // Ctrl+Z or Cmd+Z to undo (when not in input)\n    if ((e.ctrlKey || e.metaKey) && e.key === 'z' && !e.shiftKey) {\n        const activeEl = document.activeElement;\n        if (activeEl.tagName !== 'INPUT' && activeEl.tagName !== 'TEXTAREA') {\n            if (state.history.entries.length > 0) {\n                e.preventDefault();\n                performUndo();\n            }\n        }\n    }\n    \n    // Escape to close modal or clear input\n    if (e.key === 'Escape') {\n        const modal = document.getElementById(\"modal\");\n        if (modal.classList.contains('open')) {\n            closeModal();\n        } else {\n            const input = document.getElementById(\"promptInput\");\n            if (input.value) {\n                input.value = '';\n                document.getElementById(\"sendBtn\").disabled = true;\n            }\n        }\n    }\n    \n    // Ctrl+D or Cmd+D to toggle dark mode\n    if ((e.ctrlKey || e.metaKey) && e.key === 'd') {\n        e.preventDefault();\n        toggleTheme();\n    }\n}\n\n// ============================================================================\n// Better Error Handling\n// ============================================================================\n\n/**\n * Validates a range address\n */\nfunction isValidRange(address) {\n    if (!address) return false;\n    // Basic Excel range pattern: A1, A1:B10, Sheet1!A1:B10\n    const pattern = /^([A-Za-z_][A-Za-z0-9_]*!)?(\\$?[A-Z]+\\$?\\d+)(:\\$?[A-Z]+\\$?\\d+)?$/i;\n    return pattern.test(address);\n}\n\n/**\n * Gets a user-friendly error message\n */\nfunction getErrorMessage(error, context = '') {\n    const msg = error.message || String(error);\n    \n    // API errors\n    if (msg.includes('401') || msg.includes('403')) {\n        return 'Invalid API key. Please check your settings.';\n    }\n    if (msg.includes('429')) {\n        return 'Rate limit exceeded. Please wait a moment and try again.';\n    }\n    if (msg.includes('500') || msg.includes('502') || msg.includes('503')) {\n        return 'AI service temporarily unavailable. Retrying...';\n    }\n    if (msg.includes('network') || msg.includes('fetch')) {\n        return 'Network error. Please check your connection.';\n    }\n    \n    // Excel errors\n    if (msg.includes('InvalidReference') || msg.includes('invalid range')) {\n        return `Invalid cell reference${context ? ': ' + context : ''}. Please check the range.`;\n    }\n    if (msg.includes('RichApi')) {\n        return 'Excel error. Please try again.';\n    }\n    \n    // Generic\n    return msg.length > 100 ? msg.substring(0, 100) + '...' : msg;\n}\n\n/**\n * Retries a function with exponential backoff\n */\nasync function withRetry(fn, maxRetries = CONFIG.MAX_RETRIES) {\n    let lastError;\n    for (let i = 0; i < maxRetries; i++) {\n        try {\n            return await fn();\n        } catch (e) {\n            lastError = e;\n            const msg = e.message || '';\n            // Only retry on transient errors\n            if (msg.includes('429') || msg.includes('500') || msg.includes('502') || msg.includes('503')) {\n                const delay = CONFIG.RETRY_DELAY * Math.pow(2, i);\n                await new Promise(r => setTimeout(r, delay));\n                continue;\n            }\n            throw e;\n        }\n    }\n    throw lastError;\n}\n\n// ============================================================================\n// History and Undo Functions\n// ============================================================================\n\n/**\n * Generates a unique ID for history entries\n */\nfunction generateHistoryId() {\n    return Date.now().toString(36) + Math.random().toString(36).substr(2, 5);\n}\n\n/**\n * Captures the current state of a range for undo\n * @param {Excel.RequestContext} ctx - Excel context\n * @param {Excel.Worksheet} sheet - Active worksheet\n * @param {string} rangeAddress - The range to capture\n * @returns {Promise<Object>} The captured undo data\n */\nasync function captureUndoData(ctx, sheet, rangeAddress) {\n    try {\n        const range = sheet.getRange(rangeAddress);\n        range.load([\"values\", \"formulas\", \"address\"]);\n        await ctx.sync();\n        \n        return {\n            values: range.values,\n            formulas: range.formulas,\n            address: range.address\n        };\n    } catch (e) {\n        console.warn(\"Could not capture undo data:\", e);\n        return null;\n    }\n}\n\n/**\n * Adds an action to history\n */\nfunction addActionToHistory(action, undoData) {\n    const entry = {\n        id: generateHistoryId(),\n        type: action.type,\n        target: action.target,\n        timestamp: Date.now(),\n        undoData: undoData\n    };\n    \n    // Prepend to history\n    state.history.entries = [entry, ...state.history.entries];\n    \n    // Enforce max limit\n    if (state.history.entries.length > state.history.maxEntries) {\n        state.history.entries = state.history.entries.slice(0, state.history.maxEntries);\n    }\n    \n    updateUndoButtonState();\n    if (state.history.panelVisible) {\n        renderHistoryPanel();\n    }\n}\n\n/**\n * Performs undo of the most recent action\n */\nasync function performUndo() {\n    if (!state.history.entries.length) {\n        toast(\"Nothing to undo\");\n        return;\n    }\n    \n    const entry = state.history.entries[0];\n    \n    try {\n        await Excel.run(async (ctx) => {\n            const sheet = ctx.workbook.worksheets.getActiveWorksheet();\n            const range = sheet.getRange(entry.undoData.address);\n            \n            // Restore formulas (which also restores values for non-formula cells)\n            range.formulas = entry.undoData.formulas;\n            await ctx.sync();\n        });\n        \n        // Remove from history\n        state.history.entries = state.history.entries.slice(1);\n        \n        updateUndoButtonState();\n        if (state.history.panelVisible) {\n            renderHistoryPanel();\n        }\n        \n        toast(\"Undone\");\n        await readExcelData();\n    } catch (e) {\n        console.error(\"Undo failed:\", e);\n        toast(\"Undo failed\");\n        // Keep entry in history on failure\n    }\n}\n\n/**\n * Updates the Undo button state\n */\nfunction updateUndoButtonState() {\n    const undoBtn = document.getElementById(\"undoBtn\");\n    if (undoBtn) {\n        undoBtn.disabled = state.history.entries.length === 0;\n    }\n}\n\n/**\n * Formats a timestamp as relative time\n */\nfunction formatRelativeTime(timestamp) {\n    const now = Date.now();\n    const diff = now - timestamp;\n    \n    const seconds = Math.floor(diff / 1000);\n    const minutes = Math.floor(seconds / 60);\n    const hours = Math.floor(minutes / 60);\n    const days = Math.floor(hours / 24);\n    \n    if (seconds < 60) return 'just now';\n    if (minutes < 60) return `${minutes} min ago`;\n    if (hours < 24) return `${hours} hr ago`;\n    if (days === 1) return 'yesterday';\n    return `${days} days ago`;\n}\n\n/**\n * Renders the history panel\n */\nfunction renderHistoryPanel() {\n    const list = document.getElementById(\"historyList\");\n    if (!list) return;\n    \n    if (!state.history.entries.length) {\n        list.innerHTML = '<div class=\"history-empty\">No actions yet</div>';\n        return;\n    }\n    \n    const typeLabels = {\n        formula: \"Formula\",\n        values: \"Values\",\n        format: \"Format\",\n        chart: \"Chart\",\n        validation: \"Dropdown\",\n        sort: \"Sort\",\n        autofill: \"Autofill\"\n    };\n    \n    const html = state.history.entries.map(entry => {\n        const icon = getActionIcon(entry.type);\n        const label = typeLabels[entry.type] || entry.type;\n        const timeStr = formatRelativeTime(entry.timestamp);\n        \n        return `\n            <div class=\"history-entry\" data-id=\"${entry.id}\">\n                <div class=\"history-icon ${entry.type}\">${icon}</div>\n                <div class=\"history-content\">\n                    <span class=\"history-label\">${label}</span>\n                    <span class=\"history-target\">${entry.target}</span>\n                </div>\n                <span class=\"history-time\">${timeStr}</span>\n            </div>\n        `;\n    }).join('');\n    \n    list.innerHTML = html;\n}\n\n/**\n * Toggles history panel visibility\n */\nfunction toggleHistoryPanel() {\n    state.history.panelVisible = !state.history.panelVisible;\n    const panel = document.getElementById(\"historyPanel\");\n    const btn = document.getElementById(\"historyBtn\");\n    \n    if (panel) {\n        panel.style.display = state.history.panelVisible ? \"block\" : \"none\";\n        if (state.history.panelVisible) {\n            renderHistoryPanel();\n        }\n    }\n    \n    if (btn) {\n        btn.classList.toggle(\"active\", state.history.panelVisible);\n    }\n}\n\n// ============================================================================\n// Apply Actions\n// ============================================================================\nasync function handleApply() {\n    // Get only selected actions\n    const selectedActions = filterSelectedActions(state.pendingActions, state.preview.selections);\n    \n    if (!selectedActions.length) {\n        toast(\"Nothing to apply\");\n        return;\n    }\n    \n    const applyBtn = document.getElementById(\"applyBtn\");\n    applyBtn.disabled = true;\n    applyBtn.textContent = \"Applying...\";\n    \n    let successCount = 0;\n    let errorMsg = \"\";\n    \n    try {\n        await Excel.run(async (ctx) => {\n            const sheet = ctx.workbook.worksheets.getActiveWorksheet();\n            \n            for (const action of selectedActions) {\n                try {\n                    // Capture undo data before applying (skip for charts - can't undo)\n                    let undoData = null;\n                    if (action.type !== 'chart') {\n                        undoData = await captureUndoData(ctx, sheet, action.target);\n                    }\n                    \n                    await executeAction(ctx, sheet, action);\n                    await ctx.sync();\n                    successCount++;\n                    \n                    // Add to history if we have undo data\n                    if (undoData) {\n                        addActionToHistory(action, undoData);\n                    }\n                } catch (e) {\n                    errorMsg = e.message;\n                    console.error(\"Action failed:\", e);\n                }\n            }\n        });\n        \n        if (successCount === selectedActions.length) {\n            addMessage(\"ai\", `${successCount} change${successCount > 1 ? 's' : ''} applied successfully.`, \"success\");\n            toast(\"Applied\");\n        } else if (successCount > 0) {\n            addMessage(\"ai\", `${successCount}/${selectedActions.length} changes applied. Error: ${errorMsg}`, \"error\");\n        } else {\n            addMessage(\"ai\", `Failed: ${errorMsg}`, \"error\");\n        }\n        \n        // Clear pending actions and hide preview\n        state.pendingActions = [];\n        hidePreviewPanel();\n        await readExcelData();\n    } catch (err) {\n        addMessage(\"ai\", \"Failed: \" + err.message, \"error\");\n        toast(\"Failed\");\n    }\n    \n    applyBtn.disabled = true;\n    applyBtn.textContent = \"Apply Changes\";\n}\n\nasync function executeAction(ctx, sheet, action) {\n    const { type, target, source, validationType, chartType, data } = action;\n    \n    if (!target) throw new Error(\"No target specified\");\n    \n    const range = sheet.getRange(target);\n    range.load([\"rowCount\", \"columnCount\"]);\n    await ctx.sync();\n    \n    switch (type) {\n        case \"formula\":\n            await applyFormula(range, data);\n            break;\n            \n        case \"values\":\n            applyValues(range, data);\n            break;\n            \n        case \"format\":\n            applyFormat(range, data);\n            break;\n            \n        case \"validation\":\n            await applyValidation(ctx, sheet, range, source);\n            break;\n            \n        case \"chart\":\n            createChart(sheet, range, action);\n            break;\n            \n        case \"sort\":\n            applySort(range, data);\n            break;\n            \n        case \"autofill\":\n            if (source) {\n                const sourceRange = sheet.getRange(source);\n                sourceRange.autoFill(range, Excel.AutoFillType.fillDefault);\n            }\n            break;\n            \n        default:\n            if (data) range.values = [[data]];\n    }\n}\n\nasync function applyFormula(range, formula) {\n    const rows = range.rowCount;\n    const cols = range.columnCount;\n    \n    if (rows === 1 && cols === 1) {\n        range.formulas = [[formula]];\n        return;\n    }\n    \n    const formulas = [];\n    for (let r = 0; r < rows; r++) {\n        const rowFormulas = [];\n        for (let c = 0; c < cols; c++) {\n            let f = formula;\n            if (r > 0) {\n                f = formula.replace(/(\\$?)([A-Z]+)(\\$?)(\\d+)/g, (m, d1, col, d2, row) => {\n                    if (d2 === \"$\") return m;\n                    return `${d1}${col}${d2}${parseInt(row) + r}`;\n                });\n            }\n            rowFormulas.push(f);\n        }\n        formulas.push(rowFormulas);\n    }\n    \n    range.formulas = formulas;\n}\n\nfunction applyValues(range, data) {\n    let values;\n    try {\n        values = JSON.parse(data);\n        if (!Array.isArray(values)) values = [[values]];\n        if (!Array.isArray(values[0])) values = [values];\n    } catch {\n        values = [[data]];\n    }\n    range.values = values;\n}\n\nfunction applyFormat(range, data) {\n    let fmt;\n    try { fmt = JSON.parse(data); } catch { fmt = {}; }\n    \n    if (fmt.bold) range.format.font.bold = true;\n    if (fmt.italic) range.format.font.italic = true;\n    if (fmt.fill) range.format.fill.color = fmt.fill;\n    if (fmt.fontColor) range.format.font.color = fmt.fontColor;\n    if (fmt.fontSize) range.format.font.size = fmt.fontSize;\n    if (fmt.numberFormat) range.numberFormat = [[fmt.numberFormat]];\n    if (fmt.border) {\n        range.format.borders.getItem(\"EdgeTop\").style = \"Continuous\";\n        range.format.borders.getItem(\"EdgeBottom\").style = \"Continuous\";\n        range.format.borders.getItem(\"EdgeLeft\").style = \"Continuous\";\n        range.format.borders.getItem(\"EdgeRight\").style = \"Continuous\";\n    }\n}\n\nasync function applyValidation(ctx, sheet, range, source) {\n    if (source) {\n        // Clear any existing validation first\n        range.dataValidation.clear();\n        await ctx.sync();\n        \n        // Get the source range to extract unique values\n        const sourceRange = sheet.getRange(source);\n        sourceRange.load(\"values\");\n        await ctx.sync();\n        \n        // Extract unique non-empty values\n        const uniqueValues = [];\n        const seen = new Set();\n        for (const row of sourceRange.values) {\n            const val = row[0];\n            if (val !== null && val !== undefined && val !== \"\" && !seen.has(val)) {\n                seen.add(val);\n                uniqueValues.push(String(val));\n            }\n        }\n        \n        // Create comma-separated list for validation\n        const listSource = uniqueValues.join(\",\");\n        \n        // Set the validation rule with explicit list\n        range.dataValidation.rule = {\n            list: {\n                inCellDropDown: true,\n                source: listSource\n            }\n        };\n    }\n}\n\nfunction createChart(sheet, dataRange, action) {\n    const { chartType, data } = action;\n    const ct = (chartType || \"column\").toLowerCase();\n    \n    // Parse additional options from data if provided\n    let title = \"Chart\";\n    let position = \"H2\";\n    \n    // Try to extract title and position from action attributes or data\n    if (action.title) title = action.title;\n    if (action.position) position = action.position;\n    \n    // Determine chart type\n    let type = Excel.ChartType.columnClustered;\n    \n    if (ct.includes(\"line\")) {\n        type = Excel.ChartType.line;\n    } else if (ct.includes(\"pie\")) {\n        type = Excel.ChartType.pie;\n    } else if (ct.includes(\"doughnut\") || ct.includes(\"donut\")) {\n        type = Excel.ChartType.doughnut;\n    } else if (ct.includes(\"bar\")) {\n        type = Excel.ChartType.barClustered;\n    } else if (ct.includes(\"area\")) {\n        type = Excel.ChartType.area;\n    } else if (ct.includes(\"scatter\") || ct.includes(\"xy\")) {\n        type = Excel.ChartType.xyscatter;\n    } else if (ct.includes(\"radar\") || ct.includes(\"spider\")) {\n        type = Excel.ChartType.radar;\n    } else if (ct.includes(\"stacked\")) {\n        if (ct.includes(\"bar\")) {\n            type = Excel.ChartType.barStacked;\n        } else {\n            type = Excel.ChartType.columnStacked;\n        }\n    }\n    \n    // Create the chart\n    const chart = sheet.charts.add(type, dataRange, Excel.ChartSeriesBy.auto);\n    \n    // Calculate end position (chart size roughly 8 cols x 15 rows)\n    const startCol = position.match(/[A-Z]+/)?.[0] || \"H\";\n    const startRow = parseInt(position.match(/\\d+/)?.[0] || \"2\");\n    const endCol = String.fromCharCode(startCol.charCodeAt(0) + 8);\n    const endRow = startRow + 15;\n    const endPosition = `${endCol}${endRow}`;\n    \n    chart.setPosition(position, endPosition);\n    \n    // Set title\n    chart.title.text = title;\n    chart.title.visible = true;\n    \n    // Style the chart\n    chart.legend.visible = true;\n    chart.legend.position = Excel.ChartLegendPosition.bottom;\n    \n    // For pie charts, show data labels\n    if (ct.includes(\"pie\") || ct.includes(\"doughnut\")) {\n        chart.legend.position = Excel.ChartLegendPosition.right;\n    }\n}\n\nfunction applySort(range, data) {\n    const opts = typeof data === \"string\" ? JSON.parse(data) : (data || {});\n    range.sort.apply([{ key: opts.column || 0, ascending: opts.ascending !== false }]);\n}\n\nexport { handleSend, handleApply, readExcelData, clearChat };\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html lang=\\\"en\\\"> <head> <meta charset=\\\"UTF-8\\\"> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Excel Copilot</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"> </head> <body> <div class=\\\"app\\\"> <header class=\\\"header\\\"> <div class=\\\"brand\\\"> <svg class=\\\"logo\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"currentColor\\\"> <path d=\\\"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5\\\"/> </svg> <span>Copilot</span> </div> <div class=\\\"header-actions\\\"> <button class=\\\"icon-btn\\\" id=\\\"themeBtn\\\" title=\\\"Toggle Dark Mode\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"> <path d=\\\"M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z\\\"/> </svg> </button> <button class=\\\"icon-btn\\\" id=\\\"historyBtn\\\" title=\\\"History\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"> <circle cx=\\\"12\\\" cy=\\\"12\\\" r=\\\"10\\\"/><path d=\\\"M12 6v6l4 2\\\"/> </svg> </button> <button class=\\\"icon-btn\\\" id=\\\"clearBtn\\\" title=\\\"Clear\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"> <path d=\\\"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2\\\"/> </svg> </button> <button class=\\\"icon-btn\\\" id=\\\"settingsBtn\\\" title=\\\"Settings\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"> <circle cx=\\\"12\\\" cy=\\\"12\\\" r=\\\"3\\\"/><path d=\\\"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z\\\"/> </svg> </button> </div> </header> <main class=\\\"main\\\"> <div id=\\\"welcome\\\" class=\\\"welcome\\\"> <div class=\\\"welcome-icon\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"currentColor\\\"> <path d=\\\"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5\\\"/> </svg> </div> <h1>Excel Copilot</h1> <p>Your AI assistant for Excel. Select cells and ask me anything.</p> <div class=\\\"suggestions\\\"> <button data-prompt=\\\"Analyze this data and give me key insights\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"><path d=\\\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\\\"/></svg> Analyze data </button> <button data-prompt=\\\"Create a SUM formula for the selected cells\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"><path d=\\\"M4 7h16M4 12h16M4 17h10\\\"/></svg> Create formula </button> <button data-prompt=\\\"Create a chart to visualize this data\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"><path d=\\\"M18 20V10M12 20V4M6 20v-6\\\"/></svg> Create chart </button> <button data-prompt=\\\"Format this as a professional table with headers\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"><rect x=\\\"3\\\" y=\\\"3\\\" width=\\\"18\\\" height=\\\"18\\\" rx=\\\"2\\\"/><path d=\\\"M3 9h18M9 21V9\\\"/></svg> Format table </button> </div> </div> <div id=\\\"chat\\\" class=\\\"chat\\\"></div> <div id=\\\"previewPanel\\\" class=\\\"preview-panel\\\" style=\\\"display:none\\\"> <div class=\\\"preview-header\\\"> <span class=\\\"preview-title\\\">Pending Changes</span> <button class=\\\"icon-btn-sm\\\" id=\\\"selectAllBtn\\\" title=\\\"Select All\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"><path d=\\\"M9 11l3 3L22 4\\\"/><path d=\\\"M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11\\\"/></svg> </button> </div> <div id=\\\"previewList\\\" class=\\\"preview-list\\\"></div> </div> <div id=\\\"historyPanel\\\" class=\\\"history-panel\\\" style=\\\"display:none\\\"> <div class=\\\"history-header\\\"> <span class=\\\"history-title\\\">Action History</span> </div> <div id=\\\"historyList\\\" class=\\\"history-list\\\"></div> </div> </main> <div class=\\\"context-bar\\\"> <label class=\\\"toggle\\\"> <input type=\\\"checkbox\\\" id=\\\"useContext\\\" checked=\\\"checked\\\"> <span class=\\\"toggle-slider\\\"></span> </label> <span class=\\\"context-label\\\">Context:</span> <span class=\\\"context-info\\\" id=\\\"contextInfo\\\">No selection</span> <button class=\\\"icon-btn-sm\\\" id=\\\"refreshBtn\\\" title=\\\"Refresh\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"><path d=\\\"M23 4v6h-6M1 20v-6h6\\\"/><path d=\\\"M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15\\\"/></svg> </button> </div> <div class=\\\"input-area\\\"> <div id=\\\"smartSuggestions\\\" class=\\\"smart-suggestions\\\" style=\\\"display:none\\\"></div> <div class=\\\"input-box\\\"> <textarea id=\\\"promptInput\\\" placeholder=\\\"Ask me anything... (Ctrl+Enter to send)\\\" rows=\\\"1\\\"></textarea> <button class=\\\"send-btn\\\" id=\\\"sendBtn\\\" disabled=\\\"disabled\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"currentColor\\\"><path d=\\\"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z\\\"/></svg> </button> </div> <div class=\\\"action-buttons\\\"> <button class=\\\"undo-btn\\\" id=\\\"undoBtn\\\" disabled=\\\"disabled\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"><path d=\\\"M3 10h10a5 5 0 015 5v2M3 10l6 6M3 10l6-6\\\"/></svg> Undo </button> <button class=\\\"apply-btn\\\" id=\\\"applyBtn\\\" disabled=\\\"disabled\\\">Apply Changes</button> </div> </div> </div> <div class=\\\"modal\\\" id=\\\"modal\\\"> <div class=\\\"modal-box\\\"> <div class=\\\"modal-header\\\"> <h2>Settings</h2> <button class=\\\"icon-btn\\\" id=\\\"closeModal\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"><path d=\\\"M18 6L6 18M6 6l12 12\\\"/></svg> </button> </div> <div class=\\\"modal-body\\\"> <label>Gemini API Key</label> <div class=\\\"input-row\\\"> <input type=\\\"password\\\" id=\\\"apiKeyInput\\\" placeholder=\\\"Enter your API key\\\"> <button class=\\\"icon-btn\\\" id=\\\"togglePwd\\\"> <svg viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\"><path d=\\\"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z\\\"/><circle cx=\\\"12\\\" cy=\\\"12\\\" r=\\\"3\\\"/></svg> </button> </div> <p class=\\\"hint\\\">Get your free key at <a href=\\\"https://aistudio.google.com/apikey\\\" target=\\\"_blank\\\">Google AI Studio</a></p> </div> <div class=\\\"modal-footer\\\"> <button class=\\\"btn-cancel\\\" id=\\\"cancelBtn\\\">Cancel</button> <button class=\\\"btn-save\\\" id=\\\"saveBtn\\\">Save</button> </div> </div> </div> <div class=\\\"toast\\\" id=\\\"toast\\\"></div> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","d","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","_invoke","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","CONFIG","state","apiKey","pendingActions","currentData","conversationHistory","isFirstMessage","preview","selections","expandedIndex","highlightedIndex","history","entries","panelVisible","maxEntries","closeModal","getElementById","classList","remove","_setupSelectionListener","_callee3","_context3","Excel","run","_ref2","_callee2","ctx","_context2","workbook","worksheets","getActiveWorksheet","onSelectionChanged","add","readExcelData","sync","_x14","colIndexToLetter","index","letter","String","fromCharCode","Math","floor","_readExcelData","_callee5","infoEl","_context5","_ref3","_callee4","sheet","usedRange","sheetName","values","startCol","startRow","rowCount","colCount","headers","columnMap","colLetter","headerName","_context4","getUsedRange","load","name","columnIndex","rowIndex","columnCount","concat","push","header","address","dataStartRow","textContent","showSmartSuggestions","_x15","hideSmartSuggestions","showChat","style","display","addMessage","role","content","type","chat","msg","createElement","className","innerHTML","appendChild","scrollTop","scrollHeight","showTyping","el","id","hideTyping","_document$getElementB11","showLoadingSkeleton","hideLoadingSkeleton","_document$getElementB12","container","suggestions","data","icon","text","prompt","some","row","cell","map","h","toLowerCase","includes","slice","generateSmartSuggestions","s","join","querySelectorAll","forEach","btn","addEventListener","dataset","disabled","handleSend","clearChat","hidePreviewPanel","toast","setTimeout","_handleSend","_callee6","input","response","_parseResponse","message","actions","_t3","_context6","trim","click","height","callAI","parseResponse","showPreviewPanel","parts","getErrorMessage","_x","_callAI","_callee8","userPrompt","dataContext","systemPrompt","fullUserMessage","contents","_context8","buildDataContext","getSystemPrompt","_toConsumableArray","withRetry","_callee7","_data$candidates","res","_context7","fetch","method","body","JSON","stringify","systemInstruction","generationConfig","temperature","maxOutputTokens","ok","status","json","candidates","_state$currentData","context","_step","_iterator","_createForOfIteratorHelper","col","samples","min","_values$_r","val","substring","err","_step2","_iterator2","maxRows","rowNum","_values$r","_step3","_iterator3","uniqueVals","Set","_values$_r2","size","Array","from","match","actionRegex","exec","_attrs$match","_attrs$match2","_attrs$match3","_attrs$match4","_attrs$match5","_attrs$match6","attrs","target","source","chartType","title","position","getActionIcon","icons","formula","format","chart","validation","sort","autofill","filterSelectedActions","filter","_","panel","list","_document$getElementB13","html","action","isExpanded","isSelected","hasWarning","summary","getActionSummary","details","vals","parse","_unused","fmt","bold","italic","fill","fontColor","fontSize","numberFormat","_unused2","getActionDetails","warningClass","renderPreviewItemHTML","cb","parseInt","checked","updateApplyButtonState","stopPropagation","item","contains","_state$pendingActions","_x2","_highlightRange","highlightRange","_clearHighlight","clearHighlight","toggleSelectAll","allSelected","every","applyBtn","hasSelected","_callee0","rangeAddress","_t4","_context0","_ref5","_callee9","_context9","getRange","select","_x16","console","warn","_callee1","_context1","toggleTheme","documentElement","newTheme","getAttribute","setAttribute","localStorage","setItem","handleKeyboardShortcuts","ctrlKey","metaKey","activeElement","preventDefault","shiftKey","activeEl","performUndo","error","_x3","_withRetry","_callee10","fn","maxRetries","lastError","_loop","_ret","_args11","_context11","delay","_t5","_t6","_context10","pow","_regeneratorValues","captureUndoData","_x4","_x5","_x6","_captureUndoData","_callee11","range","_t7","_context12","formulas","addActionToHistory","undoData","entry","Date","now","toString","random","substr","timestamp","updateUndoButtonState","renderHistoryPanel","_performUndo","_callee13","_t8","_context14","_ref6","_callee12","_context13","_x17","undoBtn","typeLabels","diff","seconds","minutes","hours","days","label","timeStr","toggleHistoryPanel","toggle","handleApply","_handleApply","_callee15","selectedActions","successCount","errorMsg","_context16","_ref7","_callee14","_iterator4","_step4","_t9","_t0","_context15","executeAction","_x18","_x7","_x8","_x9","_executeAction","_callee16","_t10","_context17","validationType","applyFormula","applyValues","applyFormat","applyValidation","createChart","applySort","autoFill","AutoFillType","fillDefault","_x0","_x1","_applyFormula","_callee17","rows","cols","_loop2","_context19","rowFormulas","_context18","d1","d2","isArray","_unused3","_unused4","font","color","border","borders","getItem","_x10","_x11","_x12","_x13","_applyValidation","_callee18","sourceRange","uniqueValues","seen","_iterator5","_step5","listSource","_context20","dataValidation","clear","has","rule","inCellDropDown","dataRange","_position$match","_position$match2","ct","ChartType","columnClustered","line","pie","doughnut","barClustered","area","xyscatter","radar","barStacked","columnStacked","charts","ChartSeriesBy","auto","endCol","charCodeAt","endRow","endPosition","setPosition","visible","legend","ChartLegendPosition","bottom","right","opts","column","ascending","Office","onReady","info","host","HostType","_document$getElementB","_document$getElementB2","_document$getElementB3","_document$getElementB4","_document$getElementB5","_document$getElementB6","_document$getElementB7","_document$getElementB8","_document$getElementB9","_document$getElementB0","_document$getElementB1","_document$getElementB10","sendBtn","savedTheme","_callee","_context","inp","setupSelectionListener","initApp","URL"],"ignoreList":[],"sourceRoot":""}