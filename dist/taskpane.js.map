{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/define property getters","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Excel AI Copilot - With Chat Memory\n */\n\n/* global document, Excel, Office, fetch, localStorage */\n\n// ============================================================================\n// Configuration\n// ============================================================================\nconst CONFIG = {\n    GEMINI_MODEL: \"gemini-2.0-flash\",\n    API_ENDPOINT: \"https://generativelanguage.googleapis.com/v1beta/models/\",\n    STORAGE_KEY: \"excel_copilot_api_key\",\n    MAX_CONTEXT_ROWS: 100,\n    MAX_CONTEXT_COLS: 26,\n    MAX_HISTORY: 20 // Keep last 20 messages for context\n};\n\n// ============================================================================\n// State\n// ============================================================================\nlet state = {\n    apiKey: \"\",\n    lastResponse: null,\n    pendingAction: null,\n    selectionData: null,\n    selectionAddress: \"\",\n    conversationHistory: [], // For Gemini API memory\n    isFirstMessage: true\n};\n\n// ============================================================================\n// DOM Elements\n// ============================================================================\nconst elements = {};\n\n// ============================================================================\n// Initialization\n// ============================================================================\nOffice.onReady((info) => {\n    if (info.host === Office.HostType.Excel) {\n        initializeApp();\n    }\n});\n\nfunction initializeApp() {\n    cacheElements();\n    state.apiKey = localStorage.getItem(CONFIG.STORAGE_KEY) || \"\";\n    bindEvents();\n    refreshSelection();\n    setupSelectionHandler();\n    setupTextareaAutoResize();\n}\n\nfunction cacheElements() {\n    elements.welcomeScreen = document.getElementById(\"welcomeScreen\");\n    elements.chatContainer = document.getElementById(\"chatContainer\");\n    elements.promptInput = document.getElementById(\"promptInput\");\n    elements.sendBtn = document.getElementById(\"sendBtn\");\n    elements.applyBtn = document.getElementById(\"applyBtn\");\n    elements.refreshBtn = document.getElementById(\"refreshBtn\");\n    elements.useSelection = document.getElementById(\"useSelection\");\n    elements.selectionText = document.getElementById(\"selectionText\");\n    elements.settingsBtn = document.getElementById(\"settingsBtn\");\n    elements.settingsModal = document.getElementById(\"settingsModal\");\n    elements.closeSettings = document.getElementById(\"closeSettings\");\n    elements.cancelSettings = document.getElementById(\"cancelSettings\");\n    elements.saveSettings = document.getElementById(\"saveSettings\");\n    elements.apiKeyInput = document.getElementById(\"apiKeyInput\");\n    elements.togglePassword = document.getElementById(\"togglePassword\");\n    elements.toast = document.getElementById(\"toast\");\n    elements.toastMessage = document.getElementById(\"toastMessage\");\n    elements.clearChat = document.getElementById(\"clearChat\");\n}\n\nfunction bindEvents() {\n    elements.sendBtn?.addEventListener(\"click\", sendMessage);\n    elements.promptInput?.addEventListener(\"keydown\", (e) => {\n        if (e.key === \"Enter\" && !e.shiftKey) {\n            e.preventDefault();\n            sendMessage();\n        }\n    });\n    \n    elements.promptInput?.addEventListener(\"input\", () => {\n        elements.sendBtn.disabled = !elements.promptInput.value.trim();\n    });\n    \n    elements.applyBtn?.addEventListener(\"click\", applyChanges);\n    \n    elements.refreshBtn?.addEventListener(\"click\", () => {\n        elements.refreshBtn.classList.add(\"spinning\");\n        refreshSelection().then(() => {\n            setTimeout(() => elements.refreshBtn.classList.remove(\"spinning\"), 500);\n        });\n    });\n    \n    elements.useSelection?.addEventListener(\"change\", refreshSelection);\n    \n    elements.settingsBtn?.addEventListener(\"click\", openSettings);\n    elements.closeSettings?.addEventListener(\"click\", closeSettings);\n    elements.cancelSettings?.addEventListener(\"click\", closeSettings);\n    elements.saveSettings?.addEventListener(\"click\", saveSettings);\n    \n    elements.clearChat?.addEventListener(\"click\", clearConversation);\n    \n    elements.togglePassword?.addEventListener(\"click\", () => {\n        const input = elements.apiKeyInput;\n        const icon = elements.togglePassword.querySelector(\"i\");\n        if (input.type === \"password\") {\n            input.type = \"text\";\n            icon.classList.replace(\"fa-eye\", \"fa-eye-slash\");\n        } else {\n            input.type = \"password\";\n            icon.classList.replace(\"fa-eye-slash\", \"fa-eye\");\n        }\n    });\n    \n    elements.settingsModal?.addEventListener(\"click\", (e) => {\n        if (e.target === elements.settingsModal) closeSettings();\n    });\n    \n    document.querySelectorAll(\".suggestion-chip\").forEach(chip => {\n        chip.addEventListener(\"click\", () => {\n            elements.promptInput.value = chip.dataset.prompt;\n            elements.sendBtn.disabled = false;\n            sendMessage();\n        });\n    });\n}\n\nfunction setupTextareaAutoResize() {\n    const textarea = elements.promptInput;\n    if (!textarea) return;\n    textarea.addEventListener(\"input\", () => {\n        textarea.style.height = \"auto\";\n        textarea.style.height = Math.min(textarea.scrollHeight, 120) + \"px\";\n    });\n}\n\nasync function setupSelectionHandler() {\n    try {\n        await Excel.run(async (context) => {\n            const sheet = context.workbook.worksheets.getActiveWorksheet();\n            sheet.onSelectionChanged.add(onSelectionChanged);\n            await context.sync();\n        });\n    } catch (err) {\n        console.log(\"Selection handler setup skipped:\", err.message);\n    }\n}\n\nasync function onSelectionChanged() {\n    if (elements.useSelection?.checked) {\n        await refreshSelection();\n    }\n}\n\n// ============================================================================\n// Selection Management\n// ============================================================================\nasync function refreshSelection() {\n    const useSelection = elements.useSelection?.checked;\n    \n    if (!useSelection) {\n        elements.selectionText.textContent = \"Selection disabled\";\n        state.selectionData = null;\n        state.selectionAddress = \"\";\n        return;\n    }\n    \n    try {\n        await Excel.run(async (context) => {\n            const range = context.workbook.getSelectedRange();\n            range.load([\"address\", \"values\", \"rowCount\", \"columnCount\"]);\n            await context.sync();\n            \n            state.selectionAddress = range.address;\n            state.selectionData = range.values;\n            \n            elements.selectionText.textContent = `${range.address} (${range.rowCount}x${range.columnCount})`;\n        });\n    } catch (err) {\n        elements.selectionText.textContent = \"No selection\";\n    }\n}\n\n// ============================================================================\n// Chat & Messaging\n// ============================================================================\nfunction showChat() {\n    if (state.isFirstMessage) {\n        elements.welcomeScreen.style.display = \"none\";\n        elements.chatContainer.classList.add(\"active\");\n        state.isFirstMessage = false;\n    }\n}\n\nfunction addMessage(role, content, type = \"normal\") {\n    showChat();\n    \n    const msgEl = document.createElement(\"div\");\n    msgEl.className = `message ${role} ${type}`;\n    \n    const avatarIcon = role === \"ai\" ? \"fa-microchip\" : \"fa-user\";\n    const statusIcon = type === \"action\" ? '<i class=\"fas fa-check-circle status-icon success\"></i>' : \n                       type === \"error\" ? '<i class=\"fas fa-times-circle status-icon error\"></i>' : '';\n    \n    msgEl.innerHTML = `\n        <div class=\"message-avatar\">\n            <i class=\"fas ${avatarIcon}\"></i>\n        </div>\n        <div class=\"message-content\">\n            ${statusIcon}\n            <div class=\"message-text\">${formatContent(content)}</div>\n        </div>\n    `;\n    \n    elements.chatContainer.appendChild(msgEl);\n    elements.chatContainer.scrollTop = elements.chatContainer.scrollHeight;\n}\n\nfunction formatContent(content) {\n    let formatted = content\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\");\n    \n    // Remove emojis and replace with nothing\n    formatted = formatted.replace(/[\\u{1F300}-\\u{1F9FF}]|[\\u{2600}-\\u{26FF}]|[\\u{2700}-\\u{27BF}]|[\\u{1F600}-\\u{1F64F}]|[\\u{1F680}-\\u{1F6FF}]/gu, '');\n    \n    // Code blocks\n    formatted = formatted.replace(/```(\\w*)\\n?([\\s\\S]*?)```/g, (_, lang, code) => {\n        return `<pre><code>${code.trim()}</code></pre>`;\n    });\n    \n    // Inline code\n    formatted = formatted.replace(/`([^`]+)`/g, '<code>$1</code>');\n    \n    // Bold\n    formatted = formatted.replace(/\\*\\*([^*]+)\\*\\*/g, '<strong>$1</strong>');\n    \n    // Line breaks\n    formatted = formatted.replace(/\\n/g, '<br>');\n    \n    return formatted;\n}\n\nfunction showTyping() {\n    showChat();\n    \n    const typingEl = document.createElement(\"div\");\n    typingEl.className = \"message ai\";\n    typingEl.id = \"typingIndicator\";\n    typingEl.innerHTML = `\n        <div class=\"message-avatar\">\n            <i class=\"fas fa-microchip\"></i>\n        </div>\n        <div class=\"message-content\">\n            <div class=\"typing-indicator\">\n                <span></span><span></span><span></span>\n            </div>\n        </div>\n    `;\n    \n    elements.chatContainer.appendChild(typingEl);\n    elements.chatContainer.scrollTop = elements.chatContainer.scrollHeight;\n}\n\nfunction hideTyping() {\n    document.getElementById(\"typingIndicator\")?.remove();\n}\n\nfunction clearConversation() {\n    state.conversationHistory = [];\n    elements.chatContainer.innerHTML = \"\";\n    elements.welcomeScreen.style.display = \"flex\";\n    elements.chatContainer.classList.remove(\"active\");\n    state.isFirstMessage = true;\n    state.pendingAction = null;\n    elements.applyBtn.disabled = true;\n    showToast(\"Conversation cleared\");\n}\n\n// ============================================================================\n// AI Communication with Memory\n// ============================================================================\nasync function sendMessage() {\n    const prompt = elements.promptInput.value.trim();\n    if (!prompt) return;\n    \n    if (!state.apiKey) {\n        openSettings();\n        showToast(\"Please set your API key first\", \"warning\");\n        return;\n    }\n    \n    // Add user message to UI\n    addMessage(\"user\", prompt);\n    \n    // Add to conversation history for memory\n    state.conversationHistory.push({\n        role: \"user\",\n        parts: [{ text: prompt }]\n    });\n    \n    // Trim history if too long\n    if (state.conversationHistory.length > CONFIG.MAX_HISTORY * 2) {\n        state.conversationHistory = state.conversationHistory.slice(-CONFIG.MAX_HISTORY * 2);\n    }\n    \n    elements.promptInput.value = \"\";\n    elements.promptInput.style.height = \"auto\";\n    elements.sendBtn.disabled = true;\n    \n    showTyping();\n    \n    try {\n        const response = await callGeminiAPIWithMemory();\n        hideTyping();\n        \n        // Add AI response to history\n        state.conversationHistory.push({\n            role: \"model\",\n            parts: [{ text: response }]\n        });\n        \n        const parsed = parseAIResponse(response);\n        state.lastResponse = parsed;\n        \n        addMessage(\"ai\", parsed.message, parsed.hasAction ? \"action\" : \"normal\");\n        \n        if (parsed.hasAction) {\n            elements.applyBtn.disabled = false;\n            state.pendingAction = parsed.action;\n        }\n    } catch (err) {\n        hideTyping();\n        addMessage(\"ai\", `Error: ${err.message}`, \"error\");\n    }\n}\n\nasync function callGeminiAPIWithMemory() {\n    const systemInstruction = buildSystemPrompt();\n    const contextInfo = buildContextPrompt();\n    \n    // Build contents array with conversation history\n    const contents = [];\n    \n    // Add context as first user message if we have selection\n    if (state.selectionData && state.conversationHistory.length <= 2) {\n        contents.push({\n            role: \"user\",\n            parts: [{ text: `Current Excel context:\\n${contextInfo}` }]\n        });\n        contents.push({\n            role: \"model\", \n            parts: [{ text: \"I understand. I can see your Excel data. How can I help you with it?\" }]\n        });\n    }\n    \n    // Add conversation history\n    contents.push(...state.conversationHistory);\n    \n    // If latest message needs context update, add it\n    if (state.selectionData && state.conversationHistory.length > 2) {\n        const lastUserMsg = contents[contents.length - 1];\n        if (lastUserMsg.role === \"user\") {\n            lastUserMsg.parts[0].text = `[Current selection: ${state.selectionAddress}]\\n${lastUserMsg.parts[0].text}`;\n        }\n    }\n    \n    const url = `${CONFIG.API_ENDPOINT}${CONFIG.GEMINI_MODEL}:generateContent?key=${encodeURIComponent(state.apiKey)}`;\n    \n    const response = await fetch(url, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n            systemInstruction: { parts: [{ text: systemInstruction }] },\n            contents: contents,\n            generationConfig: { \n                temperature: 0.7, \n                maxOutputTokens: 2048 \n            }\n        })\n    });\n    \n    if (!response.ok) {\n        const errorText = await response.text();\n        throw new Error(`API Error: ${response.status}`);\n    }\n    \n    const data = await response.json();\n    return data?.candidates?.[0]?.content?.parts?.map(p => p.text || \"\").join(\"\") || \"\";\n}\n\nfunction buildSystemPrompt() {\n    return `You are Excel AI Copilot, a professional assistant for Microsoft Excel. \n\nIMPORTANT RULES:\n1. Remember the entire conversation context. If user refers to previous messages, use that context.\n2. Be concise and professional. No emojis.\n3. When user asks to \"drag\" or \"fill\" a formula, apply it to all cells in the range automatically.\n4. For running calculations, apply the formula to ALL cells in the target range, not just one cell.\n\nCAPABILITIES:\n- Analyze data, create formulas, generate charts, format cells\n- Apply formulas to multiple cells at once\n- Remember what was discussed earlier in the conversation\n\nACTION FORMAT (when modifying the sheet):\n[ACTION]\ntype: formula|values|format|chart\ntarget: cell reference (e.g., E8:E12) or \"selection\"\ndata: the formula or data to apply\n[/ACTION]\n\nEXAMPLES:\n- For running sum in E8:E12, use target: E8:E12 and apply the formula to all cells\n- When user says \"drag it\" or \"fill down\", apply to the full range mentioned earlier\n\nAlways provide the complete solution. If user asks to fill/drag, do it automatically.`;\n}\n\nfunction buildContextPrompt() {\n    if (!state.selectionData || !state.selectionAddress) {\n        return \"No data selected.\";\n    }\n    \n    const rows = Math.min(state.selectionData.length, CONFIG.MAX_CONTEXT_ROWS);\n    const cols = Math.min(state.selectionData[0]?.length || 0, CONFIG.MAX_CONTEXT_COLS);\n    \n    let dataStr = \"\";\n    for (let r = 0; r < rows; r++) {\n        const rowData = [];\n        for (let c = 0; c < cols; c++) {\n            rowData.push(state.selectionData[r][c] ?? \"\");\n        }\n        dataStr += rowData.join(\"\\t\") + \"\\n\";\n    }\n    \n    return `Selected: ${state.selectionAddress} (${state.selectionData.length} rows x ${state.selectionData[0]?.length || 0} cols)\\n\\nData:\\n${dataStr}`;\n}\n\nfunction parseAIResponse(response) {\n    const actionMatch = response.match(/\\[ACTION\\]([\\s\\S]*?)\\[\\/ACTION\\]/);\n    \n    if (actionMatch) {\n        const actionBlock = actionMatch[1];\n        const typeMatch = actionBlock.match(/type:\\s*(\\w+)/);\n        const targetMatch = actionBlock.match(/target:\\s*([^\\n]+)/);\n        const dataMatch = actionBlock.match(/data:\\s*([\\s\\S]*?)(?=\\n\\w+:|$)/);\n        \n        const message = response.replace(/\\[ACTION\\][\\s\\S]*?\\[\\/ACTION\\]/, \"\").trim();\n        \n        return {\n            message: message || \"Ready to apply changes.\",\n            hasAction: true,\n            action: {\n                type: typeMatch?.[1]?.trim() || \"value\",\n                target: targetMatch?.[1]?.trim() || \"selection\",\n                data: dataMatch?.[1]?.trim() || \"\"\n            }\n        };\n    }\n    \n    return { message: response, hasAction: false, action: null };\n}\n\n// ============================================================================\n// Apply Changes\n// ============================================================================\nasync function applyChanges() {\n    if (!state.pendingAction) {\n        showToast(\"No changes to apply\", \"error\");\n        return;\n    }\n    \n    const action = state.pendingAction;\n    \n    try {\n        await Excel.run(async (context) => {\n            const sheet = context.workbook.worksheets.getActiveWorksheet();\n            let targetRange;\n            \n            if (action.target === \"selection\" || !action.target) {\n                targetRange = context.workbook.getSelectedRange();\n            } else {\n                targetRange = sheet.getRange(action.target);\n            }\n            \n            targetRange.load([\"rowCount\", \"columnCount\", \"address\"]);\n            await context.sync();\n            \n            switch (action.type) {\n                case \"formula\":\n                    await applyFormulaToRange(context, sheet, targetRange, action.data);\n                    break;\n                case \"values\":\n                case \"value\":\n                    await applyValues(targetRange, action.data);\n                    break;\n                case \"format\":\n                    applyFormat(targetRange, action.data);\n                    break;\n                case \"chart\":\n                    createChart(sheet, targetRange, action.data);\n                    break;\n                default:\n                    targetRange.values = [[action.data]];\n            }\n            \n            await context.sync();\n        });\n        \n        addMessage(\"ai\", \"Changes applied successfully.\", \"action\");\n        showToast(\"Applied\");\n        \n        state.pendingAction = null;\n        elements.applyBtn.disabled = true;\n        \n        await refreshSelection();\n    } catch (err) {\n        addMessage(\"ai\", `Failed to apply: ${err.message}`, \"error\");\n        showToast(\"Failed\", \"error\");\n    }\n}\n\nasync function applyFormulaToRange(context, sheet, targetRange, formula) {\n    const rowCount = targetRange.rowCount;\n    const colCount = targetRange.columnCount;\n    \n    // If single cell, just apply formula\n    if (rowCount === 1 && colCount === 1) {\n        targetRange.formulas = [[formula]];\n        return;\n    }\n    \n    // For multiple cells, we need to apply formula with relative references\n    // Get the starting cell address\n    const address = targetRange.address;\n    const match = address.match(/([A-Z]+)(\\d+)/);\n    if (!match) {\n        targetRange.formulas = [[formula]];\n        return;\n    }\n    \n    const startCol = match[1];\n    const startRow = parseInt(match[2]);\n    \n    // Create formula array for all cells\n    const formulas = [];\n    for (let r = 0; r < rowCount; r++) {\n        const rowFormulas = [];\n        for (let c = 0; c < colCount; c++) {\n            // Adjust formula for each row\n            let adjustedFormula = formula;\n            \n            // Replace row numbers in formula (simple adjustment)\n            if (r > 0) {\n                adjustedFormula = formula.replace(/(\\$?)([A-Z]+)(\\$?)(\\d+)/g, (match, dollarCol, col, dollarRow, row) => {\n                    if (dollarRow === '$') {\n                        return match; // Absolute row reference, don't change\n                    }\n                    const newRow = parseInt(row) + r;\n                    return `${dollarCol}${col}${dollarRow}${newRow}`;\n                });\n            }\n            rowFormulas.push(adjustedFormula);\n        }\n        formulas.push(rowFormulas);\n    }\n    \n    targetRange.formulas = formulas;\n}\n\nasync function applyValues(targetRange, data) {\n    let values;\n    try {\n        values = JSON.parse(data);\n        if (!Array.isArray(values)) values = [[values]];\n        else if (!Array.isArray(values[0])) values = [values];\n    } catch {\n        values = [[data]];\n    }\n    \n    if (values.length > 1 || values[0]?.length > 1) {\n        targetRange = targetRange.getCell(0, 0).getResizedRange(values.length - 1, values[0].length - 1);\n    }\n    targetRange.values = values;\n}\n\nfunction applyFormat(range, formatData) {\n    const data = formatData.toLowerCase();\n    if (data.includes(\"bold\")) range.format.font.bold = true;\n    if (data.includes(\"italic\")) range.format.font.italic = true;\n    if (data.includes(\"currency\")) range.numberFormat = [[\"$#,##0.00\"]];\n    if (data.includes(\"percent\")) range.numberFormat = [[\"0.00%\"]];\n    if (data.includes(\"header\")) {\n        range.format.font.bold = true;\n        range.format.fill.color = \"#1a1a2e\";\n        range.format.font.color = \"#FFFFFF\";\n    }\n}\n\nfunction createChart(sheet, dataRange, chartData) {\n    const data = chartData.toLowerCase();\n    let chartType = Excel.ChartType.columnClustered;\n    \n    if (data.includes(\"line\")) chartType = Excel.ChartType.line;\n    else if (data.includes(\"pie\")) chartType = Excel.ChartType.pie;\n    else if (data.includes(\"bar\")) chartType = Excel.ChartType.barClustered;\n    else if (data.includes(\"area\")) chartType = Excel.ChartType.area;\n    \n    const chart = sheet.charts.add(chartType, dataRange, Excel.ChartSeriesBy.auto);\n    chart.setPosition(\"H2\", \"O15\");\n    chart.title.text = \"Chart\";\n}\n\n// ============================================================================\n// Settings\n// ============================================================================\nfunction openSettings() {\n    elements.apiKeyInput.value = state.apiKey;\n    elements.settingsModal.classList.add(\"active\");\n}\n\nfunction closeSettings() {\n    elements.settingsModal.classList.remove(\"active\");\n}\n\nfunction saveSettings() {\n    const key = elements.apiKeyInput.value.trim();\n    state.apiKey = key;\n    localStorage.setItem(CONFIG.STORAGE_KEY, key);\n    closeSettings();\n    showToast(\"Saved\");\n}\n\n// ============================================================================\n// Toast\n// ============================================================================\nfunction showToast(message, type = \"success\") {\n    const icon = elements.toast.querySelector(\"i\");\n    icon.className = type === \"success\" ? \"fas fa-check-circle\" : \"fas fa-exclamation-triangle\";\n    \n    elements.toastMessage.textContent = message;\n    elements.toast.classList.add(\"show\");\n    elements.toast.classList.toggle(\"error\", type !== \"success\");\n    \n    setTimeout(() => elements.toast.classList.remove(\"show\"), 2500);\n}\n\n// ============================================================================\n// Exports\n// ============================================================================\nexport { sendMessage, applyChanges, refreshSelection, clearConversation };\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html lang=\\\"en\\\"> <head> <meta charset=\\\"UTF-8\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Excel AI Copilot</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\\\"> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body> <div class=\\\"app\\\"> <header class=\\\"header\\\"> <div class=\\\"header-left\\\"> <div class=\\\"logo-icon\\\"> <i class=\\\"fas fa-bolt\\\"></i> </div> <span class=\\\"logo-text\\\">Copilot</span> </div> <div class=\\\"header-actions\\\"> <button class=\\\"icon-btn\\\" id=\\\"clearChat\\\" title=\\\"Clear conversation\\\"> <i class=\\\"fas fa-trash-alt\\\"></i> </button> <button class=\\\"icon-btn\\\" id=\\\"settingsBtn\\\" title=\\\"Settings\\\"> <i class=\\\"fas fa-cog\\\"></i> </button> </div> </header> <main class=\\\"main\\\"> <div id=\\\"welcomeScreen\\\" class=\\\"welcome-screen\\\"> <div class=\\\"welcome-icon\\\"> <i class=\\\"fas fa-bolt\\\"></i> </div> <h2>Excel AI Copilot</h2> <p>Select data and ask me to analyze, create formulas, or automate tasks.</p> <div class=\\\"suggestions\\\"> <button class=\\\"suggestion-chip\\\" data-prompt=\\\"Analyze this data and summarize key insights\\\"> <i class=\\\"fas fa-chart-bar\\\"></i> <span>Analyze data</span> </button> <button class=\\\"suggestion-chip\\\" data-prompt=\\\"Create a formula for this calculation\\\"> <i class=\\\"fas fa-calculator\\\"></i> <span>Create formula</span> </button> <button class=\\\"suggestion-chip\\\" data-prompt=\\\"What chart type would best visualize this data?\\\"> <i class=\\\"fas fa-chart-line\\\"></i> <span>Suggest chart</span> </button> <button class=\\\"suggestion-chip\\\" data-prompt=\\\"Format this data professionally\\\"> <i class=\\\"fas fa-palette\\\"></i> <span>Format data</span> </button> </div> </div> <div id=\\\"chatContainer\\\" class=\\\"chat-container\\\"></div> </main> <div class=\\\"context-bar\\\"> <div class=\\\"context-left\\\"> <label class=\\\"toggle\\\"> <input type=\\\"checkbox\\\" id=\\\"useSelection\\\" checked=\\\"checked\\\"> <span class=\\\"toggle-track\\\"></span> </label> <span class=\\\"context-label\\\">Context</span> </div> <div class=\\\"context-info\\\" id=\\\"contextInfo\\\"> <i class=\\\"fas fa-table\\\"></i> <span id=\\\"selectionText\\\">No selection</span> </div> <button class=\\\"icon-btn-sm\\\" id=\\\"refreshBtn\\\" title=\\\"Refresh\\\"> <i class=\\\"fas fa-sync-alt\\\"></i> </button> </div> <div class=\\\"input-area\\\"> <div class=\\\"input-box\\\"> <textarea id=\\\"promptInput\\\" placeholder=\\\"Ask anything...\\\" rows=\\\"1\\\"></textarea> <button class=\\\"send-btn\\\" id=\\\"sendBtn\\\" disabled=\\\"disabled\\\" title=\\\"Send\\\"> <i class=\\\"fas fa-arrow-up\\\"></i> </button> </div> <button class=\\\"apply-btn\\\" id=\\\"applyBtn\\\" disabled=\\\"disabled\\\"> <i class=\\\"fas fa-check\\\"></i> <span>Apply to Sheet</span> </button> </div> </div> <div class=\\\"modal-overlay\\\" id=\\\"settingsModal\\\"> <div class=\\\"modal\\\"> <div class=\\\"modal-header\\\"> <h3>Settings</h3> <button class=\\\"icon-btn\\\" id=\\\"closeSettings\\\"> <i class=\\\"fas fa-times\\\"></i> </button> </div> <div class=\\\"modal-body\\\"> <div class=\\\"form-group\\\"> <label>API Key</label> <div class=\\\"input-group\\\"> <input type=\\\"password\\\" id=\\\"apiKeyInput\\\" placeholder=\\\"Enter Gemini API key\\\"> <button class=\\\"icon-btn\\\" id=\\\"togglePassword\\\"> <i class=\\\"fas fa-eye\\\"></i> </button> </div> <p class=\\\"hint\\\"> <a href=\\\"https://aistudio.google.com/apikey\\\" target=\\\"_blank\\\">Get free API key</a> </p> </div> </div> <div class=\\\"modal-footer\\\"> <button class=\\\"btn-secondary\\\" id=\\\"cancelSettings\\\">Cancel</button> <button class=\\\"btn-primary\\\" id=\\\"saveSettings\\\">Save</button> </div> </div> </div> <div class=\\\"toast\\\" id=\\\"toast\\\"> <i class=\\\"fas fa-check-circle\\\"></i> <span id=\\\"toastMessage\\\">Saved</span> </div> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","d","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","_invoke","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","CONFIG","state","apiKey","lastResponse","pendingAction","selectionData","selectionAddress","conversationHistory","isFirstMessage","elements","_setupSelectionHandler","_callee2","_t","_context2","Excel","run","_ref","_callee","context","_context","workbook","worksheets","getActiveWorksheet","onSelectionChanged","add","sync","_x7","console","log","message","_onSelectionChanged","_callee3","_elements$useSelectio2","_context3","useSelection","checked","refreshSelection","_refreshSelection","_callee5","_elements$useSelectio3","_context5","selectionText","textContent","_ref2","_callee4","range","_context4","getSelectedRange","load","address","values","concat","rowCount","columnCount","_x8","showChat","welcomeScreen","style","display","chatContainer","classList","addMessage","role","content","type","msgEl","createElement","className","avatarIcon","statusIcon","innerHTML","formatted","_","lang","code","trim","formatContent","appendChild","scrollTop","scrollHeight","showTyping","typingEl","id","hideTyping","_document$getElementB","getElementById","remove","clearConversation","applyBtn","disabled","showToast","sendMessage","_sendMessage","_callee6","prompt","response","parsed","_t3","_context6","promptInput","openSettings","push","parts","text","slice","height","sendBtn","callGeminiAPIWithMemory","parseAIResponse","hasAction","action","_callGeminiAPIWithMemory","_callee7","_data$candidates","systemInstruction","contextInfo","contents","lastUserMsg","url","data","_context7","buildSystemPrompt","buildContextPrompt","_toConsumableArray","encodeURIComponent","fetch","method","headers","body","JSON","stringify","generationConfig","temperature","maxOutputTokens","ok","status","json","candidates","map","join","_state$selectionData$","_state$selectionData$3","rows","Math","min","cols","dataStr","rowData","_state$selectionData$2","actionMatch","match","_typeMatch$","_targetMatch$","_dataMatch$","actionBlock","typeMatch","targetMatch","dataMatch","target","applyChanges","_applyChanges","_callee9","_t5","_context9","_ref3","_callee8","sheet","targetRange","_t4","_context8","getRange","applyFormulaToRange","applyValues","applyFormat","createChart","_x9","_x","_x2","_x3","_x4","_applyFormulaToRange","_callee0","formula","colCount","formulas","_loop","_context1","parseInt","rowFormulas","adjustedFormula","_context0","dollarCol","col","dollarRow","row","newRow","_regeneratorValues","_x5","_x6","_applyValues","_callee1","_values$","_context10","parse","Array","isArray","_unused","getCell","getResizedRange","formatData","toLowerCase","includes","format","font","bold","italic","numberFormat","fill","color","dataRange","chartData","chartType","ChartType","columnClustered","line","pie","barClustered","area","chart","charts","ChartSeriesBy","auto","setPosition","title","apiKeyInput","settingsModal","closeSettings","saveSettings","localStorage","setItem","toast","querySelector","toastMessage","toggle","setTimeout","Office","onReady","info","textarea","_elements$sendBtn","_elements$promptInput","_elements$promptInput2","_elements$applyBtn","_elements$refreshBtn","_elements$useSelectio","_elements$settingsBtn","_elements$closeSettin","_elements$cancelSetti","_elements$saveSetting","_elements$clearChat","_elements$togglePassw","_elements$settingsMod","host","HostType","refreshBtn","settingsBtn","cancelSettings","togglePassword","clearChat","getItem","addEventListener","shiftKey","preventDefault","input","icon","querySelectorAll","forEach","chip","dataset","setupSelectionHandler","URL"],"ignoreList":[],"sourceRoot":""}