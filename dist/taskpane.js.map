{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/define property getters","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Excel AI Copilot - Main Application\n * Provides AI-powered assistance for Excel operations\n */\n\n/* global document, Excel, Office, fetch, localStorage */\n\n// ============================================================================\n// Configuration\n// ============================================================================\nconst CONFIG = {\n  GEMINI_MODEL: \"gemini-2.0-flash\",\n  API_ENDPOINT: \"https://generativelanguage.googleapis.com/v1beta/models/\",\n  STORAGE_KEY: \"excel_copilot_api_key\",\n  MAX_CONTEXT_ROWS: 100,\n  MAX_CONTEXT_COLS: 26\n};\n\n// ============================================================================\n// State Management\n// ============================================================================\nlet state = {\n  apiKey: \"\",\n  lastResponse: null,\n  pendingAction: null,\n  selectionData: null,\n  selectionAddress: \"\",\n  chatHistory: []\n};\n\n// ============================================================================\n// Initialization\n// ============================================================================\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Excel) {\n    initializeApp();\n  }\n});\n\nfunction initializeApp() {\n  // Load saved API key\n  state.apiKey = localStorage.getItem(CONFIG.STORAGE_KEY) || \"\";\n  \n  // Bind event listeners\n  bindEventListeners();\n  \n  // Initial selection refresh\n  refreshSelection();\n  \n  // Set up selection change handler\n  setupSelectionHandler();\n}\n\nfunction bindEventListeners() {\n  // Quick action buttons\n  document.querySelectorAll(\".action-btn\").forEach(btn => {\n    btn.addEventListener(\"click\", () => handleQuickAction(btn.dataset.action));\n  });\n  \n  // Main controls\n  document.getElementById(\"btnRefresh\")?.addEventListener(\"click\", refreshSelection);\n  document.getElementById(\"btnSend\")?.addEventListener(\"click\", sendMessage);\n  document.getElementById(\"btnApply\")?.addEventListener(\"click\", applyChanges);\n  \n  // Input handling\n  const promptInput = document.getElementById(\"promptInput\");\n  promptInput?.addEventListener(\"keydown\", (e) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      sendMessage();\n    }\n  });\n  \n  // Settings modal\n  document.getElementById(\"btnSaveSettings\")?.addEventListener(\"click\", saveSettings);\n  document.getElementById(\"btnCloseSettings\")?.addEventListener(\"click\", closeSettings);\n  \n  // Toggle selection context\n  document.getElementById(\"useSelection\")?.addEventListener(\"change\", refreshSelection);\n}\n\nasync function setupSelectionHandler() {\n  try {\n    await Excel.run(async (context) => {\n      const sheet = context.workbook.worksheets.getActiveWorksheet();\n      sheet.onSelectionChanged.add(onSelectionChanged);\n      await context.sync();\n    });\n  } catch (err) {\n    console.log(\"Selection handler setup skipped:\", err.message);\n  }\n}\n\nasync function onSelectionChanged() {\n  const useSelection = document.getElementById(\"useSelection\")?.checked;\n  if (useSelection) {\n    await refreshSelection();\n  }\n}\n\n// ============================================================================\n// Selection & Context Management\n// ============================================================================\nasync function refreshSelection() {\n  const useSelection = document.getElementById(\"useSelection\")?.checked;\n  const infoEl = document.getElementById(\"selectionInfo\");\n  \n  if (!useSelection) {\n    infoEl.innerHTML = '<span class=\"info-label\">Selection context disabled</span>';\n    state.selectionData = null;\n    state.selectionAddress = \"\";\n    return;\n  }\n  \n  try {\n    await Excel.run(async (context) => {\n      const range = context.workbook.getSelectedRange();\n      range.load([\"address\", \"values\", \"rowCount\", \"columnCount\", \"numberFormat\"]);\n      await context.sync();\n      \n      state.selectionAddress = range.address;\n      state.selectionData = range.values;\n      \n      const rows = range.rowCount;\n      const cols = range.columnCount;\n      const preview = generateDataPreview(range.values, 3, 4);\n      \n      infoEl.innerHTML = `\n        <strong>${range.address}</strong> (${rows} rows √ó ${cols} cols)\n        <div style=\"margin-top:4px; font-family: monospace; font-size:10px;\">${preview}</div>\n      `;\n    });\n  } catch (err) {\n    infoEl.innerHTML = '<span class=\"info-label\">Could not read selection</span>';\n    console.error(\"Selection error:\", err);\n  }\n}\n\nfunction generateDataPreview(values, maxRows = 3, maxCols = 4) {\n  if (!values || !values.length) return \"Empty selection\";\n  \n  const rows = Math.min(values.length, maxRows);\n  const cols = Math.min(values[0]?.length || 0, maxCols);\n  \n  let preview = \"\";\n  for (let r = 0; r < rows; r++) {\n    const rowData = [];\n    for (let c = 0; c < cols; c++) {\n      const val = values[r][c];\n      const display = val === null || val === \"\" ? \"¬∑\" : String(val).substring(0, 8);\n      rowData.push(display);\n    }\n    if (values[0]?.length > maxCols) rowData.push(\"...\");\n    preview += rowData.join(\" | \") + \"<br>\";\n  }\n  if (values.length > maxRows) preview += \"...\";\n  \n  return preview;\n}\n\n// ============================================================================\n// Quick Actions\n// ============================================================================\nconst QUICK_ACTION_PROMPTS = {\n  analyze: \"Analyze this data and provide key insights, patterns, and any anomalies you notice. Include statistics like averages, min/max values, and trends.\",\n  formula: \"Based on this data, suggest useful Excel formulas I could use. Provide the exact formula syntax I can copy.\",\n  chart: \"Recommend the best chart type for this data and explain why. Then help me create it.\",\n  format: \"Suggest how to format this data for better readability. Include conditional formatting ideas.\",\n  clean: \"Identify any data quality issues (duplicates, blanks, inconsistencies) and suggest how to clean this data.\",\n  summarize: \"Create a concise summary of this data including totals, averages, and key takeaways.\"\n};\n\nfunction handleQuickAction(action) {\n  const prompt = QUICK_ACTION_PROMPTS[action];\n  if (prompt) {\n    document.getElementById(\"promptInput\").value = prompt;\n    sendMessage();\n  }\n}\n\n// ============================================================================\n// Chat & Messaging\n// ============================================================================\nfunction addMessage(role, content, type = \"normal\") {\n  const container = document.getElementById(\"chatContainer\");\n  \n  // Remove welcome message if present\n  const welcome = container.querySelector(\".welcome-message\");\n  if (welcome) welcome.remove();\n  \n  const msgEl = document.createElement(\"div\");\n  msgEl.className = `message ${role} ${type}`;\n  \n  // Format content (handle code blocks, etc.)\n  const formattedContent = formatMessageContent(content);\n  msgEl.innerHTML = `<div class=\"message-content\">${formattedContent}</div>`;\n  \n  container.appendChild(msgEl);\n  container.scrollTop = container.scrollHeight;\n  \n  state.chatHistory.push({ role, content, type });\n}\n\nfunction formatMessageContent(content) {\n  // Escape HTML\n  let formatted = content\n    .replace(/&/g, \"&amp;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\");\n  \n  // Format code blocks\n  formatted = formatted.replace(/```(\\w*)\\n?([\\s\\S]*?)```/g, (_, lang, code) => {\n    return `<div class=\"code-block\">${code.trim()}</div>`;\n  });\n  \n  // Format inline code\n  formatted = formatted.replace(/`([^`]+)`/g, '<code style=\"background:#f0f0f0;padding:2px 4px;border-radius:2px;\">$1</code>');\n  \n  // Format bold\n  formatted = formatted.replace(/\\*\\*([^*]+)\\*\\*/g, '<strong>$1</strong>');\n  \n  return formatted;\n}\n\nfunction showTypingIndicator() {\n  const container = document.getElementById(\"chatContainer\");\n  const indicator = document.createElement(\"div\");\n  indicator.className = \"message ai typing\";\n  indicator.id = \"typingIndicator\";\n  indicator.innerHTML = '<div class=\"typing-indicator\"><span></span><span></span><span></span></div>';\n  container.appendChild(indicator);\n  container.scrollTop = container.scrollHeight;\n}\n\nfunction hideTypingIndicator() {\n  document.getElementById(\"typingIndicator\")?.remove();\n}\n\n// ============================================================================\n// AI Communication\n// ============================================================================\nasync function sendMessage() {\n  const input = document.getElementById(\"promptInput\");\n  const prompt = input.value.trim();\n  \n  if (!prompt) return;\n  \n  // Check API key\n  if (!state.apiKey) {\n    showSettings();\n    setStatus(\"Please set your Gemini API key first\", \"error\");\n    return;\n  }\n  \n  // Add user message\n  addMessage(\"user\", prompt);\n  input.value = \"\";\n  \n  // Show typing indicator\n  showTypingIndicator();\n  setStatus(\"Thinking...\");\n  \n  try {\n    const response = await callGeminiAPI(prompt);\n    hideTypingIndicator();\n    \n    // Parse and handle the response\n    const parsed = parseAIResponse(response);\n    state.lastResponse = parsed;\n    \n    // Add AI message\n    addMessage(\"ai\", parsed.message, parsed.hasAction ? \"action\" : \"normal\");\n    \n    // Enable apply button if there's an action\n    const applyBtn = document.getElementById(\"btnApply\");\n    if (parsed.hasAction && applyBtn) {\n      applyBtn.disabled = false;\n      state.pendingAction = parsed.action;\n    }\n    \n    setStatus(\"Ready\", \"success\");\n  } catch (err) {\n    hideTypingIndicator();\n    addMessage(\"ai\", `Error: ${err.message}`, \"error\");\n    setStatus(err.message, \"error\");\n  }\n}\n\nasync function callGeminiAPI(userPrompt) {\n  const systemPrompt = buildSystemPrompt();\n  const contextPrompt = buildContextPrompt();\n  \n  const fullPrompt = `${systemPrompt}\\n\\n${contextPrompt}\\n\\nUser Request: ${userPrompt}`;\n  \n  const url = `${CONFIG.API_ENDPOINT}${CONFIG.GEMINI_MODEL}:generateContent?key=${encodeURIComponent(state.apiKey)}`;\n  \n  const response = await fetch(url, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({\n      contents: [{ parts: [{ text: fullPrompt }] }],\n      generationConfig: {\n        temperature: 0.7,\n        maxOutputTokens: 2048\n      }\n    })\n  });\n  \n  if (!response.ok) {\n    const errorText = await response.text();\n    throw new Error(`API Error ${response.status}: ${errorText}`);\n  }\n  \n  const data = await response.json();\n  const aiText = data?.candidates?.[0]?.content?.parts?.map(p => p.text || \"\").join(\"\") || \"\";\n  \n  if (!aiText) throw new Error(\"Empty response from AI\");\n  \n  return aiText;\n}\n\nfunction buildSystemPrompt() {\n  return `You are Excel AI Copilot, an intelligent assistant for Microsoft Excel. You help users analyze data, create formulas, generate charts, format spreadsheets, and automate tasks.\n\nCAPABILITIES:\n1. DATA ANALYSIS: Analyze patterns, trends, statistics, anomalies\n2. FORMULA CREATION: Generate Excel formulas with exact syntax\n3. CHART RECOMMENDATIONS: Suggest and help create visualizations\n4. DATA FORMATTING: Conditional formatting, number formats, styles\n5. DATA CLEANING: Find duplicates, fix inconsistencies, fill blanks\n6. CALCULATIONS: Perform calculations and explain results\n\nRESPONSE FORMAT:\n- Be concise and actionable\n- When providing formulas, use exact Excel syntax\n- When suggesting actions that modify the sheet, include an ACTION block\n\nACTION BLOCK FORMAT (when you want to modify the sheet):\n[ACTION]\ntype: <formula|value|format|chart>\ntarget: <cell reference or \"selection\">\ndata: <the data to apply>\n[/ACTION]\n\nExample action for inserting a formula:\n[ACTION]\ntype: formula\ntarget: D2\ndata: =SUM(A2:C2)\n[/ACTION]\n\nExample action for inserting values:\n[ACTION]\ntype: values\ntarget: A1\ndata: [[\"Header1\",\"Header2\"],[\"Value1\",\"Value2\"]]\n[/ACTION]\n\nOnly include ACTION blocks when the user wants to modify the sheet. For questions and analysis, just provide the answer.`;\n}\n\nfunction buildContextPrompt() {\n  if (!state.selectionData || !state.selectionAddress) {\n    return \"CONTEXT: No data selected. User should select data for context-aware assistance.\";\n  }\n  \n  const rows = Math.min(state.selectionData.length, CONFIG.MAX_CONTEXT_ROWS);\n  const cols = Math.min(state.selectionData[0]?.length || 0, CONFIG.MAX_CONTEXT_COLS);\n  \n  let dataStr = \"\";\n  for (let r = 0; r < rows; r++) {\n    const rowData = [];\n    for (let c = 0; c < cols; c++) {\n      rowData.push(state.selectionData[r][c] ?? \"\");\n    }\n    dataStr += rowData.join(\"\\t\") + \"\\n\";\n  }\n  \n  return `CONTEXT:\nSelected Range: ${state.selectionAddress}\nDimensions: ${state.selectionData.length} rows √ó ${state.selectionData[0]?.length || 0} columns\n\nDATA:\n${dataStr}`;\n}\n\nfunction parseAIResponse(response) {\n  const actionMatch = response.match(/\\[ACTION\\]([\\s\\S]*?)\\[\\/ACTION\\]/);\n  \n  if (actionMatch) {\n    const actionBlock = actionMatch[1];\n    const typeMatch = actionBlock.match(/type:\\s*(\\w+)/);\n    const targetMatch = actionBlock.match(/target:\\s*([^\\n]+)/);\n    const dataMatch = actionBlock.match(/data:\\s*([\\s\\S]*?)(?=\\n\\w+:|$)/);\n    \n    const message = response.replace(/\\[ACTION\\][\\s\\S]*?\\[\\/ACTION\\]/, \"\").trim();\n    \n    return {\n      message: message || \"I'll apply the changes when you click 'Apply Changes'.\",\n      hasAction: true,\n      action: {\n        type: typeMatch?.[1]?.trim() || \"value\",\n        target: targetMatch?.[1]?.trim() || \"selection\",\n        data: dataMatch?.[1]?.trim() || \"\"\n      }\n    };\n  }\n  \n  return {\n    message: response,\n    hasAction: false,\n    action: null\n  };\n}\n\n\n// ============================================================================\n// Excel Operations - Apply Changes\n// ============================================================================\nasync function applyChanges() {\n  if (!state.pendingAction) {\n    setStatus(\"No pending action to apply\", \"error\");\n    return;\n  }\n  \n  const action = state.pendingAction;\n  setStatus(`Applying ${action.type}...`);\n  \n  try {\n    await Excel.run(async (context) => {\n      switch (action.type) {\n        case \"formula\":\n          await applyFormula(context, action);\n          break;\n        case \"values\":\n        case \"value\":\n          await applyValues(context, action);\n          break;\n        case \"format\":\n          await applyFormat(context, action);\n          break;\n        case \"chart\":\n          await createChart(context, action);\n          break;\n        default:\n          await applyValues(context, action);\n      }\n      \n      await context.sync();\n    });\n    \n    addMessage(\"ai\", `‚úì Changes applied successfully!`, \"action\");\n    setStatus(\"Changes applied!\", \"success\");\n    \n    // Clear pending action\n    state.pendingAction = null;\n    document.getElementById(\"btnApply\").disabled = true;\n    \n    // Refresh selection to show updated data\n    await refreshSelection();\n    \n  } catch (err) {\n    console.error(\"Apply error:\", err);\n    addMessage(\"ai\", `Failed to apply changes: ${err.message}`, \"error\");\n    setStatus(\"Failed to apply changes\", \"error\");\n  }\n}\n\nasync function applyFormula(context, action) {\n  const sheet = context.workbook.worksheets.getActiveWorksheet();\n  let targetRange;\n  \n  if (action.target === \"selection\" || !action.target) {\n    targetRange = context.workbook.getSelectedRange();\n  } else {\n    targetRange = sheet.getRange(action.target);\n  }\n  \n  targetRange.formulas = [[action.data]];\n}\n\nasync function applyValues(context, action) {\n  const sheet = context.workbook.worksheets.getActiveWorksheet();\n  let targetRange;\n  \n  if (action.target === \"selection\" || !action.target) {\n    targetRange = context.workbook.getSelectedRange();\n  } else {\n    targetRange = sheet.getRange(action.target);\n  }\n  \n  // Parse data - could be JSON array or simple value\n  let values;\n  try {\n    values = JSON.parse(action.data);\n    if (!Array.isArray(values)) {\n      values = [[values]];\n    } else if (!Array.isArray(values[0])) {\n      values = [values];\n    }\n  } catch {\n    // Simple string value\n    values = [[action.data]];\n  }\n  \n  // Resize range if needed\n  if (values.length > 1 || values[0]?.length > 1) {\n    targetRange = targetRange.getCell(0, 0).getResizedRange(values.length - 1, values[0].length - 1);\n  }\n  \n  targetRange.values = values;\n}\n\nasync function applyFormat(context, action) {\n  const sheet = context.workbook.worksheets.getActiveWorksheet();\n  let targetRange;\n  \n  if (action.target === \"selection\" || !action.target) {\n    targetRange = context.workbook.getSelectedRange();\n  } else {\n    targetRange = sheet.getRange(action.target);\n  }\n  \n  // Parse format instructions\n  const formatData = action.data.toLowerCase();\n  \n  if (formatData.includes(\"bold\")) {\n    targetRange.format.font.bold = true;\n  }\n  if (formatData.includes(\"italic\")) {\n    targetRange.format.font.italic = true;\n  }\n  if (formatData.includes(\"currency\") || formatData.includes(\"$\")) {\n    targetRange.numberFormat = [[\"$#,##0.00\"]];\n  }\n  if (formatData.includes(\"percent\") || formatData.includes(\"%\")) {\n    targetRange.numberFormat = [[\"0.00%\"]];\n  }\n  if (formatData.includes(\"date\")) {\n    targetRange.numberFormat = [[\"mm/dd/yyyy\"]];\n  }\n  if (formatData.includes(\"center\")) {\n    targetRange.format.horizontalAlignment = Excel.HorizontalAlignment.center;\n  }\n  if (formatData.includes(\"header\") || formatData.includes(\"title\")) {\n    targetRange.format.font.bold = true;\n    targetRange.format.fill.color = \"#4472C4\";\n    targetRange.format.font.color = \"#FFFFFF\";\n  }\n}\n\nasync function createChart(context, action) {\n  const sheet = context.workbook.worksheets.getActiveWorksheet();\n  let dataRange;\n  \n  if (action.target === \"selection\" || !action.target) {\n    dataRange = context.workbook.getSelectedRange();\n  } else {\n    dataRange = sheet.getRange(action.target);\n  }\n  \n  // Determine chart type from action data\n  const chartData = action.data.toLowerCase();\n  let chartType = Excel.ChartType.columnClustered;\n  \n  if (chartData.includes(\"line\")) {\n    chartType = Excel.ChartType.line;\n  } else if (chartData.includes(\"pie\")) {\n    chartType = Excel.ChartType.pie;\n  } else if (chartData.includes(\"bar\")) {\n    chartType = Excel.ChartType.barClustered;\n  } else if (chartData.includes(\"area\")) {\n    chartType = Excel.ChartType.area;\n  } else if (chartData.includes(\"scatter\")) {\n    chartType = Excel.ChartType.xyscatter;\n  }\n  \n  const chart = sheet.charts.add(chartType, dataRange, Excel.ChartSeriesBy.auto);\n  chart.setPosition(\"H2\", \"O15\");\n  chart.title.text = \"Generated Chart\";\n}\n\n// ============================================================================\n// Additional Excel Operations\n// ============================================================================\nasync function getSheetData(rangeName) {\n  let data = null;\n  await Excel.run(async (context) => {\n    const sheet = context.workbook.worksheets.getActiveWorksheet();\n    const range = rangeName ? sheet.getRange(rangeName) : context.workbook.getSelectedRange();\n    range.load(\"values\");\n    await context.sync();\n    data = range.values;\n  });\n  return data;\n}\n\nasync function setSheetData(rangeName, values) {\n  await Excel.run(async (context) => {\n    const sheet = context.workbook.worksheets.getActiveWorksheet();\n    const range = sheet.getRange(rangeName);\n    range.values = values;\n    await context.sync();\n  });\n}\n\nasync function insertFormula(cell, formula) {\n  await Excel.run(async (context) => {\n    const sheet = context.workbook.worksheets.getActiveWorksheet();\n    const range = sheet.getRange(cell);\n    range.formulas = [[formula]];\n    await context.sync();\n  });\n}\n\nasync function getWorksheetNames() {\n  const names = [];\n  await Excel.run(async (context) => {\n    const sheets = context.workbook.worksheets;\n    sheets.load(\"items/name\");\n    await context.sync();\n    sheets.items.forEach(s => names.push(s.name));\n  });\n  return names;\n}\n\nasync function createNewSheet(name) {\n  await Excel.run(async (context) => {\n    const sheet = context.workbook.worksheets.add(name);\n    sheet.activate();\n    await context.sync();\n  });\n}\n\nasync function sortSelection(ascending = true) {\n  await Excel.run(async (context) => {\n    const range = context.workbook.getSelectedRange();\n    range.load(\"columnIndex\");\n    await context.sync();\n    \n    const sortFields = [{\n      key: 0,\n      ascending: ascending\n    }];\n    \n    range.sort.apply(sortFields);\n    await context.sync();\n  });\n}\n\nasync function autoFitColumns() {\n  await Excel.run(async (context) => {\n    const range = context.workbook.getSelectedRange();\n    range.format.autofitColumns();\n    await context.sync();\n  });\n}\n\n// ============================================================================\n// Settings Management\n// ============================================================================\nfunction showSettings() {\n  const modal = document.getElementById(\"settingsModal\");\n  const input = document.getElementById(\"apiKeyInput\");\n  if (modal && input) {\n    input.value = state.apiKey;\n    modal.classList.remove(\"hidden\");\n  }\n}\n\nfunction closeSettings() {\n  document.getElementById(\"settingsModal\")?.classList.add(\"hidden\");\n}\n\nfunction saveSettings() {\n  const input = document.getElementById(\"apiKeyInput\");\n  if (input) {\n    state.apiKey = input.value.trim();\n    localStorage.setItem(CONFIG.STORAGE_KEY, state.apiKey);\n    closeSettings();\n    setStatus(\"API key saved!\", \"success\");\n  }\n}\n\n// ============================================================================\n// Status Management\n// ============================================================================\nfunction setStatus(message, type = \"\") {\n  const statusBar = document.getElementById(\"statusBar\");\n  if (statusBar) {\n    statusBar.textContent = message;\n    statusBar.className = \"status-bar \" + type;\n  }\n}\n\n// ============================================================================\n// Export for testing\n// ============================================================================\nexport {\n  sendMessage,\n  applyChanges,\n  refreshSelection,\n  getSheetData,\n  setSheetData,\n  insertFormula,\n  sortSelection,\n  autoFitColumns\n};\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Excel AI Copilot</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-Fabric\\\"> <div id=\\\"app\\\" class=\\\"app-container\\\"> <header class=\\\"header\\\"> <div class=\\\"header-icon\\\">‚ú®</div> <div class=\\\"header-text\\\"> <h1>Excel AI Copilot</h1> <p>Your intelligent Excel assistant</p> </div> </header> <section class=\\\"quick-actions\\\"> <h3>Quick Actions</h3> <div class=\\\"action-grid\\\"> <button class=\\\"action-btn\\\" data-action=\\\"analyze\\\"> <span class=\\\"action-icon\\\">üìä</span> <span>Analyze Data</span> </button> <button class=\\\"action-btn\\\" data-action=\\\"formula\\\"> <span class=\\\"action-icon\\\">üî¢</span> <span>Create Formula</span> </button> <button class=\\\"action-btn\\\" data-action=\\\"chart\\\"> <span class=\\\"action-icon\\\">üìà</span> <span>Create Chart</span> </button> <button class=\\\"action-btn\\\" data-action=\\\"format\\\"> <span class=\\\"action-icon\\\">üé®</span> <span>Format Data</span> </button> <button class=\\\"action-btn\\\" data-action=\\\"clean\\\"> <span class=\\\"action-icon\\\">üßπ</span> <span>Clean Data</span> </button> <button class=\\\"action-btn\\\" data-action=\\\"summarize\\\"> <span class=\\\"action-icon\\\">üìù</span> <span>Summarize</span> </button> </div> </section> <section class=\\\"context-panel\\\"> <div class=\\\"context-header\\\"> <label class=\\\"toggle-label\\\"> <input type=\\\"checkbox\\\" id=\\\"useSelection\\\" checked=\\\"checked\\\"/> <span class=\\\"toggle-slider\\\"></span> <span>Use selected range</span> </label> <button id=\\\"btnRefresh\\\" class=\\\"icon-btn\\\" title=\\\"Refresh selection\\\">üîÑ</button> </div> <div id=\\\"selectionInfo\\\" class=\\\"selection-info\\\"> <span class=\\\"info-label\\\">No selection</span> </div> </section> <section class=\\\"chat-section\\\"> <div id=\\\"chatContainer\\\" class=\\\"chat-container\\\"> <div class=\\\"welcome-message\\\"> <p>üëã Hi! I'm your Excel AI assistant. I can help you:</p> <ul> <li>Analyze and understand your data</li> <li>Create formulas and functions</li> <li>Generate charts and visualizations</li> <li>Clean and format data</li> <li>Answer questions about your spreadsheet</li> </ul> <p>Select some data and ask me anything!</p> </div> </div> </section> <section class=\\\"input-section\\\"> <div class=\\\"input-wrapper\\\"> <textarea id=\\\"promptInput\\\" placeholder=\\\"Ask me anything about your Excel data...\\\" rows=\\\"2\\\"></textarea> <button id=\\\"btnSend\\\" class=\\\"send-btn\\\" title=\\\"Send\\\"> <span>‚û§</span> </button> </div> <div class=\\\"input-actions\\\"> <button id=\\\"btnApply\\\" class=\\\"apply-btn\\\" disabled=\\\"disabled\\\"> ‚úì Apply Changes to Sheet </button> </div> </section> <div id=\\\"statusBar\\\" class=\\\"status-bar\\\"></div> </div> <div id=\\\"settingsModal\\\" class=\\\"modal hidden\\\"> <div class=\\\"modal-content\\\"> <h3>API Settings</h3> <label>Gemini API Key:</label> <input type=\\\"password\\\" id=\\\"apiKeyInput\\\" placeholder=\\\"Enter your API key\\\"/> <div class=\\\"modal-actions\\\"> <button id=\\\"btnSaveSettings\\\">Save</button> <button id=\\\"btnCloseSettings\\\">Cancel</button> </div> </div> </div> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","d","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","_invoke","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","CONFIG","state","apiKey","lastResponse","pendingAction","selectionData","selectionAddress","chatHistory","_setupSelectionHandler","_callee2","_t","_context2","Excel","run","_ref","_callee","context","_context","workbook","worksheets","getActiveWorksheet","onSelectionChanged","add","sync","_x14","console","log","message","_onSelectionChanged","_callee3","_document$getElementB9","_context3","getElementById","checked","refreshSelection","_refreshSelection","_callee5","_document$getElementB0","useSelection","infoEl","_t2","_context5","innerHTML","_ref2","_callee4","range","rows","cols","preview","_context4","getSelectedRange","load","address","values","rowCount","columnCount","generateDataPreview","concat","_x15","error","_values$","maxRows","maxCols","Math","min","_values$2","rowData","val","display","String","substring","push","join","Office","onReady","info","host","HostType","localStorage","getItem","_document$getElementB","_document$getElementB2","_document$getElementB3","_document$getElementB4","_document$getElementB5","_document$getElementB6","querySelectorAll","forEach","btn","addEventListener","action","dataset","prompt","QUICK_ACTION_PROMPTS","sendMessage","applyChanges","promptInput","shiftKey","preventDefault","saveSettings","closeSettings","bindEventListeners","setupSelectionHandler","analyze","formula","chart","format","clean","summarize","addMessage","role","content","type","container","welcome","querySelector","remove","msgEl","createElement","className","formattedContent","formatted","_","lang","code","trim","formatMessageContent","appendChild","scrollTop","scrollHeight","showTypingIndicator","indicator","id","hideTypingIndicator","_document$getElementB7","_sendMessage","_callee6","input","response","parsed","applyBtn","_t3","_context6","showSettings","setStatus","callGeminiAPI","parseAIResponse","hasAction","disabled","_x","_callGeminiAPI","_callee7","userPrompt","_data$candidates","systemPrompt","contextPrompt","fullPrompt","url","errorText","data","aiText","_context7","buildSystemPrompt","buildContextPrompt","encodeURIComponent","fetch","method","headers","body","JSON","stringify","contents","parts","text","generationConfig","temperature","maxOutputTokens","ok","status","json","candidates","map","_state$selectionData$","_state$selectionData$3","dataStr","_state$selectionData$2","actionMatch","match","_typeMatch$","_targetMatch$","_dataMatch$","actionBlock","typeMatch","targetMatch","dataMatch","target","_applyChanges","_callee9","_t5","_context9","_ref3","_callee8","_t4","_context8","applyFormula","applyValues","applyFormat","createChart","_x16","_x2","_x3","_applyFormula","_callee0","sheet","_context0","getRange","formulas","_x4","_x5","_applyValues","_callee1","_values$3","targetRange","_context1","parse","Array","isArray","_unused","getCell","getResizedRange","_x6","_x7","_applyFormat","_callee10","formatData","_context10","toLowerCase","includes","font","bold","italic","numberFormat","horizontalAlignment","HorizontalAlignment","center","fill","color","_x8","_x9","_createChart","_callee11","dataRange","chartData","chartType","_context11","ChartType","columnClustered","line","pie","barClustered","area","xyscatter","charts","ChartSeriesBy","auto","setPosition","title","modal","classList","_document$getElementB8","setItem","statusBar","textContent","URL"],"ignoreList":[],"sourceRoot":""}