<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Excel Copilot</title><script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script><link href="fc38fab549e816348897.css" rel="stylesheet"><script defer="defer" src="polyfill.js"></script><script defer="defer" src="taskpane.js"></script></head><body><div class="app"><header class="header"><div class="brand"><svg class="logo" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg> <span>Copilot</span> <span class="version-badge" id="versionBadge">v2.5.1</span></div><div class="header-actions"><button class="icon-btn" id="themeBtn" title="Toggle Dark Mode"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></button> <button class="icon-btn" id="historyBtn" title="History"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></button> <button class="icon-btn" id="clearBtn" title="Clear"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/></svg></button> <button class="icon-btn" id="settingsBtn" title="Settings"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/></svg></button></div></header><main class="main"><div id="welcome" class="welcome"><div class="welcome-icon"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg></div><h1>Excel Copilot</h1><p>Your AI assistant for Excel. Select cells and ask me anything.</p><div class="suggestions"><button data-prompt="Analyze this data and give me key insights"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg> Analyze data</button> <button data-prompt="Create a SUM formula for the selected cells"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 7h16M4 12h16M4 17h10"/></svg> Create formula</button> <button data-prompt="Create a chart to visualize this data"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 20V10M12 20V4M6 20v-6"/></svg> Create chart</button> <button data-prompt="Format this as a professional table with headers"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18M9 21V9"/></svg> Format table</button></div></div><div id="chat" class="chat"></div><div id="previewPanel" class="preview-panel" style="display:none"><div class="preview-header"><span class="preview-title">Pending Changes</span> <button class="icon-btn-sm" id="selectAllBtn" title="Select All"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"/></svg></button></div><div id="previewList" class="preview-list"></div></div><div id="historyPanel" class="history-panel" style="display:none"><div class="history-header"><span class="history-title">Action History</span></div><div id="historyList" class="history-list"></div></div></main><div class="context-bar"><span class="context-label">Data:</span> <span class="context-info" id="contextInfo">No selection</span><div class="mode-toggle-compact"><button class="mode-icon-sm active" id="editModeBtn" data-mode="edit" title="Edit Mode"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/></svg></button> <button class="mode-icon-sm" id="readOnlyModeBtn" data-mode="readonly" title="Read-Only Mode"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg></button></div><button class="icon-btn-sm" id="refreshBtn" title="Refresh"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/></svg></button></div><div class="input-area"><div class="input-box"><textarea id="promptInput" placeholder="Ask me anything..." rows="1"></textarea> <button class="send-btn" id="sendBtn" disabled="disabled"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg></button></div><div class="action-buttons"><button class="undo-btn" id="undoBtn" disabled="disabled"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 10h10a5 5 0 015 5v2M3 10l6 6M3 10l6-6"/></svg> Undo</button> <button class="apply-btn" id="applyBtn" disabled="disabled">Apply Changes</button></div></div></div><div class="modal" id="modal"><div class="modal-box"><div class="modal-header"><h2>Settings</h2><button class="icon-btn" id="closeModal"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg></button></div><div class="modal-body"><label>Gemini API Key</label><div class="input-row"><input type="password" id="apiKeyInput" placeholder="Enter your API key"> <button class="icon-btn" id="togglePwd"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg></button></div><p class="hint">Get your free key at <a href="https://aistudio.google.com/apikey" target="_blank">Google AI Studio</a></p><div class="settings-section"><label>Mode</label><div class="mode-toggle"><label class="mode-label"><input type="radio" name="mode" value="edit" id="modeEdit" checked="checked"> <span>Edit Mode</span></label> <label class="mode-label"><input type="radio" name="mode" value="readonly" id="modeReadOnly"> <span>Read-Only Mode</span></label></div><p class="hint">Edit mode allows applying changes. Read-only mode prevents modifications.</p></div><div class="settings-section"><label>AI Learning</label><p class="hint">The AI learns from your corrections to improve future suggestions.</p><button class="btn-secondary" id="clearPrefsBtn">Clear Learned Preferences</button></div></div><div class="modal-footer"><button class="btn-cancel" id="cancelBtn">Cancel</button> <button class="btn-save" id="saveBtn">Save</button></div></div></div><div class="toast" id="toast"></div></body></html>